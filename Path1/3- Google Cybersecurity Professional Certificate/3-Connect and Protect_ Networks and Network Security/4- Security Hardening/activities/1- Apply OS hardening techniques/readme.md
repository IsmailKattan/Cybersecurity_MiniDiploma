# نظرة عامة على النشاط

في هذا النشاط، ستتولى دور محلل أمن سيبراني يعمل لدى شركة تستضيف موقع الطبخ **yummyrecipesforme.com**. يعاني زوار الموقع من مشكلة أمنية عند تحميل الصفحة الرئيسية. مهمتك هي التحقيق، التحديد، التوثيق، واقتراح حل للمشكلة الأمنية.

عند التحقيق في الحدث الأمني، ستراجع سجل **tcpdump**. ستحتاج إلى تحديد **بروتوكولات الشبكة** المستخدمة لإنشاء الاتصال بين المستخدم والموقع. بروتوكولات الشبكة هي القواعد والمعايير التي تستخدمها الأجهزة المتصلة لنقل البيانات. ولسوء الحظ، يمكن للمهاجمين أيضًا استغلال هذه البروتوكولات لمهاجمة الشبكات. معرفة كيفية تحديد البروتوكولات المستخدمة عادةً في الهجمات يساعدك على حماية الشبكة من هذه الأحداث.

ستقوم أيضًا بتوثيق ما حدث أثناء الحادث الأمني ثم اقتراح إجراء أمني يساعد في منع تكرار المشكلة.

---

# السيناريو

أنت محلل أمن سيبراني لموقع **yummyrecipesforme.com** الذي يبيع وصفات وكتب طبخ. قام موظف سابق بتنفيذ هجوم لإغراء المستخدمين بزيارة موقع مزيف يحتوي على برمجيات خبيثة.

قام الموظف السابق/الهاكر بتنفيذ **هجوم brute force** للوصول إلى لوحة تحكم الخادم. قام بإدخال كلمات المرور الافتراضية المعروفة عدة مرات حتى تمكن من تخمين كلمة المرور الصحيحة. بعد حصوله على بيانات الدخول، تمكن من الوصول إلى لوحة الإدارة وتغيير شيفرة الموقع. قام بإضافة وظيفة **JavaScript** لعرض رسالة تطالب الزائرين بتنزيل وتشغيل ملف عند زيارة الموقع. وبعد تضمين البرمجية الخبيثة، قام بتغيير كلمة مرور الحساب الإداري.

عندما يقوم العملاء بتنزيل الملف، يتم توجيههم إلى موقع مزيف يحتوي على البرمجيات الضارة.

بعد ساعات من الهجوم، أرسل عدة عملاء رسائل إلى فريق الدعم يشكون من ظهور رسالة تطلب تنزيل ملف للحصول على وصفات مجانية، وبعد تشغيل الملف تغير عنوان الموقع وبدأت أجهزتهم بالعمل ببطء.

عند محاولة مالك الموقع تسجيل الدخول للوحة التحكم، لم يستطع، فاتصل بمقدم خدمة الاستضافة. تم تكليفك وفريق الأمن السيبراني بالتحقيق.

قمت بإنشاء بيئة **Sandbox** لمراقبة سلوك الموقع. قمت بتشغيل **tcpdump** ثم زرت الموقع. فور التحميل، ظهرت لك مطالبة لتنزيل ملف "تحديث المتصفح". قبلت التنزيل وشغّلت الملف، فتم إعادة توجيه المتصفح إلى موقع آخر **greatrecipesforme.com** يحتوي على البرمجية الخبيثة.

أظهرت السجلات الخطوات التالية:

1. المتصفح يرسل **طلب DNS** للحصول على عنوان IP الخاص بـ yummyrecipesforme.com  
2. خادم DNS يرسل عنوان IP الصحيح  
3. المتصفح يرسل **طلب HTTP** للوصول إلى الموقع  
4. المتصفح يبدأ تنزيل البرمجية الخبيثة  
5. المتصفح يرسل **طلب DNS** لموقع greatrecipesforme.com  
6. خادم DNS يرسل عنوان IP الجديد  
7. المتصفح يرسل **طلب HTTP** إلى موقع greatrecipesforme.com  

أكد محلل كبير أن الموقع تم اختراقه. وجد في الشيفرة وجود JavaScript تمت إضافته لإجبار الزوار على تنزيل ملف تنفيذي. وأظهر تحليل الملف أنه يقوم بإعادة التوجيه إلى موقع مزيف.

أكد فريق الأمن أن الخادم تعرض لهجوم brute force. كانت كلمة مرور الإدارة هي الكلمة الافتراضية ولم توجد آليات لمنع الهجوم.

مهمتك هي **توثيق الحادث بالتفصيل** وتحديد **بروتوكولات الشبكة المستخدمة** واقتراح **إجراء أمني لمنع هجمات brute force** مستقبلًا.

---

# التعليمات خطوة بخطوة

## الخطوة 1: الوصول إلى القالب

[إليك القالب الذي ستستخدمه](https://docs.google.com/document/d/1bmTZQGiYdJSgwQ08IpXWEUWhnKMVbJ2KZxsheZhzMMs/template/preview)

**Link to template:**  

[سجلات tcpdump](https://docs.google.com/document/d/1HDAQTLSK5CyPLPHeLI0s75kNE-kA2kG0NFJoZlz0xCc/template/preview?resourcekey=0-vDSHnW4qKxOOQtsZeGRUeQ) 

[كيف تقرأ سجلات tcpdump](https://docs.google.com/document/d/1zuVm_KixJqoHxrMefsxG0bi1tB6RYBQsXkPHIWxdRag/template/preview#heading=h.shz1bcdh2tm3)

---

## الخطوة 2: الوصول إلى المواد الداعمة
اضغط على الروابط ثم اختر **Use Template**:

**Links to supporting materials:**  
<رابطان سنعمل عليهما لاحقًا>

---

# الخطوات 3، 4، و5

## الخطوة 3: تحديد بروتوكول الشبكة المرتبط بالحادث
باستخدام سجل **tcpdump**، حدد البروتوكولات التي ظهرت في الاتصالات.  
تذكّر طبقات نموذج TCP/IP والبروتوكولات التي تحدث في كل طبقة.

---

## الخطوة 4: توثيق الحادث
لخّص ما حدث في القسم الثاني من التقرير، ويجب أن يتضمن:

- تجنب اللغة الانفعالية  
- إدراج أكبر عدد ممكن من الحقائق  
- تحديد مكان وسبب وكيفية حدوث الحادث  
- ذكر مصادر الأدلة  
- وصف ما اكتشفه المحللون  

التوثيق الدقيق يساعد في التحقيقات المستقبلية ويُستخدم في الالتزام بمعايير الأمن.

---

## الخطوة 5: التوصية بإجراء لمنع هجمات brute force
اختر إجراءً أمنيًا واحدًا وفسّر سبب فعاليته.

أمثلة على الإجراءات الممكنة:

- فرض كلمات مرور قوية  
- تفعيل المصادقة الثنائية **2FA**  
- مراقبة محاولات تسجيل الدخول  
- تغيير كلمات المرور دوريًا  
- منع استخدام كلمات المرور السابقة  
- تحديد عدد محاولات تسجيل الدخول  

ستكتب هذه التوصية في القسم الثالث من التقرير.

---

# ما يجب تضمينه في إجابتك

- تحديد *بروتوكول شبكة واحد* ظهر في التحقيق  
- توثيق الحادث  
- تقديم توصية أمنية واحدة  

---

# تقرير حادث أمني: تطبيق تقنيات تقسية نظام التشغيل

## القسم الأول: تحديد بروتوكول الشبكة المتعلق بالحادث

البروتوكول المتعلق بالحادث هو **بروتوكول نقل النص التشعبي (HTTP - Hypertext Transfer Protocol)**. نظراً لأن المشكلة كانت متعلقة بالوصول إلى خادم الويب لموقع yummyrecipesforme.com، فإننا نعلم أن الطلبات المرسلة إلى خوادم الويب للحصول على صفحات الويب تتضمن حركة مرور http. أيضاً، عندما قمنا بتشغيل tcpdump والوصول إلى موقع yummyrecipesforme.com، أظهر ملف سجل tcpdump المقابل استخدام بروتوكول http عند الاتصال. لوحظ أن الملف الخبيث يتم نقله إلى أجهزة كمبيوتر المستخدمين باستخدام بروتوكول HTTP في طبقة التطبيق.

---

## القسم الثاني: توثيق الحادث

اتصل العديد من العملاء بمكتب المساعدة الخاص بالموقع مفيدين بأنه عند زيارتهم للموقع، تمت مطالبتهم بتنزيل وتشغيل ملف يحتوي على وصول إلى وصفات جديدة. أصبحت أجهزة الكمبيوتر الشخصية الخاصة بهم تعمل ببطء منذ ذلك الحين. حاول مالك الموقع تسجيل الدخول إلى خادم الويب لكنه لاحظ أنه مقفل خارج حسابه.

استخدم محلل الأمن السيبراني **بيئة حماية (Sandbox Environment)** لفتح الموقع دون التأثير على شبكة الشركة. ثم قام المحلل بتشغيل tcpdump لالتقاط حزم حركة مرور الشبكة الناتجة عن التفاعل مع الموقع. تمت مطالبة المحلل بتنزيل ملف يدعي أنه سيوفر وصولاً إلى وصفات مجانية، فقبل التنزيل وشغله. ثم أعاد المتصفح توجيه المحلل إلى موقع ويب مزيف (greatrecipesforme.com).

قام محلل الأمن السيبراني بفحص سجل tcpdump ولاحظ أن المتصفح طلب في البداية عنوان IP لموقع yummyrecipesforme.com. بمجرد إنشاء الاتصال مع الموقع عبر بروتوكول HTTP، تذكر المحلل تنزيل وتنفيذ الملف. أظهرت السجلات تغييراً مفاجئاً في حركة مرور الشبكة حيث طلب المتصفح عنوان IP جديداً لعنوان URL الخاص بـ greatrecipesforme.com. ثم تم إعادة توجيه حركة مرور الشبكة إلى عنوان IP الجديد لموقع greatrecipesforme.com.

قام محترف الأمن السيبراني الأقدم بتحليل الكود المصدري للمواقع والملف الذي تم تنزيله. اكتشف المحلل أن المهاجم قام بالتلاعب بالموقع لإضافة كود يطالب المستخدمين بتنزيل ملف خبيث متنكر في شكل تحديث للمتصفح. نظراً لأن مالك الموقع أفاد بأنه تم قفله خارج حساب المسؤول الخاص به، يعتقد الفريق أن المهاجم استخدم **هجوم القوة الغاشمة (Brute Force Attack)** للوصول إلى الحساب وتغيير كلمة مرور المسؤول. أدى تنفيذ الملف الخبيث إلى اختراق أجهزة كمبيوتر المستخدمين النهائيين.

---

## القسم الثالث: التوصية بحل أو أكثر لهجمات القوة الغاشمة

أحد التدابير الأمنية التي يخطط الفريق لتنفيذها للحماية من هجمات القوة الغاشمة هو **عدم السماح باستخدام كلمات المرور السابقة**. نظراً لأن الثغرة التي أدت إلى هذا الهجوم كانت قدرة المهاجم على استخدام كلمة مرور افتراضية لتسجيل الدخول، فمن المهم أن نمنع أي كلمات مرور قديمة مثل كلمات المرور الافتراضية من استخدامها لإعادة تعيين كلمة المرور.

إجراء داعم آخر هو **طلب تحديثات أكثر تكراراً لكلمات المرور**، بحيث في حالة علم أي شخص غير مصرح له بكلمة المرور، فمن غير المرجح أن يتمكن من استخدام كلمة المرور هذه إذا تم تحديثها عاجلاً وليس آجلاً.

أخيراً، حل مفيد آخر هو **تنفيذ المصادقة الثنائية (2FA - Two-Factor Authentication)**. تتطلب المصادقة الثنائية المصادقة عبر كلمة مرور وأيضاً عن طريق تأكيد رمز مرور لمرة واحدة (OTP - One-Time Passcode) يُرسل إما إلى بريدهم الإلكتروني أو هاتفهم. بمجرد أن يؤكد المستخدم هويته من خلال بيانات اعتماد تسجيل الدخول الخاصة به و OTP، سيحصل على وصول إلى النظام. أي مهاجم خبيث يحاول هجوم القوة الغاشمة من غير المرجح أن يحصل على وصول إلى النظام لأنه يتطلب مصادقة إضافية.

---


# شرح النموذج التوضيحي: تقرير حادث أمني

## شرح القسم الأول: تحديد بروتوكول الشبكة المتعلق بالحادث

### الهدف الأساسي من هذا القسم

كان الهدف الأساسي من هذا النشاط هو **تحديد بروتوكول الشبكة المستخدم في الحادث**. السطر الأول من التقرير يعلن الإجابة على هذه الخطوة.

### كيف تم تحديد البروتوكول؟

تم تحديد البروتوكول المعني باستخدام المعلومات المقدمة في السيناريو، سجل DNS و HTTP، والمعرفة التي تعلمتها حول نموذج TCP/IP في هذه الدورة:

#### 1. طلب DNS والرد


سجل tcpdump يظهر أن طلباً تم إرساله إلى خادم DNS لحل عنوان IP 
لعنوان URL الخاص بـ yummyrecipesforme.com. 
يرد خادم DNS بعنوان IP الصحيح.
يستخدم المتصفح هذا لتوجيه المستخدمين إلى الموقع الصحيح.


#### 2. استخدام بروتوكول HTTP


يذكر السيناريو أنه عندما يتم تحميل الموقع، تطالب وظيفة على الموقع 
المستخدمين بتنزيل ملف للوصول إلى وصفات مجانية. 
يشير كل من السيناريو والسجلات إلى أن هذا النشاط يحدث عبر بروتوكول HTTP، 
والذي تعلمت سابقاً أنه جزء من طبقة التطبيق في نموذج TCP/IP.


#### 3. إعادة التوجيه إلى موقع جديد


بعد أن يقوم المستخدم بتنزيل الملف وتشغيله، تُظهر السجلات أن متصفح 
المستخدم يرسل طلباً جديداً إلى خادم DNS لاسترداد عنوان IP 
لعنوان URL مختلف: greatrecipesforme.com. 
يرسل خادم DNS عنوان IP إلى متصفح المستخدمين ويتم إعادة توجيه 
المستخدمين إلى هذا الموقع الجديد عبر HTTP.


### مرجع مهم

يُرجى مراجعة المقال "How to read the tcpdump traffic log" المرتبط في الخطوة 2 من النشاط للحصول على شرح للأدلة الموجودة في السجل.

---

## شرح القسم الثاني: توثيق الحادث

يجب أن يحتوي القسم الثاني من التقرير على **تفسيرك لملف السجل وقسم السيناريو** في النشاط. يجب أن تكون قد ربطت هذه الأحداث بما تعلمته في الدورة لمساعدتك على وصف عملية التحقيق والتحليل.

### ملاحظة مهمة عن أسلوب الكتابة

إنها ممارسة شائعة في كتابة التقارير الإشارة إلى جميع الأشخاص المشاركين **بصيغة الغائب** (مثل "محلل الأمن السيبراني" أو "هم")، حتى عندما تكون أنت محلل الأمن السيبراني الذي يصف الإجراءات التي قمت بها.

### هيكل القسم الثاني

#### الفقرة الأولى: ملخص الأحداث والمشاكل


تلخص الأحداث والمشاكل المحددة عند الإبلاغ عن الحادث لأول مرة.
يمكن العثور على هذه المعلومات في بداية السيناريو.

في مثالنا:
- اتصل العملاء بمكتب المساعدة
- تمت مطالبتهم بتنزيل ملف
- أصبحت أجهزة الكمبيوتر بطيئة
- مالك الموقع مقفل خارج حسابه


#### الفقرة الثانية: أنشطة الاختبار


تصف أنشطة الاختبار المشاركة في التحقيق في هذا الحدث.
يتم توفير هذه المعلومات أيضاً في قسم السيناريو.
يجب أن تكون قد لخصت هذه الأنشطة بكلماتك الخاصة.

في مثالنا:
- استخدام بيئة Sandbox
- تشغيل tcpdump
- تنزيل وتشغيل الملف المشبوه
- ملاحظة إعادة التوجيه


#### الفقرة الثالثة: عمل التحليل


تصف عمل التحليل.
هذه المعلومات متاحة في السيناريو وملف السجل.

في مثالنا:
- فحص سجل tcpdump
- ملاحظة طلب IP الأولي
- ملاحظة التغيير المفاجئ في حركة المرور
- ملاحظة إعادة التوجيه إلى IP جديد


#### الفقرة الرابعة: الاستنتاجات


تضيف ما استنتجه محلل الأمن السيبراني الأقدم وفريق إدارة الحوادث 
حول السبب الجذري للهجوم.

في مثالنا:
- تحليل الكود المصدري
- اكتشاف التلاعب بالموقع
- الاعتقاد باستخدام هجوم القوة الغاشمة
- تأكيد اختراق أجهزة المستخدمين


---

## شرح القسم الثالث: التوصية بحل لهجمات القوة الغاشمة

في القسم الثالث، كان عليك الكتابة عن معالجة هجمات القوة الغاشمة. يجب أن تكون قد اخترت **واحداً أو أكثر من الخيارات** المقدمة في القراءة حول هجمات القوة الغاشمة. ثم يجب أن تكون قد شرحت طريقة المعالجة وكيف تعمل بكلماتك الخاصة.

### الحلول المقترحة في النموذج

#### الحل الأول: منع إعادة استخدام كلمات المرور السابقة


**لماذا هذا الحل؟**
- الثغرة كانت القدرة على استخدام كلمة مرور افتراضية
- منع كلمات المرور القديمة (بما في ذلك الافتراضية) من إعادة الاستخدام

**كيف يعمل؟**
- النظام يحفظ تاريخ كلمات المرور السابقة
- عند تغيير كلمة المرور، يتحقق من عدم تطابقها مع السابقة
- يجبر المستخدمين على اختيار كلمات مرور جديدة فعلياً


#### الحل الثاني: تحديثات أكثر تكراراً لكلمات المرور


**لماذا هذا الحل؟**
- تقليل مدة صلاحية كلمة المرور المخترقة
- في حالة معرفة شخص غير مصرح له بكلمة المرور

**كيف يعمل؟**
- فرض تغيير كلمة المرور كل 30 أو 60 أو 90 يوماً
- حتى لو حصل المهاجم على كلمة مرور، ستصبح غير صالحة قريباً
- يقلل نافذة الفرصة للمهاجم


**ملاحظة**: في النموذج التوضيحي الأول، تم اقتراح "كلمات مرور أطول (15 حرفاً أو أكثر)" بدلاً من "تحديثات أكثر تكراراً". كلا الحلين صحيح ومقبول.

#### الحل الثالث: المصادقة الثنائية (2FA)


**لماذا هذا الحل الأكثر فعالية؟**
- يضيف طبقة أمان إضافية بعد كلمة المرور
- حتى مع معرفة كلمة المرور، لا يمكن الوصول

**كيف يعمل؟**
1. المستخدم يدخل اسم المستخدم وكلمة المرور
2. النظام يرسل OTP إلى البريد الإلكتروني أو الهاتف
3. المستخدم يدخل OTP للتأكيد
4. فقط بعد التحقق من الخطوتين يتم منح الوصول

**الحماية من هجمات القوة الغاشمة:**
- المهاجم الخبيث الذي يحاول هجوم القوة الغاشمة لن يحصل على OTP
- بدون OTP، لا يمكن الوصول حتى مع كلمة مرور صحيحة


---

## ملخص المفاهيم الرئيسية المستخدمة

### الأدوات والتقنيات

| الأداة/التقنية | الاستخدام في الحادث |
|----------------|---------------------|
| **tcpdump** | التقاط وتحليل حزم حركة مرور الشبكة |
| **Sandbox Environment** | اختبار الموقع المشبوه بأمان دون التأثير على الشبكة |
| **DNS Logs** | تتبع طلبات DNS وإعادة التوجيه |
| **HTTP Protocol Analysis** | فهم كيفية نقل الملف الخبيث |

### البروتوكولات المستخدمة


DNS (Domain Name System)
└── يحل أسماء النطاقات إلى عناوين IP

HTTP (Hypertext Transfer Protocol)
└── ينقل صفحات الويب والملفات
    └── يعمل في طبقة التطبيق من نموذج TCP/IP


### تدابير الأمان المقترحة


1. Password Policy Hardening
   ├── منع إعادة استخدام كلمات المرور
   ├── طلب كلمات مرور أطول (15+ حرف)
   └── تحديثات منتظمة لكلمات المرور

2. Multi-Factor Authentication (2FA)
   ├── كلمة المرور (شيء تعرفه)
   └── OTP (شيء تستلمه)

3. Account Lockout Policies
   └── قفل الحساب بعد محاولات فاشلة متعددة


---

## نصائح لكتابة التقارير الأمنية

### 1. الوضوح والدقة


✓ استخدم مصطلحات تقنية دقيقة
✓ قدم تفاصيل كافية للفهم
✓ اربط الأحداث بالأدلة من السجلات


### 2. الهيكلية المنطقية


1. تحديد البروتوكول/التقنية
2. وصف ما حدث (التسلسل الزمني)
3. تحليل السبب الجذري
4. تقديم توصيات قابلة للتنفيذ


### 3. الاستناد إلى الأدلة


✓ ارجع دائماً إلى السجلات
✓ اقتبس من السيناريو عند الضرورة
✓ اشرح كيف توصلت إلى الاستنتاجات


### 4. التوصيات العملية


✓ حدد حلولاً محددة وقابلة للتطبيق
✓ اشرح كيف تعالج هذه الحلول المشكلة
✓ قدم أكثر من حل عند الإمكان (Defense in Depth)
