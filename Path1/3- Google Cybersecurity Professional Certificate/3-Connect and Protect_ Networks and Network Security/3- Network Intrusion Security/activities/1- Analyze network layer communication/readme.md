# نظرة عامة على النشاط (Activity Overview)

في هذا النشاط، ستقوم بتحليل حركة مرور **DNS** و **ICMP** أثناء انتقالها باستخدام بيانات من أداة تحليل بروتوكولات الشبكة. ستحدد أي بروتوكول شبكي تم استخدامه أثناء تقييم حادثة الأمن السيبراني.

في طبقة الإنترنت ضمن نموذج **TCP/IP**، يقوم بروتوكول **IP** بتنسيق حزم البيانات إلى مخططات (IP datagrams). ويمكن للمعلومات داخل المخطط أن تزود محللي الأمن السيبراني برؤية حول الحزم المشبوهة أثناء انتقالها.

معرفة كيفية تحديد حركة المرور الضارة المحتملة على الشبكة يساعد محللي الأمن السيبراني على تقييم المخاطر وتعزيز أمان الشبكات.

تأكد من إكمال هذا النشاط قبل المتابعة. عنصر الدورة التالي سيوفر لك نموذجًا مكتملًا للمقارنة.

---

# السيناريو (Scenario)

أنت محلل أمن سيبراني في شركة تقدم خدمات تقنية المعلومات. عدد من العملاء أبلغوا أنهم غير قادرين على الوصول إلى موقع الشركة:  
**www.yummyrecipesforme.com**  
وظهرت لهم رسالة الخطأ: **"destination port unreachable"** بعد انتظار تحميل الصفحة.

تحاول أنت زيارة الموقع وتتلقى الخطأ نفسه. لبدء الاستقصاء، تفتح أداة **tcpdump** وتحاول تحميل الموقع مجددًا.

لتحميل الصفحة، يقوم المتصفح بإرسال استعلام DNS إلى الخادم باستخدام بروتوكول **UDP** للحصول على عنوان IP المرتبط باسم النطاق. بعدها يستخدم المتصفح عنوان IP لإرسال طلب **HTTPS** إلى خادم الويب.

تُظهر أداة tcpdump أنه عند إرسال حزم UDP إلى خادم DNS، يعود الخادم بحزم **ICMP** تحتوي على رسالة الخطأ:  
**"udp port 53 unreachable"**

![tcpdump output](../images/tcpdump-result.png)

## ملخص سجل tcpdump

- السطران الأولان يعرضان طلب DNS الصادر من جهازك عبر UDP للحصول على عنوان IP للموقع.
- السطران الثالث والرابع يعرضان استجابة ICMP التي تحتوي على رسالة الخطأ، وتشير إلى أن الحزمة لم تصل إلى منفذ 53.
- الطابع الزمني مثال: **13:24:32.192571**  
- صيغة المصدر والوجهة مثال:  
  **192.51.100.15 > 203.0.113.2.domain**
- رقم تعريف الطلب: **35084**  
- العلم **"A?"** يوضح طلب سجل A في DNS.
- البروتوكول المستعمل في الاستجابة: **ICMP**
- رسالة الخطأ الأساسية: **"udp port 53 unreachable"**
- تكرر الخطأ لثلاث مرات حسب السجل.

---

# تعليمات خطوة بخطوة (Step-by-Step Instructions)

## الخطوة 1: الوصول إلى القالب  

- [يمكنك الوصول إلى محتوى القالب من هنا](#تقرير-حادثة-أمن-سيبراني) 

- [كما يمكنك الوصول إلى صيغة .docs من هنا](https://docs.google.com/document/d/1hwjSRYalxGd-qyRIXWz8LBVuSAgEq0AHXOF_BB7DdrI/template/preview)

## الخطوة 2: الوصول للمواد الداعمة  

- [يمكنك الوصول إلى المواد الداعمة من هنا](#مثال-على-تقرير-حادثة-أمن-سيبراني) 

- [كما يمكنك الوصول إلى صيغة .docs من هنا](https://docs.google.com/document/d/17-l7_zLY9fWiS4lGemxqgbnfSe8KG_OqM_PMfZA_gp4/template/preview)

---

# الخطوة 3: تقديم ملخص للمشكلة

بعد تحليل سجل tcpdump يجب:

- تقديم ملخص عن حركة المرور والبروتوكولات المستخدمة.
- ذكر تفاصيل من السجل مثل المنافذ والبروتوكولات والرسائل.
- تفسير مصدر المشكلة.
- كتابة الرد في الجزء الأول من تقرير الحادثة.

---

# الخطوة 4: شرح تحليلك للبيانات وتقديم حل واحد

في هذا الجزء يجب:

- تحديد وقت الإبلاغ الأول عن المشكلة.
- وصف السيناريو والأحداث والأعراض.
- شرح الوضع الحالي.
- توضيح المعلومات المكتشفة أثناء التحقيق.
- تحديد الخطوات التالية في الاستكشاف والحل.
- ذكر السبب الجذري المحتمل.
- كتابة الرد في الجزء الثاني من تقرير الحادثة.

---

# نصيحة

احفظ نسخة فارغة من القالب لاستخدامها لاحقًا في التدريب أو المشاريع.

---

# ما يجب تضمينه في الاستجابة

- ملخص للمشكلة بناءً على tcpdump  
- تفسير التحليل وذكر سبب محتمل واحد للحادث

---

# تقرير حادثة أمن سيبراني  
تحليل حركة مرور الشبكة (Network Traffic Analysis)

---

## الجزء 1: تقديم ملخص للمشكلة الموجودة في سجل حركة مرور DNS وICMP

يشير بروتوكول **UDP** إلى أن:  
يعتمد هذا على نتائج تحليل الشبكة، والتي تُظهر أن استجابة ICMP تحتوي على رسالة الخطأ:  
المنفذ المذكور في رسالة الخطأ يُستخدم لـ:  
أكثر مشكلة محتملة هي:

---

## الجزء 2: شرح تحليلك للبيانات وتقديم سبب واحد على الأقل للحادث

**وقت حدوث الحادث:**  
**كيف علم فريق تقنية المعلومات بالحادث:**  
**الإجراءات التي اتخذها فريق تقنية المعلومات للتحقيق:**  
**أبرز نتائج التحقيق (مثل تفاصيل المنفذ المتأثر، خادم DNS، إلخ):**  
**سبب محتمل للحادث:**

---

# مثال على تقرير حادثة أمن سيبراني

> ملاحظة: هذا المثال لحادثة مختلفة عن السيناريو المذكور في النشاط، ويُستخدم فقط لفهم شكل التقرير المتوقع.

---

## الجزء 1: ملخص المشكلة في سجل حركة مرور DNS وICMP

تشير سجلات محلل بروتوكولات الشبكة إلى أن **المنفذ 443 غير قابل للوصول** عند محاولة الوصول إلى موقع التحقق من خلفيات الموظفين.  
يُستخدم المنفذ 443 عادةً لحركة مرور **HTTPS**.  
قد يشير هذا إلى مشكلة في خادم الويب أو إعدادات الجدار الناري.  
من المحتمل أيضًا أن يكون هذا مؤشرًا على **هجوم ضار** يستهدف خادم الويب.

---

## الجزء 2: شرح التحليل وتقديم سبب واحد على الأقل للحادث

حدثت الحادثة هذا الصباح عندما أبلغ فريق الموارد البشرية (HR) أنهم غير قادرين على الوصول إلى بوابة التحقق من الخلفيات.  
استجاب فريق أمن الشبكات وبدأ بإجراء اختبارات باستخدام أداة tcpdump.  
أظهرت السجلات الناتجة أن **المنفذ 443 غير قابل للوصول**، وهو المنفذ المستخدم لحركة HTTPS.  

لا يزال الفريق يحقق في السبب الجذري لاستعادة الوصول إلى البوابة الآمنة. وتشمل الخطوات القادمة:  
- التحقق من إعدادات الجدار الناري للتأكد مما إذا كان المنفذ 443 محجوبًا  
- الاتصال بمدير نظام خادم الويب لفحص ما إذا كانت هناك مؤشرات على هجوم  

يعتقد فريق HR أنه من الممكن أن أحد الموظفين الجدد يحاول منعهم من إجراء التحقق الأمني.  
يشك فريق أمن الشبكات أن هذا الشخص ربما شن هجومًا أدى إلى تعطيل موقع التحقق.

---

# الحل؛ تقرير حادثة أمن سيبراني: تحليل حركة مرور الشبكة  
Cybersecurity Incident Report: Network Traffic Analysis

---

## الجزء 1: تقديم ملخص للمشكلة الموجودة في سجل tcpdump

كجزء من بروتوكول DNS، تم استخدام بروتوكول **UDP** للاتصال بخادم DNS من أجل استرجاع عنوان الـIP الخاص باسم النطاق **yummyrecipesforme.com**. تم استخدام بروتوكول **ICMP** للرد برسالة خطأ تشير إلى وجود مشكلات في الاتصال بخادم DNS.  
تُظهر السطور الأولى من كل حدث في السجل رسائل UDP الصادرة من المتصفح إلى خادم DNS، بينما تعرض السطران الثالث والرابع رسالة الخطأ القادمة من خادم DNS إلى المتصفح عبر ICMP، والتي تحتوي على العبارة: **"udp port 53 unreachable"**.  
نظرًا لأن المنفذ 53 مرتبط مباشرةً بحركة مرور بروتوكول DNS، فهذا يشير إلى مشكلة في خادم DNS نفسه.

تظهر علامات إضافية على المشكلة في أداء بروتوكول DNS من خلال وجود علامة الزائد بعد رقم تعريف الطلب **35084**، مما يشير إلى وجود أعلام في رسالة UDP، وكذلك رمز **"A?"** الذي يشير إلى علم خاص بعمليات بروتوكول DNS.  
وبناءً على رسالة خطأ ICMP الخاصة بمنفذ 53، فمن المرجح جدًا أن **خادم DNS لا يستجيب**، وتدعم الأعلام المرتبطة برسالة UDP الصادرة وطلب اسم النطاق هذا الافتراض.

---

## الجزء 2: شرح التحليل وتقديم سبب واحد على الأقل للحادث

وقعت الحادثة اليوم في الساعة **1:24 مساءً**، حيث أبلغ العملاء أنهم استقبلوا رسالة الخطأ **"destination port unreachable"** عند محاولة زيارة موقع **yummyrecipesforme.com**.

فريق الأمن السيبراني الذي يقدم خدمات تقنية المعلومات للجهة العميلة بدأ في التحقيق لإعادة تمكين الوصول إلى الموقع.  
وخلال التحقيق، تم إجراء اختبارات تحليل الحزم باستخدام **tcpdump**. ووفقًا للسجل الناتج، تبيّن أن منفذ DNS رقم 53 **غير قابل للوصول**.  
الخطوة التالية تتمثل في تحديد ما إذا كان خادم DNS **معطلاً** أو أن حركة المرور عبر المنفذ 53 **محجوبة بواسطة الجدار الناري**.

قد يكون خادم DNS معطلاً بسبب **هجوم حرمان من الخدمة (DoS)** ناجح عليه أو بسبب **خطأ في الإعدادات**.

---

# الشرح التفصيلي للنموذج (Exemplar Explained)

## الجزء 1: ملخص المشكلة في سجل DNS وICMP

**A.** كجزء من بروتوكول DNS، تم استخدام بروتوكول UDP للاتصال بخادم DNS لاسترجاع عنوان IP لنطاق yummyrecipesforme.com، وتم استخدام ICMP لإرجاع رسالة خطأ تشير إلى مشكلة في الاتصال بخادم DNS.  

**B.** تظهر رسائل UDP الصادرة من المتصفح إلى خادم DNS في السطرين الأول والثاني من كل حدث في السجل. بينما تظهر رسائل الخطأ ICMP من الخادم إلى المتصفح في السطرين الثالث والرابع وتتضمن رسالة: **"udp port 53 unreachable"**.  
نظرًا لأن المنفذ 53 هو منفذ حركة مرور DNS، فهذا يدل على وجود مشكلة في خادم DNS.  
كما تشير العلامات "+" بعد رقم التعريف **35084**، والرمز **"A?"** إلى وجود أعلام خاصة بطلبات DNS — وهي مؤشرات على خلل في الأداء.

**C.** بسبب رسالة خطأ ICMP الخاصة بمنفذ 53، فمن المرجح أن خادم DNS **غير مستجيب**. تدعم الأعلام المرتبطة برسالة UDP هذا الاستنتاج.

### شرح النقاط A وB وC:

- النقطة A: تتطلب تقديم ملخص قصير لتحليل ملف tcpdump وتحديد البروتوكولات المستخدمة.  
- النقطة B: تتطلب ذكر ما أوضحته السجلات مثل المنافذ والبروتوكولات والرسائل.  
- النقطة C: تتطلب تفسير المشكلة وتحديد أن خادم DNS غير مستجيب — وهو ما يشير إليه المنفذ 53 غير القابل للوصول.

---

## الجزء 2: شرح التحليل وسبب محتمل واحد على الأقل للحادث

**D.** حدثت الحادثة اليوم عند الساعة **1:24 مساءً**.  

**E.** علم الفريق بالحادث عند إبلاغ العملاء أنهم تلقوا رسالة **"destination port unreachable"** عند محاولة زيارة الموقع.  

**F.** فريق الأمن السيبراني يتابع التحقيق لإعادة الخدمة للعمل.  

**G.** أثناء التحقيق، أُجريت عملية التقاط حزم باستخدام tcpdump، وتبين أن منفذ DNS رقم 53 **غير قابل للوصول**.  

**H.** الخطوة التالية هي التحقق مما إذا كان خادم DNS معطلاً أو ما إذا كان الجدار الناري يحجب حركة المرور إلى المنفذ 53.  

**I.** السبب المحتمل: قد يكون خادم DNS تعرض لهجوم **DoS** أدى إلى تعطله، أو ربما حدث خطأ في إعدادات الجدار الناري أدى إلى حجب المنفذ.

### شرح النقاط D إلى I:

- **D**: يجب ذكر وقت حدوث الحادث، بناءً على الطابع الزمني للسجل.  
- **E**: توضيح الأحداث الأولى الواردة من المستخدمين أو الأنظمة.  
- **F**: شرح الحالة الحالية للتحقيق.  
- **G**: تلخيص أهم نتائج التحليل حتى هذه اللحظة.  
- **H**: تحديد الخطوات التالية لمعالجة المشكلة.  
- **I**: تحديد السبب الجذري المحتمل — مثل هجوم DoS أو خطأ في الإعدادات.

---
