<div dir="rtl">

# ملخص: تأمين الشبكات ضد الاختراقات (Network Intrusion Security)

## جدول المحتويات

- [مقدمة في تكتيكات اختراق الشبكات](#مقدمة-في-تكتيكات-اختراق-الشبكات)
- [كيف تؤثر الاختراقات على الأنظمة](#كيف-تؤثر-الاختراقات-على-الأنظمة)
- [هجمات حجب الخدمة DoS/DDoS](#هجمات-حجب-الخدمة-dosddos)
- [قراءة سجلات tcpdump](#قراءة-سجلات-tcpdump)
- [هجوم DDoS حقيقي على خوادم DNS](#هجوم-ddos-حقيقي-على-خوادم-dns)
- [التنصت الضار على الحزم](#التنصت-الضار-على-الحزم-malicious-packet-sniffing)
- [انتحال عنوان IP](#انتحال-عنوان-ip-ip-spoofing)
- [نظرة شاملة على تكتيكات الاعتراض](#نظرة-شاملة-على-تكتيكات-الاعتراض-interception-tactics)

---

## مقدمة في تكتيكات اختراق الشبكات

### لماذا نحتاج لتأمين الشبكات؟

الشبكات معرضة باستمرار لخطر الهجمات من قبل المخترقين الخبيثين. يمكن للمهاجمين اختراق الشبكات عبر البرمجيات الخبيثة (Malware)، الانتحال (Spoofing)، أو التنصت على الحزم (Packet Sniffing). كما يمكن تعطيل عمليات الشبكة من خلال هجمات مثل إغراق الحزم (Packet Flooding).

##### الآثار المحتملة للهجمات:

**الأضرار المالية**: عندما يتوقف النظام عن العمل، لا تستطيع الشركة القيام بالمهام المدرة للدخل. تكاليف الإصلاح وإعادة بناء البنية التحتية قد تكون باهظة، بالإضافة إلى التكاليف المرتبطة ببرامج الفدية المحتملة والدعاوى القضائية.

**الأضرار بالسمعة**: عندما يصبح معروفاً أن شركة تعرضت لهجوم سيبراني، قد يفقد الجمهور الثقة في ممارساتها الأمنية ويتحول إلى المنافسين.

**السلامة العامة**: الهجمات على الشبكات الحكومية قد تؤثر على سلامة ورفاهية المواطنين. الوصول الخبيث إلى شبكة الطاقة، نظام المياه العامة، أو أنظمة الاتصالات الدفاعية العسكرية يمكن أن يسبب ضرراً جسدياً للجمهور.

**مثال واقعي**: في 2014، تعرضت شركة Home Depot لهجوم اخترق خوادمها بالبرمجيات الخبيثة، مما أدى إلى سرقة معلومات بطاقات الائتمان والخصم لأكثر من 56 مليون عميل.

---

## كيف تؤثر الاختراقات على الأنظمة

### هجمات اعتراض الشبكة (Network Interception Attacks)

تعمل هذه الهجمات عبر اعتراض حركة مرور الشبكة وسرقة المعلومات القيمة أو التدخل في الإرسال. يستخدم المهاجمون أدوات أجهزة أو برمجيات لالتقاط وفحص البيانات أثناء النقل، وهذا ما يسمى **التنصت على الحزم (Packet Sniffing)**.

يمكن للمهاجمين أيضاً اعتراض حركة المرور وتعديلها عبر إدخال تعديلات برمجية خبيثة أو تغيير الرسالة وتعطيل عمليات الشبكة. مثال: اعتراض تحويل بنكي وتغيير الحساب المستلم لحساب يسيطر عليه المهاجم.

### هجمات الباب الخلفي (Backdoor Attacks)

**الباب الخلفي (Backdoor)** هو ضعف متعمد يتركه المبرمجون أو مسؤولو الأنظمة لتجاوز آليات التحكم في الوصول العادية. يُقصد بها في الأصل مساعدة المبرمجين في استكشاف الأخطاء أو المهام الإدارية، لكن يمكن للمهاجمين أيضاً تثبيتها بعد اختراق المنظمة لضمان الوصول المستمر.

بمجرد دخول المخترق إلى شبكة غير آمنة عبر باب خلفي، يمكنه: تثبيت البرمجيات الخبيثة، تنفيذ هجوم DoS، سرقة معلومات خاصة، أو تغيير إعدادات الأمان.

---

## هجمات حجب الخدمة (DoS/DDoS)

### ما هو هجوم DoS؟

**هجوم حجب الخدمة (Denial of Service - DoS)** هو هجوم يستهدف شبكة أو خادم ويغرقه بحركة مرور الشبكة. الهدف هو تعطيل العمليات التجارية العادية عبر تحميل شبكة المنظمة بشكل زائد، مما يجعلها غير قادرة على الاستجابة للمستخدمين الشرعيين.

**هجوم حجب الخدمة الموزع (Distributed Denial of Service - DDoS)** هو نوع من هجمات DoS يستخدم أجهزة أو خوادم متعددة في مواقع مختلفة لإغراق الشبكة المستهدفة بحركة مرور غير مرغوب فيها.

### أنواع هجمات DoS الشائعة:

##### 1. هجوم SYN Flood

**هجوم SYN Flood** هو نوع من هجمات DoS يحاكي اتصال TCP ويغرق الخادم بحزم SYN.

**آلية العمل**: يستغل المهاجمون بروتوكول المصافحة الثلاثية (Three-Way Handshake):
1. الجهاز يرسل طلب SYN (synchronize) للخادم
2. الخادم يرد بحزمة SYN/ACK ويترك منفذاً مفتوحاً
3. يجب أن يرسل الجهاز حزمة ACK النهائية لإتمام الاتصال

المهاجمون يغرقون الخادم بطلبات SYN دون إكمال المصافحة، مما يستنفد المنافذ المتاحة ويعطل الخادم.

##### 2. هجوم ICMP Flood

**بروتوكول ICMP (Internet Control Message Protocol)** يُستخدم من قبل الأجهزة لإخبار بعضها البعض عن أخطاء نقل البيانات عبر الشبكة.

**هجوم ICMP Flood** يحدث عندما يرسل المهاجم بشكل متكرر حزم ICMP إلى خادم الشبكة، مما يجبر الخادم على إرسال حزم ICMP بالمقابل. هذا يستنفد كل النطاق الترددي (Bandwidth) لحركة المرور الواردة والصادرة ويؤدي لتعطل الخادم.

##### 3. هجوم Ping of Death

**هجوم Ping of Death** هو نوع من هجمات DoS يحدث عندما يرسل المخترق إلى النظام حزمة ICMP بحجم أكبر من 64 كيلوبايت (الحجم الأقصى للحزمة ICMP الصحيحة). إرسال حزمة ICMP ضخمة إلى خادم شبكة ضعيف سيحمله بشكل زائد ويؤدي لتعطله.

### الحماية من هجمات DoS/DDoS:

- تكوين جدران الحماية (Firewalls) بشكل صحيح لرفض الحزم المشبوهة
- استخدام أنظمة كشف الحالات الشاذة (Anomaly Detection)
- تنفيذ حلول التوزيع الديناميكي (Dynamic Scaling) للعمليات المهمة

---

## قراءة سجلات tcpdump

### ما هو tcpdump؟

**tcpdump**

 هو محلل بروتوكول شبكة (Network Protocol Analyzer) يعمل عبر سطر الأوامر (Command-line). إنه شائع وخفيف (يستخدم ذاكرة قليلة واستهلاك CPU منخفض)، ويستخدم مكتبة libpcap مفتوحة المصدر. يعمل tcpdump بشكل نصي، حيث يتم تنفيذ جميع الأوامر في الطرفية (Terminal).

### استخدامات tcpdump:

- إنشاء خط أساس لأنماط حركة مرور الشبكة ومقاييس استخدام الشبكة
- الكشف عن وتحديد حركة المرور الخبيثة
- إنشاء تنبيهات مخصصة
- تحديد موقع تطبيقات المراسلة الفورية غير المصرح بها أو نقاط الوصول اللاسلكية

### تفسير المخرجات:

عند تشغيل أمر tcpdump، تتضمن المعلومات المعروضة:

- **الطابع الزمني (Timestamp)**: بصيغة ساعات، دقائق، ثوان، وأجزاء من الثانية
- **عنوان IP المصدر (Source IP)**: أصل الحزمة
- **منفذ المصدر (Source Port)**: المنفذ الذي نشأت منه الحزمة
- **عنوان IP الوجهة (Destination IP)**: الوجهة المرسلة إليها الحزمة
- **منفذ الوجهة (Destination Port)**: المنفذ المرسلة إليه الحزمة

![interpreting output](./images/interpreting-output.png)

**ملاحظة مهمة**: المهاجمون يمكنهم أيضاً استخدام محللات بروتوكول الشبكة بشكل خبيث للحصول على معلومات حساسة مثل أسماء المستخدمين وكلمات المرور.

---

## هجوم DDoS حقيقي على خوادم DNS

### الخلفية:

في 21 أكتوبر 2016، تعرض مزود خدمة DNS لهجوم DDoS أثر على العديد من الشركات الكبرى التي تستخدم خدمته.

### ما قبل الهجوم:

مجموعة من طلاب الجامعات أنشأوا **شبكة بوت (Botnet)** - وهي مجموعة من أجهزة الكمبيوتر المصابة بالبرمجيات الخبيثة والتي تخضع لسيطرة مهاجم واحد يُعرف باسم "راعي البوت (Bot-herder)". نشر الطلاب كود الشبكة البوتية على الإنترنت، مما جعله متاحاً لآلاف مستخدمي الإنترنت وسمح لمجرمين إلكترونيين آخرين بالتحكم فيها عن بُعد.

### يوم الهجوم:

في الساعة 7:00 صباحاً، أرسلت الشبكة البوتية عشرات الملايين من طلبات DNS إلى مزود الخدمة. هذا أرهق النظام وأدى إلى إيقاف خدمة DNS، مما يعني أن جميع المواقع التي تستخدم مزود الخدمة لم تعد قابلة للوصول. حدثت انقطاعات في جميع أنحاء أمريكا الشمالية وأوروبا.

تم استعادة أنظمة مزود الخدمة بعد ساعتين فقط من التوقف. وعلى الرغم من أن المجرمين الإلكترونيين أرسلوا موجات لاحقة من هجمات الشبكة البوتية، كانت الشركة مستعدة وقادرة على تخفيف التأثير.

### الدرس المستفاد:

أهمية وجود عمليات موزعة عبر مضيفات (Hosts) يمكن توسيع نطاقها ديناميكياً، بحيث يمكن استمرار العمليات إذا توقفت البنية التحتية الأساسية.

---

## التنصت الضار على الحزم (Malicious Packet Sniffing)

### ما هو التنصت على الحزم؟

**التنصت على الحزم (Packet Sniffing)** هو ممارسة استخدام أدوات برمجية لمراقبة البيانات أثناء تحركها عبر الشبكة. الحزم تحتوي على رأس (Header) يتضمن عناوين IP للمرسل والمستقبل، وجسم (Body) قد يحتوي على معلومات قيمة مثل الأسماء، تاريخ الميلاد، رسائل شخصية، معلومات مالية، وأرقام بطاقات الائتمان.

محللو الأمن يستخدمون التنصت على الحزم لتحليل والتقاط الحزم عند التحقيق في حوادث جارية أو تصحيح مشاكل الشبكة. لكن المهاجمين الخبيثين قد يستخدمون التنصت للنظر إلى بيانات لم تُرسل إليهم.

### أنواع التنصت على الحزم:

##### 1. التنصت السلبي (Passive Packet Sniffing)

نوع من الهجوم حيث تُقرأ حزم البيانات أثناء النقل. نظراً لأن جميع حركة المرور على الشبكة مرئية لأي مضيف على المحور (Hub)، يمكن للمهاجمين الخبيثين عرض جميع المعلومات الواردة والصادرة من الجهاز المستهدف.

##### 2. التنصت النشط (Active Packet Sniffing)

نوع من الهجوم حيث يتم التلاعب بحزم البيانات أثناء النقل. قد يشمل ذلك حقن بروتوكولات الإنترنت لإعادة توجيه الحزم إلى منفذ غير مقصود أو تغيير المعلومات التي تحتويها الحزمة.

### الحماية من التنصت الضار على الحزم:

1. **استخدام VPN**: لتشفير وحماية البيانات أثناء تنقلها عبر الشبكة
2. **التأكد من استخدام HTTPS**: الذي يستخدم SSL/TLS لتشفير البيانات ومنع التنصت
3. **تجنب شبكات WiFi غير المحمية**: الشبكات العامة في الأماكن العامة (المقاهي، المطاعم، المطارات) لا تستخدم التشفير، مما يجعل جميع البيانات مكشوفة

---

## انتحال عنوان IP (IP Spoofing)

### ما هو انتحال IP؟

**انتحال IP (IP Spoofing)** هو هجوم شبكي يُنفذ عندما يغير المهاجم عنوان IP المصدر لحزمة البيانات لانتحال شخصية نظام مصرح به والوصول إلى الشبكة. المخترق يتظاهر بأنه شخص آخر للتواصل عبر الشبكة مع الكمبيوتر المستهدف وتجاوز قواعد جدار الحماية التي قد تمنع حركة المرور الخارجية.

### هجمات انتحال IP الشائعة:

##### 1. الهجوم في المسار (On-Path Attack)

هجوم حيث يضع المهاجم الخبيث نفسه في منتصف اتصال مصرح به ويعترض أو يغير البيانات أثناء النقل. يُعرف أيضاً باسم "هجوم الرجل في الوسط (Man-in-the-Middle Attack)".

المهاجمون يصلون إلى الشبكة ويضعون أنفسهم بين جهازين (مثل متصفح الويب وخادم الويب)، ثم يتنصتون على معلومات الحزم لمعرفة عناوين IP وMAC للأجهزة المتصلة. بعد ذلك، يمكنهم التظاهر بأنهم أي من هذه الأجهزة.

##### 2. هجوم الإعادة (Replay Attack)

هجوم شبكي يُنفذ عندما يعترض المهاجم الخبيث حزمة بيانات أثناء النقل ويؤخرها أو يكررها في وقت آخر. يمكن للحزمة المتأخرة أن تسبب مشاكل في الاتصال بين أجهزة الكمبيوتر المستهدفة، أو قد يأخذ المهاجم إرسال شبكة أُرسل من قبل مستخدم مصرح به ويكرره في وقت لاحق لانتحال شخصية المستخدم المصرح به.

##### 3. هجوم Smurf

مزيج من هجوم DDoS وهجوم انتحال IP. يتنصت المهاجم على عنوان IP لمستخدم مصرح به ويغرقه بالحزم، مما يرهق الكمبيوتر المستهدف ويمكن أن يؤدي إلى إسقاط الخادم أو الشبكة بأكملها.

في هجوم Smurf، يتم دمج انتحال IP مع تقنية DoS أخرى لإغراق الشبكة بحركة مرور غير مرغوب فيها. يمكن أن تتضمن الحزمة المنتحلة رسالة ICMP ping. عند إرسال رسائل ICMP كثيرة جداً، تُرهق استجابات ICMP الخوادم على الشبكة وتؤدي إلى إيقافها.

### الحماية من انتحال IP:

1. **تنفيذ التشفير دائماً**: بحيث لا يمكن قراءة البيانات في نقل الشبكة من قبل المهاجمين
2. **تكوين جدران الحماية بشكل صحيح**: لرفض جميع حركة المرور الواردة التي لها نفس عنوان IP للشبكة المحلية
3. **استخدام جدران حماية من الجيل التالي (NGFW)**: تتضمن ميزات تكتشف الحالات الشاذة في الشبكة للتأكد من اكتشاف البث الضخم قبل أن يتسبب في إسقاط الشبكة

---

## نظرة شاملة على تكتيكات الاعتراض (Interception Tactics)

### مراجعة أعمق لبطاقة واجهة الشبكة (NIC)

**بطاقة واجهة الشبكة (Network Interface Card - NIC)** هي قطعة من الأجهزة تربط الجهاز بالشبكة. تقرأ NIC نقل البيانات، وإذا كانت تحتوي على عنوان MAC للجهاز، فإنها تقبل الحزمة وترسلها إلى الجهاز لمعالجة المعلومات بناءً على البروتوكول.

يمكن ضبط NIC على **الوضع العشوائي (Promiscuous Mode)**، مما يعني أنها تقبل جميع حركة المرور على الشبكة، حتى الحزم التي لا تُعنون إلى جهاز NIC. قد يستخدم المهاجمون الخبيثون برامج مثل Wireshark لالتقاط البيانات على شبكة خاصة وتخزينها للاستخدام لاحقاً.

### استراتيجيات الدفاع:

**مبدأ الدفاع في العمق (Defense-in-Depth)**: لا توجد استراتيجية مثالية واحدة لإيقاف كل نوع من الهجمات. يمكن تعزيز الدفاع بطبقات من خلال استخدام استراتيجيات متعددة:

- استخدام التشفير القياسي في الصناعة (Industry Standard Encryption)
- تكوين جدران الحماية لرفض حزم IP غير المصرح بها وحركة المرور المشبوهة
- استخدام TLS لحماية ضد الهجمات في المسار
- مراقبة حركة المرور غير العادية باستخدام جدران حماية متقدمة

---

## ملاحظات ختامية

**الأجزاء المحذوفة**: 
- تم تجاوز المقابلة مع Matt حول تجربته المهنية، لأنها تحتوي على محتوى تحفيزي وشخصي أكثر من كونها تقنية.
- تم التركيز على الجوانب التقنية والعملية المهمة لمن لديه خلفية في علوم الحاسوب.

**المصطلحات التقنية المحفوظة**: تم الحفاظ على جميع المصطلحات التقنية باللغتين العربية والإنجليزية لسهولة المراجعة والبحث.

**أدوات مذكورة للممارسة العملية**:
- tcpdump
- Wireshark  
- SolarWinds NetFlow Traffic Analyzer
- ManageEngine OpManager
- Azure Network Watcher

</div>