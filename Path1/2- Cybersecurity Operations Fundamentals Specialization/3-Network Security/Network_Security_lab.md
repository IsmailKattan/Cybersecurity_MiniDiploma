# ุชุฏุฑูุจุงุช ุนูููุฉ ูู ุฃูู ุงูุดุจูุงุช
## Network Security - Practical Labs

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [NAT/PAT - ุชุฑุฌูุฉ ุนูุงููู ุงูุดุจูุฉ](#1-natpat---ุชุฑุฌูุฉ-ุนูุงููู-ุงูุดุจูุฉ)
2. [ACL - ููุงุฆู ุงูุชุญูู ุจุงููุตูู](#2-acl---ููุงุฆู-ุงูุชุญูู-ุจุงููุตูู)
3. [FTP ูุขููุฉ Established](#3-ftp-ูุขููุฉ-established)
4. [WAF ู Load Balancer](#4-waf-ู-load-balancer)
5. [Cisco Firepower - ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ](#5-cisco-firepower---ุชุญููู-ุงูุจุฑูุฌูุงุช-ุงูุฎุจูุซุฉ)
6. [ARP - ุจุฑูุชูููู ุชุญููู ุงูุนูุงููู](#6-arp---ุจุฑูุชูููู-ุชุญููู-ุงูุนูุงููู)
7. [Nmap - ูุณุญ ุงูุดุจูุงุช](#7-nmap---ูุณุญ-ุงูุดุจูุงุช)
8. [ICMP - ุงุฎุชุจุงุฑุงุช ุงูุดุจูุฉ](#8-icmp---ุงุฎุชุจุงุฑุงุช-ุงูุดุจูุฉ)
9. [SYN Flooding Attack](#9-syn-flooding-attack)
10. [UDP Flood Attack](#10-udp-flood-attack)
11. [Nmap Port Scanning](#11-nmap-port-scanning)
12. [John the Ripper - ูุณุฑ ูููุงุช ุงููุฑูุฑ](#12-john-the-ripper---ูุณุฑ-ูููุงุช-ุงููุฑูุฑ)
13. [DHCP Snooping](#13-dhcp-snooping)

---

## 1. NAT/PAT - ุชุฑุฌูุฉ ุนูุงููู ุงูุดุจูุฉ

### ๐ฏ ุงููุฏู
ููู ุขููุฉ ุนูู NAT/PAT ูู ุชุฑุฌูุฉ ุงูุนูุงููู ุงูุฎุงุตุฉ ุฅูู ุนูุงููู ุนุงูุฉ.

### ๐ ุงูุณููุงุฑูู
ุฌูุงุฒ ุฏุงุฎูู ุจุนููุงู `10.0.0.5` ูุฑูุฏ ุชุตูุญ ุงูุฅูุชุฑูุช ุนุจุฑ ุฌุฏุงุฑ ูุงุฑู ูุณุชุฎุฏู NAT.

### ๐ ุฎุทูุงุช ุงูุนูู

1. **ุงูุทูุจ ุงูุตุงุฏุฑ:**
   - ุงูุฌูุงุฒ ุงูุฏุงุฎูู `10.0.0.5` ูุฑุณู ุทูุจ HTTP
   - ุงูุฌุฏุงุฑ ุงููุงุฑู ูุชุฑุฌู ุงูุนููุงู ุฅูู `203.0.113.2:10500`
   - ุงูุนููุงู `203.0.113.2` ูู ุงูุนููุงู ุงูุนุงู
   - ุงููููุฐ `10500` ููุณุชุฎุฏู ูุชูููุฒ ุงูุงุชุตุงู

2. **ุงูุฑุฏ ุงููุงุฑุฏ:**
   - ุนูุฏ ูุตูู ุงูุฑุฏ ูู ุงูุฅูุชุฑูุช ุฅูู `203.0.113.2:10500`
   - ูุนูุฏ NAT ุงูุชุฑุฌูุฉ ุงูุนูุณูุฉ ุฅูู `10.0.0.5` ุจุงููููุฐ ุงูุฃุตูู
   - ูุชู ุชุณููู ุงูุจูุงูุงุช ููุฌูุงุฒ ุงูุฏุงุฎูู

### โ ุงููุงุฆุฏุฉ
- ูุฆุงุช ุงูุฃุฌูุฒุฉ ูููููุง ูุดุงุฑูุฉ ุนููุงู ุนุงู ูุงุญุฏ
- ูุง ููุฌุฏ ุชุถุงุฑุจ ุจูุถู ุงุณุชุฎุฏุงู ุฃุฑูุงู ุงูููุงูุฐ (Port Numbers)
- ุชูููุฑ ูู ุนูุงููู IPv4 ุงูุนุงูุฉ

### ๐ ููุงุญุธุงุช
- PAT (Port Address Translation) ูู ููุน ูู NAT
- ููุณูู ุฃูุถุงู NAT Overload
- ุงูุฌุฏูู ุงูุฏุงุฎูู ูุญุชูุธ ุจุงูุฑุจุท ุจูู ุงูุนูุงููู ุงูุฏุงุฎููุฉ ูุงูููุงูุฐ

---

## 2. ACL - ููุงุฆู ุงูุชุญูู ุจุงููุตูู

### ๐ฏ ุงููุฏู
ุชุทุจูู ุณูุงุณุงุช ุฃูููุฉ ุจุงุณุชุฎุฏุงู ููุงุฆู ุงูุชุญูู ุจุงููุตูู (Access Control Lists).

### ๐ ุงูุณููุงุฑูู
ูุฏูู:
- **Web Server** ูู DMZ (Demilitarized Zone)
- **Database Server** ุฏุงุฎู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ

> ๐ก **DMZ:** ููุทูุฉ ููุฒูุนุฉ ุงูุณูุงุญุ ููู ููุทูุฉ ุจูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ูุงูุฅูุชุฑูุช ูุชูููู ุงููุฎุงุทุฑ ุงูุฃูููุฉ.

### ๐ง ุงูุชูููู ุงูุนููู

```cisco
access-list 100 permit tcp any 10.10.10.10 eq www
access-list 100 permit tcp any 10.10.10.10 eq 443
access-list 100 permit tcp any 10.10.10.12 eq ftp
access-list 100 permit tcp any 10.10.10.12 eq ftp-data
access-list 100 deny ip any any log

interface gi0/1
ip access-group 100 in
```

### ๐ ุดุฑุญ ุงูุฃูุงูุฑ

| ุงูุฃูุฑ | ุงููุธููุฉ |
|------|---------|
| `permit tcp any 10.10.10.10 eq www` | ุงูุณูุงุญ ุจุงููุตูู ูุฎุงุฏู ุงูููุจ ุนุจุฑ HTTP (ูููุฐ 80) |
| `permit tcp any 10.10.10.10 eq 443` | ุงูุณูุงุญ ุจุงููุตูู ุนุจุฑ HTTPS (ูููุฐ 443) |
| `permit tcp any 10.10.10.12 eq ftp` | ุงูุณูุงุญ ุจู FTP Control (ูููุฐ 21) |
| `permit tcp any 10.10.10.12 eq ftp-data` | ุงูุณูุงุญ ุจู FTP Data (ูููุฐ 20) |
| `deny ip any any log` | ุญุธุฑ ุฃู ุญุฑูุฉ ุฃุฎุฑู ูุน ุงูุชุณุฌูู |
| `ip access-group 100 in` | ุชุทุจูู ุงููุงุฆูุฉ ุนูู ุงููุงุฌูุฉ |

### ๐ฏ ุงููุฏู ุงูุฃููู
- ุงูุณูุงุญ ุจุงููุตูู ููุท ููููุงูุฐ ุงููุทููุจุฉ
- ููุน ุงููุตูู ุงููุจุงุดุฑ ูุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุณุฌูู ุงููุญุงููุงุช ุงููุดุจููุฉ
- ุชูููู ูุทุงู ุงููุฌูู (Attack Surface)

### โ๏ธ ููุงุญุธุงุช ูููุฉ
- ุงููุตูู ููุงุนุฏุฉ ุงูุจูุงูุงุช ูุฌุจ ุฃู ูุชู ููุท ูู ุฎูุงู ุฎุงุฏู ุงูููุจ
- ุชุฑุชูุจ ุงูููุงุนุฏ ููู ุฌุฏุงู (ูู ุงูุฃุนูู ููุฃุณูู)
- ุงููุงุนุฏุฉ ุงูุถูููุฉ ูู ุงูููุงูุฉ: `deny any any`

---

## 3. FTP ูุขููุฉ Established

### ๐ฏ ุงููุฏู
ููู ุงููุฑู ุจูู FTP Passive ู Active Mode ูุชุฃุซูุฑู ุนูู ACL.

### ๐ ุจููุฉ FTP
ุจุฑูุชูููู FTP ูุณุชุฎุฏู ููุงุชูู ูููุตูุชูู:
- **Port 21:** ููุงุฉ ุงูุชุญูู (Control Channel)
- **Port 20:** ููุงุฉ ุงูุจูุงูุงุช (Data Channel)

### ๐ FTP Passive Mode

```
[Client] -----> [Server]
         Port 21 (Control)
         
[Client] <----- [Server]
         Random High Port (Data)
```

**ุขููุฉ ุงูุนูู:**
1. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุชุญูู ูุญู ุงููููุฐ 21
2. ุงูุนููู ูุทูุจ ูุถุน Passive
3. ุงูุฎุงุฏู ูุฑุฏ ุจูููุฐ ุนุดูุงุฆู ุนุงูู
4. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุจูุงูุงุช ูุญู ูุฐุง ุงููููุฐ
5. ูู ุงูุฑุฏูุฏ ุชุญุชูู ุนูู ุจุช ACK โ **ูุณููุญ ุจูุง** โ

### ๐ FTP Active Mode

```
[Client] -----> [Server]
         Port 21 (Control)
         
[Client] <----- [Server]
         Port 20 (Data initiated by server)
```

**ุขููุฉ ุงูุนูู:**
1. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุชุญูู ูุญู ุงููููุฐ 21
2. ุงูุนููู ูุฎุจุฑ ุงูุฎุงุฏู ุจูููุฐ ูุนูู ูุงุณุชูุจุงู ุงูุจูุงูุงุช
3. **ุงูุฎุงุฏู ูุจุฏุฃ ุงุชุตุงู ุงูุจูุงูุงุช** ูู ุงููููุฐ 20
4. ุฃูู ุญุฒูุฉ ูู ุงูุฎุงุฏู ุชุญุชูู ุนูู SYN ููุท โ **ุชูุฑูุถ** ๐ซ

### โ๏ธ ุงููุดููุฉ ูุน Established

```cisco
access-list 110 permit tcp any any established
```

ูุฐู ุงููุงุนุฏุฉ ุชุณูุญ ููุท ุจุงูุญุฒู ุงูุชู ุชุญุชูู ุนูู:
- ุจุช ACK
- ุฃู ุจุช RST

**ุงููุชูุฌุฉ:**
- ูู Active Modeุ ุงูุฎุงุฏู ูุฑุณู SYN ุฃููุงู
- ูุฐู ุงูุญุฒูุฉ ูุง ุชุญูู ุดุฑุท "established"
- ุงูุงุชุตุงู ููุดู ๐ซ

### โ ุงูุญู ุงูุฃูุซู
ุงุณุชุฎุฏุงู ุฌุฏุงุฑ ูุงุฑู ุญูููู (Stateful Firewall) ูุงุฏุฑ ุนูู:
- ุชุชุจุน ุงูุฌูุณุงุช ุงููุดุทุฉ
- ููู ุงูุจุฑูุชููููุงุช ุงููุนูุฏุฉ ูุซู FTP
- ุงูุณูุงุญ ุจุงูุงุชุตุงูุงุช ุงูุฏููุงููููุฉ ุชููุงุฆูุงู

### ๐ ุงูุฎูุงุตุฉ
- `established` ูุง ูููู ููุจุฑูุชููููุงุช ุงููุนูุฏุฉ
- FTP Passive Mode ุฃูุซุฑ ุชูุงููุงู ูุน ุงูุฌุฏุฑุงู ุงููุงุฑูุฉ
- Stateful Firewalls ุถุฑูุฑูุฉ ููุจูุฆุงุช ุงูุฅูุชุงุฌูุฉ

---

## 4. WAF ู Load Balancer

### ๐ฏ ุงููุฏู
ุจูุงุก ุจููุฉ ุชุญุชูุฉ ุขููุฉ ููุงุจูุฉ ููุชูุณุน ููููุน ููุจ.

### ๐ ุงูุณููุงุฑูู
ูููุน ููุจ ูุญุชูู ุนูู ุนุฏุฉ ุฎูุงุฏู Web Servers ุฎูู Load Balancerุ ูุน ุญูุงูุฉ ูู ูุฌูุงุช XSS.

### ๐๏ธ ุงูุจููุฉ ุงููุนูุงุฑูุฉ

```
[Internet]
    |
    โ
[WAF - Web Application Firewall]
    |
    โ
[Load Balancer]
    |
    โ------------------โ------------------โ------------------โ
[Web Server 1]   [Web Server 2]   [Web Server 3]   [Web Server 4]
```

### โ๏ธ ููุงู Load Balancer

**ุฎูุงุฑุฒููุฉ ุงูุชูุฒูุน:**
- **Round Robin:** ุชูุฒูุน ูุชุณุงูู ุนูู ุฌููุน ุงูุฎูุงุฏู
- ุฏูุฑุฉ ููุชุธูุฉ: Server 1 โ Server 2 โ Server 3 โ Server 4 โ ุชูุฑุงุฑ

**ุฅุฏุงุฑุฉ ุงูุฃุนุทุงู:**
1. ูุฑุงูุจุฉ ุตุญุฉ ุงูุฎูุงุฏู (Health Checks)
2. ุนูุฏ ูุดู ุฃุญุฏ ุงูุฎูุงุฏู:
   - ุฅุฒุงูุชู ูู ูุงุฆูุฉ ุงูุชูุฒูุน ุชููุงุฆูุงู
   - ุชุญููู ุทูุจุงุชู ุฅูู ุงูุฎูุงุฏู ุงูุณูููุฉ
3. ุนูุฏ ุนูุฏุฉ ุงูุฎุงุฏู: ุฅุนุงุฏุฉ ุฅุฏุฑุงุฌู ุชููุงุฆูุงู

### ๐ก๏ธ ููุงู WAF (ูู Reverse Proxy)

**ุงูุญูุงูุฉ ูู XSS:**
```javascript
// ูุซุงู ุนูู ูุญุงููุฉ ูุฌูู XSS
<script>alert('XSS Attack')</script>
```

**ุขููุฉ ุงูุญูุงูุฉ:**
1. ูุญุต ูู ุทูุจ HTTP ูุจู ูุตููู ููุฎูุงุฏู
2. ูุดู ุงูุดููุฑุงุช ุงูุฎุจูุซุฉ:
   - JavaScript ูุดุจูู
   - SQL Injection
   - Command Injection
3. ููุน ุงูุทูุจุงุช ุงููุดุจููุฉ ููุฑุงู โ
4. ููุน ุชุณุฑูุจ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุงุณุชุฌุงุจุงุช

### ๐ ุณูุงุณุงุช ุงูุฃูุงู

| ููุน ุงูุญูุงูุฉ | ุงููุธููุฉ |
|-------------|---------|
| XSS Prevention | ููุน ุญูู JavaScript |
| SQL Injection | ุญูุงูุฉ ููุงุนุฏ ุงูุจูุงูุงุช |
| CSRF Protection | ููุน ุงูุทูุจุงุช ุงููุฒูุฑุฉ |
| Rate Limiting | ุงูุญุฏ ูู ูุนุฏู ุงูุทูุจุงุช |
| IP Blacklisting | ุญุธุฑ IP ุงููุดุจููุฉ |

### โ ุงููุฒุงูุง ุงููุญููุฉ

**ุงูุฃุฏุงุก:**
- โก ุชูุฒูุน ุงูุฃุญูุงู ุจุดูู ูุชูุงุฒู
- ๐ ุชุญูู ุงูุฃุนุทุงู (Fault Tolerance)
- ๐ ูุงุจููุฉ ุงูุชูุณุน ุงูุฃููู

**ุงูุฃูุงู:**
- ๐ก๏ธ ุญูุงูุฉ ูุชูุฏูุฉ ูู WAF
- ๐ ูุญุต ุฌููุน ุงูุทูุจุงุช
- ๐ ุชุณุฌูู ุงููุญุงููุงุช ุงููุดุจููุฉ
- ๐ซ ุญุธุฑ ุงููุฌูุงุช ูู ุงูููุช ุงูุญูููู

### ๐ ูุซุงู ุนูู ุณุฌูุงุช WAF

```
2025-10-26 10:15:32 | BLOCKED | XSS Attempt | IP: 192.168.1.100
2025-10-26 10:16:45 | BLOCKED | SQL Injection | IP: 10.0.0.50
2025-10-26 10:17:12 | ALLOWED | Normal Request | IP: 172.16.0.25
```

---

## 5. Cisco Firepower - ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ

### ๐ฏ ุงููุฏู
ููู ููููุฉ ุนูู ุฃูุธูุฉ ูุดู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ ุงููุชูุฏูุฉ ูุชุชุจุน ุงูุชุดุงุฑูุง.

### ๐ ุงูุณููุงุฑูู
ููู ุจุงุณู `tool.exe` ุชู ุงูุชุดุงูู ุถูู ุญุฑูุฉ ุงููุฑูุฑ ุนูู ุงูุดุจูุฉ.

### ๐ ูุฑุงุญู ุงููุดู ูุงูุชุญููู

#### ุงููุฑุญูุฉ 1: ุงููุญุต ุงูุฃููู
1. **ุงุนุชุฑุงุถ ุงูููู:** ุฌูุงุฒ Cisco Firepower ููุญุต ุฌููุน ุงููููุงุช ุงููุงุฑุฉ
2. **ุญุณุงุจ ุงูุจุตูุฉ:** ุงุณุชุฎุฑุงุฌ ุจุตูุฉ SHA-256 ููููู
   ```
   SHA-256: a3f7b8c9d2e1f4a6b5c8d7e9f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0
   ```
3. **ุงูููุงุฑูุฉ:** ููุงุฑูุฉ ุงูุจุตูุฉ ูุน ูุงุนุฏุฉ ุจูุงูุงุช ุงูุชูุฏูุฏุงุช

#### ุงููุฑุญูุฉ 2: ุงูุชุตููู
```
Status: โ๏ธ MALWARE DETECTED
Threat Name: Generic.Trojan.Downloader
Threat Score: 95/100 (High)
Category: Trojan
First Seen: 2025-10-25 14:30:22
```

#### ุงููุฑุญูุฉ 3: ุชุญุฏูุฏ ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ
ุงูุฃุฌูุฒุฉ ุงูุชุงููุฉ ุชู ุชุญุฏูุฏูุง ููุตุงุจุฉ:
- ๐ฅ๏ธ `192.168.10.90`
- ๐ฅ๏ธ `192.168.133.50`

### ๐ Trajectory Map (ุฎุฑูุทุฉ ุงููุณุงุฑ)

```
Time โ
Device 1: --------[*]==========[*]-------
                   โ            โ
Device 2: --------[*]----[*]----[*]------
                         โ      โ
Device 3: ---------------[*]=====[*]-----
```

**ุฑููุฒ ุงูุฎุฑูุทุฉ:**
- `[*]` ููุทุฉ ุงูุชูุงู ุงูููู
- `=` ูุชุฑุฉ ูุดุงุท ุงูููู ุนูู ุงูุฌูุงุฒ
- `โ` ุงุชุฌุงู ุงูุชูุงู ุงูุนุฏูู (ูู ุฌูุงุฒ ูุขุฎุฑ)
- `-` ูุชุฑุฉ ุฎููู

### ๐ ุฌุฏูู ุงูุฃุญุฏุงุซ (Events Table)

| ุงูููุช | ุงูุฌูุงุฒ ุงููุตุฏุฑ | ุงูุฌูุงุฒ ุงููุฏู | ุงูุญุฏุซ | ุงูุญุงูุฉ |
|------|---------------|--------------|--------|--------|
| 14:30:22 | External | 192.168.10.90 | File Download | Infected |
| 14:35:18 | 192.168.10.90 | 192.168.133.50 | File Transfer | Infected |
| 14:42:33 | 192.168.133.50 | Network Share | Propagation Attempt | Blocked |

### ๐ฏ ุงุณุชุฎุฏุงูุงุช Trajectory Map

1. **ุชุญุฏูุฏ ุงููุตุฏุฑ ุงูุฃููู:**
   - ุฃูู ุฌูุงุฒ ุชููู ุงูููู
   - ููุทุฉ ุงูุฏุฎูู ุฅูู ุงูุดุจูุฉ

2. **ุชุชุจุน ูุณุงุฑ ุงูุงูุชุดุงุฑ:**
   - ุงูุฃุฌูุฒุฉ ุงููุณูุทุฉ
   - ุทุฑู ุงูุงูุชูุงู ุงููุณุชุฎุฏูุฉ

3. **ุชูููู ูุทุงู ุงูุฅุตุงุจุฉ:**
   - ุนุฏุฏ ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ
   - ุงูุฃูุณุงู ุงููุชุฃุซุฑุฉ

4. **ุงูุชุฎุทูุท ููุงุณุชุฌุงุจุฉ:**
   - ุฃููููุฉ ุงููุนุงูุฌุฉ
   - ุฎุทุฉ ุงูุนุฒู ูุงูุฅุฒุงูุฉ

### ๐จ ุฎุทุฉ ุงูุงุณุชุฌุงุจุฉ ููุญุงุฏุซ

**ุงูุฎุทูุงุช ุงูููุฑูุฉ:**
1. โ ุนุฒู ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ ุนู ุงูุดุจูุฉ
2. โ ุญุธุฑ ุจุตูุฉ ุงูููู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
3. โ ูุญุต ุดุงูู ููุฃุฌูุฒุฉ ุงููุฌุงูุฑุฉ
4. โ ุชุญููู ุณุฌูุงุช ุงููุดุงุท

**ุงูุฅุฌุฑุงุกุงุช ุงูุชุตุญูุญูุฉ:**
1. ๐ง ุฅุฒุงูุฉ ุงูุจุฑูุฌูุฉ ุงูุฎุจูุซุฉ
2. ๐ง ุชุญุฏูุซ ุชุนุฑููุงุช ููุงูุญ ุงูููุฑูุณุงุช
3. ๐ง ุชุตุญูุญ ุงูุซุบุฑุงุช ุงููุณุชุบูุฉ
4. ๐ง ุงุณุชุนุงุฏุฉ ุงููุธุงู ูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุธููุฉ

**ุงููุชุงุจุนุฉ:**
1. ๐ ุชูุซูู ุงูุญุงุฏุซ
2. ๐ ุชุญุฏูุซ ุงูุณูุงุณุงุช ุงูุฃูููุฉ
3. ๐ ุชุฏุฑูุจ ุงููุณุชุฎุฏููู
4. ๐ ูุฑุงูุจุฉ ูุนุฒุฒุฉ ููุชุฑุฉ

### ๐ก ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ
- ุฃูููุฉ ุงููุญุต ุงูุนููู ูุญุฑูุฉ ุงููุฑูุฑ
- ุถุฑูุฑุฉ ุงูุชุณุฌูู ุงูุดุงูู ููุฃุญุฏุงุซ
- ูููุฉ ุฃุฏูุงุช ุงูุชุญููู ุงูุจุตุฑู
- ุฃูููุฉ ุงูุงุณุชุฌุงุจุฉ ุงูุณุฑูุนุฉ

---

## 6. ARP - ุจุฑูุชูููู ุชุญููู ุงูุนูุงููู

### ๐ฏ ุงููุฏู
ููู ุขููุฉ ุนูู ุจุฑูุชูููู ARP ููุฑุงูุจุฉ ุงูุฌุฏูู ุงูุฎุงุต ุจู.

### ๐ ูุธุฑุฉ ุนุงูุฉ
ARP (Address Resolution Protocol) ูุฑุจุท ุจูู:
- **ุนููุงู IP** (Layer 3)
- **ุนููุงู MAC** (Layer 2)

### ๐ ุงูุชุทุจูู ุงูุนููู

#### ุงูุฎุทูุฉ 1: ุนุฑุถ ุฌุฏูู ARP

**ุนูู Windows:**
```cmd
arp -a
```

**ุนูู Linux/macOS:**
```bash
arp -a
```

#### ุงูุฎุทูุฉ 2: ูุฑุงุกุฉ ุงููุชุงุฆุฌ

```
Interface: 192.168.1.100 --- 0x4
  Internet Address      Physical Address      Type
  192.168.1.1          00-1A-2B-3C-4D-5E     dynamic
  192.168.1.10         00-AA-BB-CC-DD-EE     dynamic
  192.168.1.255        FF-FF-FF-FF-FF-FF     static
  224.0.0.22           01-00-5E-00-00-16     static
```

### ๐ ุชุญููู ุงูุฌุฏูู

| ุงููููู | ุงูุดุฑุญ |
|--------|--------|
| **Internet Address** | ุนููุงู IP ููุฌูุงุฒ |
| **Physical Address** | ุนููุงู MAC ููุฌูุงุฒ |
| **Type** | ููุน ุงูุฅุฏุฎุงู |

### ๐ท๏ธ ุฃููุงุน ุงูุฅุฏุฎุงูุงุช

**Dynamic:**
- ูุชู ุชุนููู ุชููุงุฆูุงู ูู ุญุฑูุฉ ุงููุฑูุฑ
- ููุญุฐู ุจุนุฏ ูุชุฑุฉ ุนุฏู ุงููุดุงุท (ุนุงุฏุฉ 2-10 ุฏูุงุฆู)
- ุงูุฃูุซุฑ ุดููุนุงู ูู ุงูุดุจูุงุช

**Static:**
- ูุชู ุฅุถุงูุชู ูุฏููุงู ุจูุงุณุทุฉ ุงููุฏูุฑ
- ูุง ููุญุฐู ุชููุงุฆูุงู
- ููุณุชุฎุฏู ููุฃุฌูุฒุฉ ุงูุญุณุงุณุฉ

### ๐ ุนูุงููู ุฎุงุตุฉ

**Broadcast:**
```
192.168.1.255 โ FF-FF-FF-FF-FF-FF
```
- ููุฑุณู ูุฌููุน ุงูุฃุฌูุฒุฉ ูู ุงูุดุจูุฉ

**Multicast:**
```
224.0.0.22 โ 01-00-5E-00-00-16
```
- ููุฑุณู ููุฌููุนุฉ ูุญุฏุฏุฉ ูู ุงูุฃุฌูุฒุฉ

### ๐งน ูุณุญ ุงููุงุด

**ูุณุญ ุฌููุน ุงูุฅุฏุฎุงูุงุช (Windows):**
```cmd
arp -d *
```

**ูุณุญ ุฅุฏุฎุงู ูุญุฏุฏ:**
```cmd
arp -d 192.168.1.10
```

**ุนูู Linux:**
```bash
sudo ip -s -s neigh flush all
```

### ๐ ุฅุถุงูุฉ ุฅุฏุฎุงู ุซุงุจุช

**Windows:**
```cmd
arp -s 192.168.1.50 00-11-22-33-44-55
```

**Linux:**
```bash
sudo arp -s 192.168.1.50 00:11:22:33:44:55
```

### ๐ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

**1. ุชุดุฎูุต ูุดุงูู ุงูุงุชุตุงู:**
```bash
# ูุญุต ูุฌูุฏ ุงูุฌูุงุฒ ูู ุงูุฌุฏูู
arp -a | grep 192.168.1.10

# ุฅุฐุง ูู ูุธูุฑุ ุงููุดููุฉ ูุฏ ุชููู ูู Layer 2
```

**2. ูุดู ุชุถุงุฑุจ IP:**
```bash
# ุฅุฐุง ุธูุฑ ููุณ IP ุจุนููุงูู MAC ูุฎุชูููู
192.168.1.50    00-AA-BB-CC-DD-EE
192.168.1.50    00-11-22-33-44-55  # โ๏ธ ุชุถุงุฑุจ!
```

**3. ูุฑุงูุจุฉ ุงูุฃุฌูุฒุฉ ุงููุดุทุฉ:**
```bash
# ุนุฏ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ
arp -a | grep dynamic | wc -l
```

### โ๏ธ ููุงุญุธุงุช ุฃูููุฉ

**ARP Spoofing/Poisoning:**
- ููุงุฌู ูุฑุณู ุฑุณุงุฆู ARP ูุฒููุฉ
- ูุฎุฏุน ุงูุฃุฌูุฒุฉ ูุฅุฑุณุงู ุงูุจูุงูุงุช ูู
- **ุงูุญูุงูุฉ:** ARP Inspection ุนูู ุงูุณููุชุดุงุช

**ุงูููุงูุฉ:**
```cisco
# ุชูุนูู Dynamic ARP Inspection
Switch(config)# ip arp inspection vlan 10
Switch(config)# interface gi0/1
Switch(config-if)# ip arp inspection trust
```

### ๐ก ูุตุงุฆุญ ุนูููุฉ
- ุฑุงูุจ ุฌุฏูู ARP ุจุดูู ุฏูุฑู
- ุงูุชุจู ููุชุบููุฑุงุช ุงูููุงุฌุฆุฉ ูู ุนูุงููู MAC
- ุงุณุชุฎุฏู ุฅุฏุฎุงูุงุช ุซุงุจุชุฉ ููุฃุฌูุฒุฉ ุงูุญุณุงุณุฉ
- ูุนูู ARP Inspection ูู ุงูุจูุฆุงุช ุงูุญุณุงุณุฉ

---

## 7. Nmap - ูุณุญ ุงูุดุจูุงุช

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู Nmap ูุงูุชุดุงู ุงูุฃุฌูุฒุฉ ูุงูุฎุฏูุงุช ุงููุดุทุฉ ุนูู ุงูุดุจูุฉ.

### ๐ ุงููุชุทูุจุงุช
- ูุธุงู Linux (ููุถู Kali Linux)
- ุตูุงุญูุงุช root ูููุณุญ ุงููุชูุฏู
- **ุจูุฆุฉ ุงุฎุชุจุงุฑูุฉ ููุท** โ๏ธ

### ๐ ุฃููุงุน ุงููุณุญ

#### 1. ุงูุชุดุงู ุงูุฃุฌูุฒุฉ ุงููุดุทุฉ (Host Discovery)

```bash
nmap -sn 192.168.1.0/24
```

**ุงูุดุฑุญ:**
- `-sn`: Ping Scan (ุจุฏูู ูุญุต ุงูููุงูุฐ)
- ูุณุชุฎุฏู ICMP Echo Request
- ููุธูุฑ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ ูุงููุดุทุฉ

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
Starting Nmap 7.94
Nmap scan report for 192.168.1.1
Host is up (0.0012s latency).

Nmap scan report for 192.168.1.50
Host is up (0.0034s latency).

Nmap scan report for 192.168.1.100
Host is up (0.0028s latency).

Nmap done: 256 IP addresses (3 hosts up) scanned in 2.85 seconds
```

#### 2. ูุญุต ุงูููุงูุฐ (Port Scanning)

**Basic TCP Scan:**
```bash
nmap 192.168.1.50
```

**Comprehensive Scan:**
```bash
nmap -sS -sV -O 192.168.1.50
```

**ุงูุดุฑุญ:**
- `-sS`: SYN Stealth Scan (ุฃูู ูุงุจููุฉ ูููุดู)
- `-sV`: ูุดู ุฅุตุฏุงุฑุงุช ุงูุฎุฏูุงุช
- `-O`: ุชุฎููู ูุธุงู ุงูุชุดุบูู

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PORT     STATE SERVICE    VERSION
21/tcp   open  ftp        vsftpd 3.0.3
22/tcp   open  ssh        OpenSSH 8.2p1
80/tcp   open  http       Apache httpd 2.4.41
443/tcp  open  ssl/http   Apache httpd 2.4.41
3306/tcp open  mysql      MySQL 5.7.33

OS details: Linux 3.2 - 4.9
```

#### 3. ูุญุต ุฌููุน ุงูููุงูุฐ

```bash
nmap -p- 192.168.1.50
```

- `-p-`: ูุญุต ุฌููุน ุงูููุงูุฐ (1-65535)
- ูุณุชุบุฑู ููุชุงู ุฃุทูู

#### 4. ูุญุต ููุงูุฐ ูุญุฏุฏุฉ

```bash
nmap -p 21,22,80,443,3306 192.168.1.50
```

### ๐ญ ุฃููุงุน ูุณุญ ุงูููุงูุฐ

#### TCP SYN Scan (ุงูุฃูุซุฑ ุดููุนุงู)
```bash
nmap -sS 192.168.1.50
```
- ูุฑุณู SYN ููุท
- ูุง ููููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ุฃูู ูุงุจููุฉ ูููุดู

#### TCP Connect Scan
```bash
nmap -sT 192.168.1.50
```
- ููููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ูุง ูุญุชุงุฌ ุตูุงุญูุงุช root
- ุฃูุซุฑ ูุงุจููุฉ ูููุดู

#### UDP Scan
```bash
nmap -sU 192.168.1.50
```
- ูุญุต ููุงูุฐ UDP
- ุจุทูุก ุฌุฏุงู
- ููู ูุฎุฏูุงุช ูุซู DNS, DHCP

### ๐ฌ ูุญุต ุงูุซุบุฑุงุช

```bash
nmap --script vuln 192.168.1.50
```

ูุณุชุฎุฏู NSE (Nmap Scripting Engine) ููุจุญุซ ุนู ุซุบุฑุงุช ูุนุฑููุฉ.

### ๐ ุชูููู ุงููุฎุงุทุฑ

#### ููุงูุฐ ุนุงููุฉ ุงูุฎุทูุฑุฉ:

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุงูุฎุทุฑ |
|--------|---------|-------|
| 21 | FTP | ููู ุจูุงูุงุช ุจุฏูู ุชุดููุฑ |
| 23 | Telnet | ุฅุฏุงุฑุฉ ุนู ุจุนุฏ ุจุฏูู ุชุดููุฑ |
| 445 | SMB | ุนุฑุถุฉ ููุฌูุงุช WannaCry ูุบูุฑูุง |
| 3389 | RDP | ูุฏู ุดุงุฆุน ูููุฌูุงุช |
| 1433 | MSSQL | ูุงุนุฏุฉ ุจูุงูุงุช ูุฏ ุชููู ุนุฑุถุฉ |

### ๐ก๏ธ ุงูุญูุงูุฉ ูู Nmap

**1. ุนูู ูุณุชูู ุงูุฌุฏุงุฑ ุงููุงุฑู:**
```cisco
# ุฑูุถ ุงููุณุญ ูู ูุตุงุฏุฑ ุฎุงุฑุฌูุฉ
access-list 100 deny tcp any any range 1 1024
```

**2. ุนูู ูุณุชูู ุงูุฎุงุฏู:**
```bash
# ุงุณุชุฎุฏุงู iptables ูููุน ุงููุณุญ
iptables -A INPUT -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT
```

**3. ุฃุฏูุงุช ูุดู ุงููุณุญ:**
```bash
# ุชุซุจูุช portsentry
sudo apt install portsentry

# ูุฑุงูุจุฉ ูุญุงููุงุช ุงููุณุญ
tail -f /var/log/syslog | grep portsentry
```

### ๐ก ูุตุงุฆุญ ููุงุณุชุฎุฏุงู ุงูุขูู
- โ๏ธ **ูุง ุชูู ุจูุณุญ ุดุจูุงุช ูุง ุชููููุง**
- ๐ ุงุญุตู ุนูู ุฅุฐู ุฎุทู ูุจู ุฃู ุงุฎุชุจุงุฑ ุงุฎุชุฑุงู
- ๐ ุงุณุชุฎุฏู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ููุชุฏุฑูุจ
- ๐ ูุซูู ุฌููุน ุนูููุงุช ุงููุณุญ ููุชุงุฆุฌูุง

### ๐ ุฃูุซูุฉ ุชุนููููุฉ ุฅุถุงููุฉ

**ูุณุญ ุณุฑูุน ูุฃูู 100 ูููุฐ:**
```bash
nmap --top-ports 100 192.168.1.50
```

**ูุณุญ ูุน ุชุฌูุจ ุงููุดู:**
```bash
nmap -sS -T2 -f 192.168.1.50
```
- `-T2`: ุณุฑุนุฉ ุจุทูุฆุฉ (ุฃูู ุฅุฒุนุงุฌุงู)
- `-f`: ุชุฌุฒุฆุฉ ุงูุญุฒู

**ุญูุธ ุงููุชุงุฆุฌ:**
```bash
nmap -oN results.txt 192.168.1.50
nmap -oX results.xml 192.168.1.50
```

---

## 8. ICMP - ุงุฎุชุจุงุฑุงุช ุงูุดุจูุฉ

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู ุฃุฏูุงุช ICMP ูุชุดุฎูุต ูุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจุงูุดุจูุฉ.

### ๐ ุจุฑูุชูููู ICMP
Internet Control Message Protocol - ุจุฑูุชูููู ุฑุณุงุฆู ุงูุชุญูู ูู ุงูุฅูุชุฑูุช
- Layer 3 Protocol
- ููุณุชุฎุฏู ููุชุดุฎูุต ูุฅุจูุงุบ ุงูุฃุฎุทุงุก
- ูุง ูุญูู ุจูุงูุงุช ุงููุณุชุฎุฏู

### ๐ ุงูุฃูุงูุฑ ุงูุฃุณุงุณูุฉ

#### 1. Ping - ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

**ุงูุงุณุชุฎุฏุงู ุงูุจุณูุท:**
```bash
ping 8.8.8.8
```

**ูุน ุฎูุงุฑุงุช ูุชูุฏูุฉ:**
```bash
# ุฅุฑุณุงู 10 ุญุฒู ููุท
ping -c 10 8.8.8.8

# ุชุบููุฑ ุญุฌู ุงูุญุฒูุฉ
ping -s 1000 8.8.8.8

# ุชุญุฏูุฏ ุงูููุช ุจูู ุงูุญุฒู (ุซุงููุฉ ูุงุญุฏุฉ)
ping -i 1 8.8.8.8
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=116 time=12.4 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=116 time=11.8 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=116 time=12.1 ms

--- 8.8.8.8 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2003ms
rtt min/avg/max/mdev = 11.8/12.1/12.4/0.3 ms
```

#### 2. Traceroute - ุชุชุจุน ุงููุณุงุฑ

**ุนูู Linux:**
```bash
traceroute 8.8.8.8
```

**ุนูู Windows:**
```cmd
tracert 8.8.8.8
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  192.168.1.1 (192.168.1.1)  1.245 ms  1.123 ms  1.089 ms
 2  10.0.0.1 (10.0.0.1)  8.456 ms  8.234 ms  8.123 ms
 3  172.16.0.1 (172.16.0.1)  15.678 ms  15.456 ms  15.234 ms
 4  * * *
 5  8.8.8.8 (8.8.8.8)  22.345 ms  22.123 ms  21.987 ms
```

**ุงูุชุญููู:**
- ูู ุณุทุฑ ููุซู ููุฌูู (router) ูู ุงููุณุงุฑ
- ุงูุฃุฑูุงู ุงูุซูุงุซุฉ: ุฒูู ุงูุงุณุชุฌุงุจุฉ ูููุญุงููุงุช ุงูุซูุงุซ
- `* * *`: ุงูููุฌูู ูุง ูุณุชุฌูุจ ูุทูุจุงุช ICMP

#### 3. MTR - ุชุชุจุน ูุชูุฏู

```bash
mtr 8.8.8.8
```

ูุฌูุน ุจูู ping ู traceroute ูุน ุฅุญุตุงุฆูุงุช ูุณุชูุฑุฉ:
```
                             Packets               Pings
 Host                      Loss%   Snt   Last   Avg  Best  Wrst StDev
 1. 192.168.1.1             0.0%    10    1.2   1.3   1.1   1.5   0.1
 2. 10.0.0.1                0.0%    10    8.4   8.5   8.1   9.2   0.3
 3. 8.8.8.8                 0.0%    10   22.1  22.3  21.8  23.1   0.4
```

### ๐ ุฃููุงุน ุฑุณุงุฆู ICMP

| ุงูููุน | ุงูุงุณู | ุงูุงุณุชุฎุฏุงู |
|-------|-------|-----------|
| Type 0 | Echo Reply | ุฑุฏ ุนูู Ping |
| Type 3 | Destination Unreachable | ุงููุฌูุฉ ุบูุฑ ูุชุงุญุฉ |
| Type 5 | Redirect | ุฅุนุงุฏุฉ ุชูุฌูู ุงููุณุงุฑ |
| Type 8 | Echo Request | ุทูุจ Ping |
| Type 11 | Time Exceeded | ุงูุชูุงุก TTL (ูุณุชุฎุฏูู traceroute) |

### โ๏ธ ุงุฎุชุจุงุฑุงุช ูุชูุฏูุฉ (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ููุท)

#### ICMP Flood Test

```bash
# โ๏ธ ููุงุฎุชุจุงุฑ ูู ุจูุฆุฉ ูุนุฒููุฉ ููุท
sudo ping -f -s 65500 TARGET_IP
```

**ุงูุดุฑุญ:**
- `-f`: Flood mode (ุฅุฑุณุงู ุณุฑูุน ุฌุฏุงู)
- `-s 65500`: ุญุฌู ุงูุญุฒูุฉ (ุฃูุตู ุญุฏ)
- **ููุณุชุฎุฏู ูุงุฎุชุจุงุฑ ุชุญูู ุงูุดุจูุฉ**

**ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
```
PING target (192.168.1.50) 65500(65528) bytes of data.
..................................
--- target ping statistics ---
10000 packets transmitted, 9856 received, 1.44% packet loss
```

#### Ping of Death (ุชุงุฑูุฎู)

```bash
# โ๏ธ ูุง ูุนูู ุนูู ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ
ping -s 65510 TARGET_IP
```

**ุงูุฎูููุฉ:**
- ูุงู ููุณุจุจ ุชุนุทู ุงูุฃูุธูุฉ ุงููุฏููุฉ
- ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ ูุญููุฉ ุถุฏู

### ๐ก๏ธ ุงูุญูุงูุฉ ูู ูุฌูุงุช ICMP

#### 1. ุชุญุฏูุฏ ูุนุฏู ICMP

**ุนูู Linux:**
```bash
# ุชุญุฏูุฏ ุนุฏุฏ ุญุฒู ICMP ูู ุงูุซุงููุฉ
iptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT
iptables -A INPUT -p icmp --icmp-type echo-request -j DROP
```

#### 2. ุนูู Cisco Router

```cisco
# ุชุญุฏูุฏ ูุนุฏู ICMP
access-list 100 permit icmp any any echo-reply
access-list 100 deny icmp any any echo-request
interface gi0/0
ip access-group 100 in
rate-limit input access-group 100 1000000 250000 500000 conform-action transmit exceed-action drop
```

#### 3. ุญุธุฑ ICMP ููุงุฆูุงู (ุบูุฑ ูุณุชุญุณู)

```bash
# ููููุฏ ุงููุฏุฑุฉ ุนูู ุงูุชุดุฎูุต
iptables -A INPUT -p icmp -j DROP
```

### ๐ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงูุนูููุฉ

**1. ุชุดุฎูุต ุงููุทุงุน ุงูุงุชุตุงู:**
```bash
# ุฎุทูุฉ ุจุฎุทูุฉ
ping 192.168.1.1  # ุงูุจูุงุจุฉ ุงููุญููุฉ
ping 8.8.8.8      # ุฎุงุฏู ุฎุงุฑุฌู
traceroute 8.8.8.8  # ุชุญุฏูุฏ ููุทุฉ ุงูุงููุทุงุน
```

**2. ููุงุณ ุฌูุฏุฉ ุงูุงุชุตุงู:**
```bash
# ูุฑุงูุจุฉ ููุฏุฉ 5 ุฏูุงุฆู
ping -c 300 -i 1 8.8.8.8 | tee ping_results.txt

# ุชุญููู ุงููุชุงุฆุฌ
grep "time=" ping_results.txt | awk '{print $7}' | sed 's/time=//' | sort -n
```

**3. ุงุฎุชุจุงุฑ MTU (Maximum Transmission Unit):**
```bash
# ุงุจุฏุฃ ุจุญุฌู ูุจูุฑ ููููู ุชุฏุฑูุฌูุงู
ping -M do -s 1472 8.8.8.8

# ุฅุฐุง ูุดูุ ููู ุงูุญุฌู ุญุชู ููุฌุญ
ping -M do -s 1400 8.8.8.8
```

### ๐ก ูุตุงุฆุญ ูููุฉ
- ICMP ููุณ ุขููุงู 100% - ูููู ุงุณุชุฎุฏุงูู ูู ุงููุฌูุงุช
- ุจุนุถ ุงูุดุจูุงุช ุชุญุธุฑ ICMP ููุฃูุงู
- ุงุณุชุฎุฏู ุฃุฏูุงุช ุจุฏููุฉ (TCP ping) ุนูุฏ ุงูุญุงุฌุฉ
- ูุง ุชุนุชูุฏ ุนูู ICMP ููุท ูููุฑุงูุจุฉ

---

## 9. SYN Flooding Attack

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุฉ ูุฌูู SYN Flood ูุชุฃุซูุฑู ุนูู ุงูุฎูุงุฏู.

### โ๏ธ ุชุญุฐูุฑ ููู ุฌุฏุงู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ๏ธ  ูุฐุง ุงููุญุชูู ูุฃุบุฑุงุถ ุชุนููููุฉ ููุท  โ๏ธ       โ
โ                                                  โ
โ  ุชูููุฐ ูุฐุง ุงููุฌูู ุนูู ุฃูุธูุฉ ุญููููุฉ:           โ
โ  โข ุฌุฑููุฉ ูุนุงูุจ ุนูููุง ุงููุงููู                   โ
โ  โข ูุชุทูุจ ุฅุฐู ุฎุทู ูุณุจู                          โ
โ  โข ููุณูุญ ููุท ูู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุฌูู

#### ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ ุงูุทุจูุนูุฉ (TCP Three-Way Handshake)

```
Client                    Server
  |                         |
  |-------- SYN ---------->|  [1]
  |<----- SYN-ACK ---------|  [2]
  |-------- ACK ---------->|  [3]
  |                         |
  |==== Connection Open ====|
```

#### ูุฌูู SYN Flood

```
Attacker                  Server
  |                         |
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |      (thousands)        |
  |                         |
  |   โ No ACK Sent โ    |
  |                         |
  |                    [Server]
  |                   SYN Queue
  |                   โโโโโโโโโโโ
  |                   โ SYN #1  โ โณ
  |                   โ SYN #2  โ โณ
  |                   โ SYN #3  โ โณ
  |                   โ SYN #... โ โณ
  |                   โ FULL!   โ ๐ด
  |                   โโโโโโโโโโโ
```

### ๐ฌ ุงูุชุทุจูู ุงูุนููู (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ููุท)

#### ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุขูุฉ ุงูุชุฑุงุถูุฉ ููููุงุฌู (Kali Linux)
- ุฎุงุฏู ุงุฎุชุจุงุฑ ูุนุฒูู
- ุดุจูุฉ ูุญููุฉ ููุนุฒูุฉ ุชูุงูุงู

#### ุงูุฃุฏุงุฉ: hping3

**ุงูุชุซุจูุช:**
```bash
sudo apt update
sudo apt install hping3
```

**ุงููุฌูู ุงูุฃุณุงุณู:**
```bash
sudo hping3 -S -p 80 --flood TARGET_IP
```

**ุงูุดุฑุญ:**
- `-S`: ุฅุฑุณุงู ุญุฒู SYN ููุท
- `-p 80`: ุงุณุชูุฏุงู ุงููููุฐ 80 (HTTP)
- `--flood`: ุฅุฑุณุงู ุฃุณุฑุน ูุง ูููู (ุจุฏูู ุงูุชุธุงุฑ)
- `TARGET_IP`: ุนููุงู ุงูุฎุงุฏู ุงููุณุชูุฏู

**ูุฌูู ูุชูุฏู ูุน ุนูุงููู ูุฒููุฉ:**
```bash
sudo hping3 -S -p 80 --flood --rand-source TARGET_IP
```

- `--rand-source`: ุนูุงููู IP ูุตุฏุฑ ุนุดูุงุฆูุฉ
- ููุตุนูุจ ุชุชุจุน ุงูููุงุฌู
- ูุชุฌุงูุฒ ุจุนุถ ุขููุงุช ุงูุญูุงูุฉ ุงูุจุณูุทุฉ

### ๐ ุงููุฑุงูุจุฉ ุนูู ุงูุฎุงุฏู ุงููุณุชูุฏู

#### ุนุฑุถ ุงูุงุชุตุงูุงุช ูุตู ุงูููุชูุญุฉ

```bash
netstat -ant | grep SYN_RECV
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ ุฃุซูุงุก ุงููุฌูู:**
```
tcp    0    0 192.168.1.50:80    10.0.0.100:45123    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.101:45124    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.102:45125    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.103:45126    SYN_RECV
... (ูุฆุงุช ุฃู ุขูุงู ุงูุณุทูุฑ)
```

#### ูุฑุงูุจุฉ ุงุณุชููุงู ุงูููุงุฑุฏ

```bash
# ุนุฑุถ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
ss -tan | grep SYN-RECV | wc -l

# ูุฑุงูุจุฉ ุงูุฐุงูุฑุฉ
free -h

# ูุฑุงูุจุฉ CPU
top
```

**ูุคุดุฑุงุช ุงููุฌูู:**
```
SYN-RECV connections: 5000+  ๐ด (ุทุจูุนู: < 100)
Memory usage: 95%             ๐ด (ุทุจูุนู: < 70%)
CPU load: 100%                ๐ด (ุทุจูุนู: < 50%)
```

### ๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ

#### 1. SYN Cookies

**ุชูุนูู SYN Cookies ุนูู Linux:**
```bash
# ุงูุชุญูู ูู ุงูุญุงูุฉ ุงูุญุงููุฉ
cat /proc/sys/net/ipv4/tcp_syncookies

# ุงูุชูุนูู (1 = enabled)
sudo sysctl -w net.ipv4.tcp_syncookies=1

# ุฌุนูู ุฏุงุฆูุงู
echo "net.ipv4.tcp_syncookies = 1" | sudo tee -a /etc/sysctl.conf
```

**ููู ุชุนูู:**
```
ุจุฏูุงู ูู ุชุฎุฒูู ุงูุงุชุตุงู ูู ุงูุฐุงูุฑุฉ:
1. ุงูุฎุงุฏู ูุญุณุจ ูููุฉ ูุดูุฑุฉ (cookie)
2. ููุฑุณููุง ูู SYN-ACK
3. ูุง ูุญูุธ ุดูุก ูู ุงูุฐุงูุฑุฉ
4. ุนูุฏ ุงุณุชูุงู ACKุ ูุชุญูู ูู ุงูู cookie
5. ุฅู ุตุญุ ููููู ุงูุงุชุตุงู

ุงููุชูุฌุฉ: ูุง ุงุณุชูุฒุงู ููุฐุงูุฑุฉ โ
```

#### 2. ุชุญุฏูุฏ ูุนุฏู ุงูุงุชุตุงูุงุช ุงูุฌุฏูุฏุฉ

**ุจุงุณุชุฎุฏุงู iptables:**
```bash
# ุงูุณูุงุญ ุจู 5 ุงุชุตุงูุงุช ุฌุฏูุฏุฉ ููุท ูู ุงูุซุงููุฉ ูู ููุณ IP
iptables -A INPUT -p tcp --syn -m limit --limit 5/s --limit-burst 10 -j ACCEPT
iptables -A INPUT -p tcp --syn -j DROP
```

**ุจุงุณุชุฎุฏุงู nftables:**
```bash
nft add rule ip filter input tcp flags syn ct state new limit rate 5/second accept
```

#### 3. ุฒูุงุฏุฉ ุญุฌู ูุงุฆูุฉ SYN

```bash
# ุฒูุงุฏุฉ ุงูุญุฏ ุงูุฃูุตู ููุงุชุตุงูุงุช ูุตู ุงูููุชูุญุฉ
sudo sysctl -w net.ipv4.tcp_max_syn_backlog=4096

# ุชูููู ููุช ุงูุงูุชุธุงุฑ
sudo sysctl -w net.ipv4.tcp_synack_retries=2
```

#### 4. ุงุณุชุฎุฏุงู Firewall ูุชูุฏู

**Cisco ASA:**
```cisco
! ุชุญุฏูุฏ ุนุฏุฏ ุงูุงุชุตุงูุงุช ุงููุชุฒุงููุฉ
access-list OUTSIDE_IN extended permit tcp any host 203.0.113.50 eq www
class-map SYN-ATTACK
 match access-list OUTSIDE_IN
policy-map OUTSIDE_POLICY
 class SYN-ATTACK
  set connection conn-max 100 embryonic-conn-max 50
service-policy OUTSIDE_POLICY interface outside
```

**pfSense/OPNsense:**
- ุชูุนูู "SYN Proxy"
- ุถุจุท "Maximum States" ู "Maximum Source Nodes"

#### 5. ุงุณุชุฎุฏุงู CDN/DDoS Protection

ุฎุฏูุงุช ูุซู:
- Cloudflare
- AWS Shield
- Akamai

ุชููู ุจู:
- ุงูุชุตุงุต ุงููุฌูุงุช ุงูุถุฎูุฉ
- ุชูุฒูุน ุงูุญูู
- ููุชุฑุฉ ุงูุญุฑูุฉ ุงูุฎุจูุซุฉ

### ๐ ุงูุชุฃุซูุฑ ุนูู ุงูุฎุงุฏู

#### ูุฑุงุญู ุงููุฌูู

**ุงููุฑุญูุฉ 1: ุงูุจุฏุงูุฉ (0-30 ุซุงููุฉ)**
```
SYN Queue: 20% full
Response Time: 100ms โ 500ms
```

**ุงููุฑุญูุฉ 2: ุงูุชุตุนูุฏ (30-60 ุซุงููุฉ)**
```
SYN Queue: 80% full
Response Time: 500ms โ 3000ms
New connections: ุจุทูุฆุฉ ุฌุฏุงู
```

**ุงููุฑุญูุฉ 3: ุงูุงูููุงุฑ (60+ ุซุงููุฉ)**
```
SYN Queue: 100% full
Response Time: timeout
New connections: ูุฑููุถุฉ ุจุงููุงูู
Service: ุบูุฑ ูุชุงุญ ๐ด
```

### ๐ ูุดู ุงููุฌูู

#### ุนูุงูุงุช ุงูุชุญุฐูุฑ

```bash
# ุงุฑุชูุงุน ููุงุฌุฆ ูู SYN_RECV
watch -n 1 'netstat -ant | grep SYN_RECV | wc -l'

# ุชูุจูู ุนูุฏ ุชุฌุงูุฒ ุญุฏ ูุนูู
while true; do
  COUNT=$(netstat -ant | grep SYN_RECV | wc -l)
  if [ $COUNT -gt 1000 ]; then
    echo "โ๏ธ Possible SYN Flood: $COUNT connections"
  fi
  sleep 5
done
```

#### ุชุญููู ุงูุณุฌูุงุช

```bash
# ุนุฑุถ ุฃูุซุฑ IP ูุตุฏุฑูุฉ ูุดุงุทุงู
netstat -ant | grep SYN_RECV | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -nr | head -10
```

### ๐ก ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ

**ูููุฏุงูุนูู:**
1. โ ูุนูู SYN Cookies ุฏุงุฆูุงู
2. โ ุฑุงูุจ ูุนุฏูุงุช ุงูุงุชุตุงู ุจุดูู ูุณุชูุฑ
3. โ ุงุณุชุฎุฏู Firewall ูุน ุฅููุงููุงุช DDoS protection
4. โ ุงุญุชูุธ ุจุฎุทุฉ ุงุณุชุฌุงุจุฉ ุฌุงูุฒุฉ

**ููููุงุฌููู ุงูุฃุฎูุงูููู:**
1. ๐ ุงุญุตู ุนูู ุฅุฐู ุฎุทู ูุจู ุงูุงุฎุชุจุงุฑ
2. ๐ ุงุณุชุฎุฏู ุจูุฆุฉ ูุนุฒููุฉ ุชูุงูุงู
3. โฐ ุญุฏุฏ ูุงูุฐุฉ ุฒูููุฉ ูุญุฏูุฏุฉ ููุงุฎุชุจุงุฑ
4. ๐ ูุซูู ุงููุชุงุฆุฌ ุจุดูู ุงุญุชุฑุงูู

---

## 10. UDP Flood Attack

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุฉ ูุฌูู UDP Flood ูุงููุฑู ุจููู ูุจูู SYN Flood.

### โ๏ธ ุชุญุฐูุฑ ูุงูููู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐จ ูุฐุง ุงููุญุชูู ููุชุนููู ูุงูุฃุจุญุงุซ ุงูุฃูููุฉ ููุท  โ
โ                                                   โ
โ  ุงูููุงู ุจูุฐุง ุงููุฌูู ุฏูู ุฅุฐู ูู:                โ
โ  โข ุฌุฑููุฉ ุฅููุชุฑูููุฉ                              โ
โ  โข ููุนุงูุจ ุนูููุง ุจุงูุณุฌู ูุงูุบุฑุงูุฉ                โ
โ  โข ููุณูุญ ููุท ูู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูููููุฉ ูู         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ุงููุฑู ุจูู TCP ู UDP

| ุงูููุฒุฉ | TCP | UDP |
|--------|-----|-----|
| ุงูุงุชุตุงู | Connection-oriented | Connectionless |
| ุงููุตุงูุญุฉ | ูุนู (3-way handshake) | ูุง |
| ุงูููุซูููุฉ | ูุถููู ุงููุตูู | ุบูุฑ ูุถููู |
| ุงูุณุฑุนุฉ | ุฃุจุทุฃ | ุฃุณุฑุน |
| ุงูุชุฑุชูุจ | ูุฑุชุจ | ุบูุฑ ูุฑุชุจ |

### ๐ฌ ุขููุฉ ูุฌูู UDP Flood

```
Attacker                    Target Server
  |                              |
  |------- UDP Packet ---------->| Port 53 (DNS)
  |------- UDP Packet ---------->| Port 161 (SNMP)
  |------- UDP Packet ---------->| Port 12345 (Random)
  |------- UDP Packet ---------->| Port 9999 (Closed)
  |       (thousands/sec)        |
  |                              |
  |                         [Server Process]
  |                         1. ุชููู ุงูุญุฒูุฉ
  |                         2. ูุญุต ุงููููุฐ
  |                         3. ุงููููุฐ ูุบููุ
  |                         4. ุฅุฑุณุงู ICMP Port Unreachable
  |                              |
  |<---- ICMP Unreachable -------|
  |<---- ICMP Unreachable -------|
  |<---- ICMP Unreachable -------|
  |                              |
  |                    [Result: Resource Exhaustion]
  |                    โข CPU: 100%
  |                    โข Bandwidth: Saturated
  |                    โข Service: Unavailable
```

### ๐ฌ ุงูุชุทุจูู ุงูุนููู (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ููุท)

#### ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุดุจูุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ุชูุงูุงู
- ุฎุงุฏู ุงุฎุชุจุงุฑ ูุฎุตุต
- ุฅุฐู ุฎุทู ููุซู

#### ุงุณุชุฎุฏุงู hping3

**ุงููุฌูู ุงูุฃุณุงุณู:**
```bash
sudo hping3 --udp -p 53 --flood TARGET_IP
```

**ุงูุดุฑุญ:**
- `--udp`: ุงุณุชุฎุฏุงู ุจุฑูุชูููู UDP
- `-p 53`: ุงุณุชูุฏุงู ูููุฐ DNS
- `--flood`: ุฅุฑุณุงู ุจุฃูุตู ุณุฑุนุฉ ููููุฉ

**ูุฌูู ูุน ููุงูุฐ ุนุดูุงุฆูุฉ:**
```bash
sudo hping3 --udp --rand-dest --flood TARGET_IP
```

- `--rand-dest`: ููุงูุฐ ูุฌูุฉ ุนุดูุงุฆูุฉ
- ููุถุนู ุงูุฎุงุฏู ุฃูุซุฑ (ููุญุต ูู ูููุฐ)

**ูุฌูู ูุน ุญุฌู ุญุฒูุฉ ูุจูุฑ:**
```bash
sudo hping3 --udp -p 53 --flood -d 65500 TARGET_IP
```

- `-d 65500`: ุญุฌู ุงูุจูุงูุงุช (ุฃูุตู ุญุฏ ูู UDP)
- ูุณุชููู bandwidth ุฃูุซุฑ

### ๐ ุงููุฑุงูุจุฉ ุนูู ุงูุฎุงุฏู ุงููุณุชูุฏู

#### ุนุฑุถ ุฅุญุตุงุฆูุงุช UDP

```bash
netstat -s | grep UDP
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ ุฃุซูุงุก ุงููุฌูู:**
```
UDP:
    125847 packets received
    98234 packets to unknown port received
    89123 packet receive errors
    45678 packets sent
    RcvbufErrors: 12345
    SndbufErrors: 0
    InErrors: 89123
```

#### ูุฑุงูุจุฉ ุงูุญุฒู ูู ุงูููุช ุงููุนูู

```bash
# ุนุฑุถ ูุนุฏู ุญุฒู UDP
watch -n 1 'netstat -su | grep "packets received"'

# ูุฑุงูุจุฉ ููุงูุฐ ูุญุฏุฏุฉ
tcpdump -i eth0 udp port 53 -nn
```

**ูุคุดุฑุงุช ุงููุฌูู:**
```
UDP packets/sec: 50,000+     ๐ด (ุทุจูุนู: < 1,000)
Port Unreachable: 40,000+    ๐ด (ุทุจูุนู: < 10)
Bandwidth usage: 90%+        ๐ด (ุทุจูุนู: < 50%)
CPU usage: 100%              ๐ด (ุทุจูุนู: < 30%)
```

#### ุชุญุฏูุฏ ุฃูุซุฑ ุงูููุงูุฐ ุงููุณุชูุฏูุฉ

```bash
tcpdump -i eth0 -nn udp -c 1000 | awk '{print $5}' | cut -d'.' -f5 | sort | uniq -c | sort -nr | head -10
```

### ๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ

#### 1. Rate Limiting ุนูู Linux

```bash
# ุชุญุฏูุฏ ูุนุฏู ุญุฒู UDP ูู ูู IP
iptables -A INPUT -p udp -m limit --limit 100/s --limit-burst 200 -j ACCEPT
iptables -A INPUT -p udp -j DROP

# ุญูุงูุฉ ููุงูุฐ ูุญุฏุฏุฉ
iptables -A INPUT -p udp --dport 53 -m limit --limit 50/s -j ACCEPT
iptables -A INPUT -p udp --dport 53 -j DROP
```

#### 2. ุชุนุทูู ICMP Port Unreachable

```bash
# ููุน ุฅุฑุณุงู ุฑุณุงุฆู Port Unreachable
iptables -A OUTPUT -p icmp --icmp-type destination-unreachable -j DROP

# ุฃู ุนุจุฑ sysctl
sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1
```

**ุงููุงุฆุฏุฉ:**
- ูููุฑ ููุงุฑุฏ CPU
- ูููุน ุงุณุชูุฒุงู bandwidth ุจุงูุฑุฏูุฏ

#### 3. ุญูุงูุฉ ุนูู ูุณุชูู ุงูุฎุงุฏู

```bash
# ุฒูุงุฏุฉ ุญุฌู buffer ููู UDP
sysctl -w net.core.rmem_max=26214400
sysctl -w net.core.rmem_default=26214400

# ุชุญุณูู ูุนุงูุฌุฉ ุงูุญุฒู
sysctl -w net.core.netdev_max_backlog=5000
```

#### 4. Firewall Rules ุนูู Cisco

```cisco
! ุชุญุฏูุฏ ูุนุฏู UDP
access-list 110 permit udp any host 203.0.113.50 eq domain
access-list 110 deny udp any any

interface GigabitEthernet0/0
 ip access-group 110 in
 rate-limit input access-group 110 10000000 1000000 2000000 conform-action transmit exceed-action drop
```

#### 5. ุงุณุชุฎุฏุงู fail2ban

```bash
# ุชุซุจูุช fail2ban
sudo apt install fail2ban

# ุฅูุดุงุก ูุงุนุฏุฉ ูู UDP flood
sudo nano /etc/fail2ban/filter.d/udp-flood.conf
```

**ูุญุชูู ุงูููู:**
```ini
[Definition]
failregex = .*kernel.*UDP.*SRC=<HOST>.*
ignoreregex =
```

**ุงูุชูุนูู:**
```ini
# /etc/fail2ban/jail.local
[udp-flood]
enabled = true
filter = udp-flood
logpath = /var/log/syslog
maxretry = 100
findtime = 60
bantime = 3600
```

### ๐ ุงูููุงูุฐ ุงูุดุงุฆุนุฉ ุงููุณุชูุฏูุฉ

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุณุจุจ ุงูุงุณุชูุฏุงู |
|--------|---------|---------------|
| 53 | DNS | ุญููู ููุดุจูุฉุ ูููุฏ ุงุณุชุฌุงุจุงุช |
| 123 | NTP | ูููู ุชุถุฎููู (Amplification) |
| 161 | SNMP | ุฅุฏุงุฑุฉุ ุบุงูุจุงู ููุชูุญ |
| 1900 | SSDP | UPnPุ ุดุงุฆุน ูู ุงูุฃุฌูุฒุฉ ุงูููุฒููุฉ |
| 19 | Chargen | ูููุฏ ุจูุงูุงุช ูุจูุฑุฉ |
| 111 | RPC | ูููู ุงุณุชุบูุงูู ููุชุถุฎูู |

### ๐ฏ UDP Amplification Attack

**ุงูููููู:**
ุงูููุงุฌู ูุฑุณู ุทูุจุงุช ุตุบูุฑุฉ ูุน ุนููุงู IP ูุฒูู (IP Spoofing)ุ ูุงูุฎุงุฏู ูุฑุฏ ุจุฑุฏูุฏ ูุจูุฑุฉ ููุถุญูุฉ.

```
Attacker                DNS Server              Victim
  |                         |                      |
  |-- Small Query (64B) -->|                      |
  |  (Spoofed Source IP)   |                      |
  |                         |                      |
  |                         |-- Large Reply ------>|
  |                         |    (3000B)           |
  |                         |                      |
  
Amplification Factor: 3000 / 64 = 47x
```

**ูุซุงู ุนููู ุนูู DNS:**
```bash
# ุทูุจ ุตุบูุฑ
dig ANY example.com @8.8.8.8

# ููุฑุฌุน ุฑุฏ ูุจูุฑ ุฌุฏุงู ูุญุชูู ุนูู:
# - A records
# - AAAA records
# - MX records
# - TXT records
# - NS records
# ูุบูุฑูุง...
```

### ๐ก๏ธ ุงูุญูุงูุฉ ูู UDP Amplification

#### 1. BCP38 - ููุน IP Spoofing

```cisco
! ุนูู Router ุงูุญุฏูุฏู
interface GigabitEthernet0/0
 description To Internet
 ip verify unicast source reachable-via rx
```

#### 2. ุชูููุฏ ุงูุงุณุชุนูุงูุงุช ุงูุฎุงุฑุฌูุฉ

**ุนูู DNS Server:**
```bash
# BIND Configuration
options {
    allow-query { localhost; 192.168.0.0/16; };
    recursion no;
};
```

#### 3. Rate Limiting ุนูู DNS

```bash
# BIND RRL (Response Rate Limiting)
rate-limit {
    responses-per-second 5;
    window 5;
};
```

### ๐ ููุงุฑูุฉ ุจูู SYN Flood ู UDP Flood

| ุงูููุฒุฉ | SYN Flood | UDP Flood |
|--------|-----------|-----------|
| ุงูุจุฑูุชูููู | TCP | UDP |
| ุงููุฏู | ุงุณุชูุฒุงู Connection Queue | ุงุณุชูุฒุงู CPU/Bandwidth |
| ุงููุดู | ุณูู (SYN_RECV connections) | ูุชูุณุท |
| ุงูุชุถุฎูู | ูุง ููุฌุฏ | ูููู (Amplification) |
| ุงูุญูุงูุฉ | SYN Cookies | Rate Limiting |
| ุงูุชุฃุซูุฑ | Denial of Service | Bandwidth Saturation |

### ๐ ูุดู UDP Flood

#### ุณูุฑูุจุช ูุฑุงูุจุฉ ุจุณูุท

```bash
#!/bin/bash
# udp_monitor.sh

THRESHOLD=1000
INTERVAL=5

while true; do
    UDP_COUNT=$(netstat -su | grep "packets received" | awk '{print $1}')
    sleep $INTERVAL
    UDP_COUNT_NEW=$(netstat -su | grep "packets received" | awk '{print $1}')
    
    RATE=$(( ($UDP_COUNT_NEW - $UDP_COUNT) / $INTERVAL ))
    
    if [ $RATE -gt $THRESHOLD ]; then
        echo "โ๏ธ [$(date)] High UDP traffic detected: $RATE packets/sec"
        # ุฅุฑุณุงู ุชูุจูู
        echo "High UDP traffic: $RATE pps" | mail -s "UDP Flood Alert" admin@example.com
    fi
done
```

#### ุงุณุชุฎุฏุงู tshark ููุชุญููู

```bash
# ูุฑุงูุจุฉ ูุชุณุฌูู ุญุฑูุฉ UDP
tshark -i eth0 -f "udp" -w udp_traffic.pcap

# ุชุญููู ุงูููู
tshark -r udp_traffic.pcap -q -z io,phs
```

### ๐ก ูุตุงุฆุญ ููุญูุงูุฉ

**ูููุณุคูููู:**
1. โ ูุนูู Rate Limiting ุนูู ุฌููุน ุงูุฎุฏูุงุช
2. โ ุฑุงูุจ ุงุณุชุฎุฏุงู bandwidth ุจุดูู ูุณุชูุฑ
3. โ ูููุฏ ุงููุตูู ููุฎุฏูุงุช (Whitelist)
4. โ ุงุณุชุฎุฏู CDN/DDoS Protection ููููุงูุน ุงููููุฉ
5. โ ุนุทูู ุงูุฎุฏูุงุช ุบูุฑ ุงููุณุชุฎุฏูุฉ

**ูููุฎุชุจุฑูู:**
1. ๐ ูุซูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช
2. ๐ ุงุณุชุฎุฏู ุดุจูุฉ ูุนุฒููุฉ 100%
3. โฐ ุญุฏุฏ ูุชุฑุฉ ุฒูููุฉ ูุญุฏูุฏุฉ
4. ๐ ุฑุงูุจ ุงูุชุฃุซูุฑ ุนูู ุงูููุงุฑุฏ
5. ๐ ุฃุนุฏ ุงููุธุงู ูุญุงูุชู ุงูุทุจูุนูุฉ ุจุนุฏ ุงูุงุฎุชุจุงุฑ

---

## 11. Nmap Port Scanning

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู Nmap ุจุดูู ุงุญุชุฑุงูู ููุญุต ุงูุดุจูุงุช ูุงูุชุดุงู ุงูุฎุฏูุงุช.

### ๐ ุงูุณููุงุฑูู ุงูุชุทุจููู
ูุญุต ุฎุงุฏู ูู ุจูุฆุฉ ุงุฎุชุจุงุฑ: `192.168.80.131`

### ๐ ุงูุฃูุฑ ุงูุฃุณุงุณู

```bash
nmap -v -sN 192.168.80.131
```

**ุงูุดุฑุญ:**
- `-v`: Verbose mode (ุฅุธูุงุฑ ุชูุงุตูู ุฃูุซุฑ)
- `-sN`: TCP Null Scan (ูุญุต ุฎูู)

### ๐ ูุซุงู ุนูู ุงููุชุงุฆุฌ

```
Starting Nmap 7.94 ( https://nmap.org )
NSE: Loaded 156 scripts for scanning.
Initiating Ping Scan at 15:23:45
Scanning 192.168.80.131 [4 ports]
Completed Ping Scan at 15:23:45, 0.05s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host at 15:23:45
Completed Parallel DNS resolution of 1 host at 15:23:45, 0.01s elapsed
Initiating TCP Null Scan at 15:23:45
Scanning 192.168.80.131 [1000 ports]
Discovered open port 21/tcp on 192.168.80.131
Discovered open port 23/tcp on 192.168.80.131
Discovered open port 80/tcp on 192.168.80.131
Discovered open port 25/tcp on 192.168.80.131
Discovered open port 139/tcp on 192.168.80.131
Discovered open port 445/tcp on 192.168.80.131
Completed TCP Null Scan at 15:23:47, 2.15s elapsed (1000 total ports)
Nmap scan report for 192.168.80.131
Host is up (0.0012s latency).
Not shown: 994 closed ports
PORT    STATE         SERVICE
21/tcp  open|filtered ftp
23/tcp  open|filtered telnet
25/tcp  open|filtered smtp
80/tcp  open|filtered http
139/tcp open|filtered netbios-ssn
445/tcp open|filtered microsoft-ds

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 2.25 seconds
           Raw packets sent: 1004 (44.176KB) | Rcvd: 1001 (40.052KB)
```

### ๐ฏ ุชุญููู ุงูููุงูุฐ ุงูููุชุดูุฉ

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุงูุฎุทุฑ | ุงูุชูุตูุฉ |
|--------|---------|-------|---------|
| **21** | FTP | ๐ด ุนุงูู | ููู ุจูุงูุงุช ุจุฏูู ุชุดููุฑุ ุงุณุชุฎุฏู SFTP |
| **23** | Telnet | ๐ด ุนุงูู ุฌุฏุงู | ุฅุฏุงุฑุฉ ุจุฏูู ุชุดููุฑุ ุงุณุชุฎุฏู SSH |
| **25** | SMTP | ๐ก ูุชูุณุท | ุจุฑูุฏ ุฅููุชุฑูููุ ุชุฃูุฏ ูู ุงูุชุดููุฑ |
| **80** | HTTP | ๐ก ูุชูุณุท | ููุจ ุจุฏูู ุชุดููุฑุ ุงุณุชุฎุฏู HTTPS |
| **139** | NetBIOS | ๐ด ุนุงูู | ุนุฑุถุฉ ููุฌูุงุชุ ุฃุบููู ุฅู ูู ููู ุถุฑูุฑูุงู |
| **445** | SMB | ๐ด ุนุงูู ุฌุฏุงู | ูุฏู ุดุงุฆุน (WannaCryุ EternalBlue) |

### ๐ฌ ุฃููุงุน ูุญุต Nmap

#### 1. TCP Connect Scan (-sT)
```bash
nmap -sT 192.168.80.131
```
- ูููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ูุง ูุญุชุงุฌ ุตูุงุญูุงุช root
- ุณูู ุงููุดู ูู ุงูุณุฌูุงุช

#### 2. SYN Stealth Scan (-sS)
```bash
sudo nmap -sS 192.168.80.131
```
- ูุฑุณู SYN ููุท
- ูุง ูููู ุงูุงุชุตุงู (ุฎูู)
- ุงูุฃูุซุฑ ุดููุนุงู

#### 3. NULL Scan (-sN)
```bash
sudo nmap -sN 192.168.80.131
```
- ูุง ููุฑุณู ุฃู flags
- ูุชุฌุงูุฒ ุจุนุถ Firewalls
- ูุง ูุนูู ูุน Windows

#### 4. FIN Scan (-sF)
```bash
sudo nmap -sF 192.168.80.131
```
- ูุฑุณู FIN flag ููุท
- ูุดุงุจู ูู NULL scan

#### 5. Xmas Scan (-sX)
```bash
sudo nmap -sX 192.168.80.131
```
- ูุฑุณู FIN, PSH, URG flags
- ุณููู "Xmas" ูุฃู ุงูู flags ูุถุงุกุฉ ูุซู ุดุฌุฑุฉ ุงููุฑูุณูุงุณ

### ๐ฏ ูุญุต ูุชูุฏู ูุน ูุดู ุงูุฅุตุฏุงุฑุงุช

```bash
sudo nmap -sV -O -A 192.168.80.131
```

**ุงูุดุฑุญ:**
- `-sV`: ูุดู ุฅุตุฏุงุฑุงุช ุงูุฎุฏูุงุช
- `-O`: ุชุฎููู ูุธุงู ุงูุชุดุบูู
- `-A`: ูุญุต ุดุงูู (Script scanning + OS detection + Traceroute)

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         vsftpd 2.3.4
23/tcp  open  telnet      Linux telnetd
25/tcp  open  smtp        Postfix smtpd
80/tcp  open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X
445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian

OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop

Service Info: Host: metasploitable.localdomain; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
```

### ๐ ูุดู ุงูุซุบุฑุงุช

```bash
sudo nmap --script vuln 192.168.80.131
```

**ูุซุงู ุนูู ุงูุชุดุงู ุซุบุฑุฉ:**
```
PORT   STATE SERVICE
21/tcp open  ftp
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2011-2523
|     Risk factor: High  CVSSv2: 10.0 (HIGH) (AV:N/AC:L/AU:N/C:C/I:C/A:C)
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
```

### ๐ฏ OS Fingerprinting

```bash
sudo nmap -O 192.168.80.131
```

**ุขููุฉ ุงูุนูู:**
1. ุฅุฑุณุงู ุญุฒู TCP/UDP/ICMP ุฎุงุตุฉ
2. ุชุญููู ุงูุฑุฏูุฏ
3. ููุงุฑูุฉ ูุน ูุงุนุฏุฉ ุจูุงูุงุช ุงูุฃูุธูุฉ
4. ุชุฎููู ุงููุธุงู ุจูุณุจุฉ ุฏูุฉ

**ูุซุงู:**
```
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
```

### ๐ ุญูุธ ุงููุชุงุฆุฌ

```bash
# ูุต ุนุงุฏู
nmap -oN output.txt 192.168.80.131

# XML (ูููุนุงูุฌุฉ ุงูุจุฑูุฌูุฉ)
nmap -oX output.xml 192.168.80.131

# Grepable (ููุจุญุซ ุงูุณุฑูุน)
nmap -oG output.grep 192.168.80.131

# ุฌููุน ุงูุตูุบ
nmap -oA output_all 192.168.80.131
```

### ๐ก๏ธ ุงูุญูุงูุฉ ูู Nmap

#### 1. ุงุณุชุฎุฏุงู IDS/IPS

**Snort Rule ููุดู Nmap:**
```
alert tcp any any -> $HOME_NET any (msg:"SCAN nmap XMAS"; flags:FPU; reference:arachnids,30; classtype:attempted-recon; sid:1228; rev:7;)
```

#### 2. ุชูููุฏ ุงููุตูู

```bash
# iptables - ุงูุณูุงุญ ููุท ุจู IPs ูุนุฑููุฉ
iptables -A INPUT -s 192.168.1.0/24 -j ACCEPT
iptables -A INPUT -j DROP
```

#### 3. Port Knocking

```bash
# ุชุซุจูุช knockd
sudo apt install knockd

# ุงูุชูููู
sudo nano /etc/knockd.conf
```

**ุงูููููู:**
- ุงูููุงูุฐ ูุบููุฉ ุจุดูู ุงูุชุฑุงุถู
- "ุทุฑู" ุนูู ููุงูุฐ ูุญุฏุฏุฉ ุจุชุฑุชูุจ ูุนูู
- ุงููููุฐ ุงููุทููุจ ูููุชุญ ูุคูุชุงู

#### 4. ุชุบููุฑ ุงูููุงูุฐ ุงูุงูุชุฑุงุถูุฉ

```bash
# SSH ูู 22 ุฅูู 2222
sudo nano /etc/ssh/sshd_config
# Port 2222

# HTTP ูู 80 ุฅูู 8080
# ูู Apache config
Listen 8080
```

### ๐ก ูุตุงุฆุญ ููุงุณุชุฎุฏุงู ุงูุฃุฎูุงูู

**ูุจู ุงููุญุต:**
1. โ ุงุญุตู ุนูู ุฅุฐู ุฎุทู
2. โ ุญุฏุฏ ูุทุงู ุงูุงุฎุชุจุงุฑ
3. โ ุงุชูู ุนูู ุงูุชูููุช
4. โ ูุซูู ุฌููุน ุงูุฎุทูุงุช

**ุฃุซูุงุก ุงููุญุต:**
1. ๐ ุงุณุชุฎุฏู `-T2` ุฃู `-T3` (ุณุฑุนุงุช ูุนุชุฏูุฉ)
2. ๐ ุฑุงูุจ ุชุฃุซูุฑ ุงููุญุต ุนูู ุงูุดุจูุฉ
3. ๐พ ุณุฌูู ุฌููุน ุงููุชุงุฆุฌ
4. โธ๏ธ ุชููู ุฅุฐุง ูุงุญุธุช ูุดุงูู

**ุจุนุฏ ุงููุญุต:**
1. ๐ ุฃุนุฏ ุชูุฑูุฑ ููุตู
2. ๐ ูุฏูู ุชูุตูุงุช ุฃูููุฉ
3. ๐ค ูุงูุด ุงููุชุงุฆุฌ ูุน ุงููุณุคูููู
4. ๐ ุงุญุฐู ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ุจุดูู ุขูู

---

## 12. John the Ripper - ูุณุฑ ูููุงุช ุงููุฑูุฑ

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุงุช ูุณุฑ ูููุงุช ุงููุฑูุฑ ูุฃูููุฉ ุงุณุชุฎุฏุงู ูููุงุช ูุฑูุฑ ูููุฉ.

### โ๏ธ ุชุญุฐูุฑ ุฃุฎูุงูู ููุงูููู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ๏ธ  ุงุณุชุฎุฏุงู ูุฐู ุงูุฃุฏุงุฉ ุนูู ุญุณุงุจุงุช ูุง ุชููููุง    โ
โ      ููุนุชุจุฑ ุฌุฑููุฉ ุฅููุชุฑูููุฉ                         โ
โ                                                        โ
โ  ุงูุงุณุชุฎุฏุงูุงุช ุงููุดุฑูุนุฉ ููุท:                          โ
โ  โ ุงุฎุชุจุงุฑ ูููุงุช ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจู                  โ
โ  โ ุชุฏููู ุฃููู ุจุฅุฐู ุฎุทู                            โ
โ  โ ุงุณุชุฑุฌุงุน ูููุงุช ุงููุฑูุฑ ุงูููุณูุฉ (ูููุงุชู)          โ
โ  โ ุจูุฆุฉ ูุฎุชุจุฑูุฉ ุชุนููููุฉ                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ูุธุฑุฉ ุนุงูุฉ

**John the Ripper** ูู ุฃุฏุงุฉ ููุชูุญุฉ ุงููุตุฏุฑ ูุงุฎุชุจุงุฑ ููุฉ ูููุงุช ุงููุฑูุฑ ุนุจุฑ:
- **Dictionary Attack:** ุงุณุชุฎุฏุงู ููุงุฆู ูููุงุช ูุนุฑููุฉ
- **Brute Force:** ุชุฌุฑุจุฉ ุฌููุน ุงูุชูุงููู ุงูููููุฉ
- **Rainbow Tables:** ุฌุฏุงูู hash ูุญุณูุจุฉ ูุณุจูุงู

### ๐ง ุงูุชุซุจูุช

```bash
# ุนูู Ubuntu/Debian
sudo apt update
sudo apt install john

# ุนูู Kali Linux (ููุซุจุช ูุณุจูุงู)
john --version
```

### ๐ ููู ุงูุชุฌุฒุฆุฉ (Hashing)

```
Plain Text โ Hash Function โ Hash

ูุซุงู:
"password123" โ MD5 โ "482c811da5d5b4bc6d497ffa98491e38"
"password123" โ SHA256 โ "ef92b778bafe771e89245b89ecbc08a4..."
```

**ุฎุตุงุฆุต Hash:**
- โ ุงุชุฌุงู ูุงุญุฏ (ูุง ูููู ุนูุณู)
- โ ููุณ ุงููุฏุฎู = ููุณ ุงููุฎุฑุฌ ุฏุงุฆูุงู
- โ ุชุบููุฑ ุตุบูุฑ ูู ุงููุฏุฎู = ุชุบููุฑ ูุจูุฑ ูู ุงููุฎุฑุฌ

### ๐ ุงูุณููุงุฑูู ุงูุชุทุจููู

#### ุงูุฎุทูุฉ 1: ุงุณุชุฎุฑุงุฌ ูููุงุช ุงููุฑูุฑ

**ุนูู Linux:**
```bash
# ููู /etc/shadow ูุญุชูู ุนูู hashes
sudo cat /etc/shadow

# ูุซุงู ุนูู ุณุทุฑ:
user1:$6$saltsalt$hashhashhashhash...:18500:0:99999:7:::
```

**ุชูุณูู ุงูุญููู:**
```
username:$algorithm$salt$hash:last_change:min:max:warn:inactive:expire
```

**ุฃููุงุน ุงูุฎูุงุฑุฒููุงุช:**
- `$1# ุชุฏุฑูุจุงุช ุนูููุฉ ูู ุฃูู ุงูุดุจูุงุช
## Network Security - Practical Labs

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [NAT/PAT - ุชุฑุฌูุฉ ุนูุงููู ุงูุดุจูุฉ](#1-natpat---ุชุฑุฌูุฉ-ุนูุงููู-ุงูุดุจูุฉ)
2. [ACL - ููุงุฆู ุงูุชุญูู ุจุงููุตูู](#2-acl---ููุงุฆู-ุงูุชุญูู-ุจุงููุตูู)
3. [FTP ูุขููุฉ Established](#3-ftp-ูุขููุฉ-established)
4. [WAF ู Load Balancer](#4-waf-ู-load-balancer)
5. [Cisco Firepower - ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ](#5-cisco-firepower---ุชุญููู-ุงูุจุฑูุฌูุงุช-ุงูุฎุจูุซุฉ)
6. [ARP - ุจุฑูุชูููู ุชุญููู ุงูุนูุงููู](#6-arp---ุจุฑูุชูููู-ุชุญููู-ุงูุนูุงููู)
7. [Nmap - ูุณุญ ุงูุดุจูุงุช](#7-nmap---ูุณุญ-ุงูุดุจูุงุช)
8. [ICMP - ุงุฎุชุจุงุฑุงุช ุงูุดุจูุฉ](#8-icmp---ุงุฎุชุจุงุฑุงุช-ุงูุดุจูุฉ)
9. [SYN Flooding Attack](#9-syn-flooding-attack)
10. [UDP Flood Attack](#10-udp-flood-attack)
11. [Nmap Port Scanning](#11-nmap-port-scanning)
12. [John the Ripper - ูุณุฑ ูููุงุช ุงููุฑูุฑ](#12-john-the-ripper---ูุณุฑ-ูููุงุช-ุงููุฑูุฑ)
13. [DHCP Snooping](#13-dhcp-snooping)

---

## 1. NAT/PAT - ุชุฑุฌูุฉ ุนูุงููู ุงูุดุจูุฉ

### ๐ฏ ุงููุฏู
ููู ุขููุฉ ุนูู NAT/PAT ูู ุชุฑุฌูุฉ ุงูุนูุงููู ุงูุฎุงุตุฉ ุฅูู ุนูุงููู ุนุงูุฉ.

### ๐ ุงูุณููุงุฑูู
ุฌูุงุฒ ุฏุงุฎูู ุจุนููุงู `10.0.0.5` ูุฑูุฏ ุชุตูุญ ุงูุฅูุชุฑูุช ุนุจุฑ ุฌุฏุงุฑ ูุงุฑู ูุณุชุฎุฏู NAT.

### ๐ ุฎุทูุงุช ุงูุนูู

1. **ุงูุทูุจ ุงูุตุงุฏุฑ:**
   - ุงูุฌูุงุฒ ุงูุฏุงุฎูู `10.0.0.5` ูุฑุณู ุทูุจ HTTP
   - ุงูุฌุฏุงุฑ ุงููุงุฑู ูุชุฑุฌู ุงูุนููุงู ุฅูู `203.0.113.2:10500`
   - ุงูุนููุงู `203.0.113.2` ูู ุงูุนููุงู ุงูุนุงู
   - ุงููููุฐ `10500` ููุณุชุฎุฏู ูุชูููุฒ ุงูุงุชุตุงู

2. **ุงูุฑุฏ ุงููุงุฑุฏ:**
   - ุนูุฏ ูุตูู ุงูุฑุฏ ูู ุงูุฅูุชุฑูุช ุฅูู `203.0.113.2:10500`
   - ูุนูุฏ NAT ุงูุชุฑุฌูุฉ ุงูุนูุณูุฉ ุฅูู `10.0.0.5` ุจุงููููุฐ ุงูุฃุตูู
   - ูุชู ุชุณููู ุงูุจูุงูุงุช ููุฌูุงุฒ ุงูุฏุงุฎูู

### โ ุงููุงุฆุฏุฉ
- ูุฆุงุช ุงูุฃุฌูุฒุฉ ูููููุง ูุดุงุฑูุฉ ุนููุงู ุนุงู ูุงุญุฏ
- ูุง ููุฌุฏ ุชุถุงุฑุจ ุจูุถู ุงุณุชุฎุฏุงู ุฃุฑูุงู ุงูููุงูุฐ (Port Numbers)
- ุชูููุฑ ูู ุนูุงููู IPv4 ุงูุนุงูุฉ

### ๐ ููุงุญุธุงุช
- PAT (Port Address Translation) ูู ููุน ูู NAT
- ููุณูู ุฃูุถุงู NAT Overload
- ุงูุฌุฏูู ุงูุฏุงุฎูู ูุญุชูุธ ุจุงูุฑุจุท ุจูู ุงูุนูุงููู ุงูุฏุงุฎููุฉ ูุงูููุงูุฐ

---

## 2. ACL - ููุงุฆู ุงูุชุญูู ุจุงููุตูู

### ๐ฏ ุงููุฏู
ุชุทุจูู ุณูุงุณุงุช ุฃูููุฉ ุจุงุณุชุฎุฏุงู ููุงุฆู ุงูุชุญูู ุจุงููุตูู (Access Control Lists).

### ๐ ุงูุณููุงุฑูู
ูุฏูู:
- **Web Server** ูู DMZ (Demilitarized Zone)
- **Database Server** ุฏุงุฎู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ

> ๐ก **DMZ:** ููุทูุฉ ููุฒูุนุฉ ุงูุณูุงุญุ ููู ููุทูุฉ ุจูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ูุงูุฅูุชุฑูุช ูุชูููู ุงููุฎุงุทุฑ ุงูุฃูููุฉ.

### ๐ง ุงูุชูููู ุงูุนููู

```cisco
access-list 100 permit tcp any 10.10.10.10 eq www
access-list 100 permit tcp any 10.10.10.10 eq 443
access-list 100 permit tcp any 10.10.10.12 eq ftp
access-list 100 permit tcp any 10.10.10.12 eq ftp-data
access-list 100 deny ip any any log

interface gi0/1
ip access-group 100 in
```

### ๐ ุดุฑุญ ุงูุฃูุงูุฑ

| ุงูุฃูุฑ | ุงููุธููุฉ |
|------|---------|
| `permit tcp any 10.10.10.10 eq www` | ุงูุณูุงุญ ุจุงููุตูู ูุฎุงุฏู ุงูููุจ ุนุจุฑ HTTP (ูููุฐ 80) |
| `permit tcp any 10.10.10.10 eq 443` | ุงูุณูุงุญ ุจุงููุตูู ุนุจุฑ HTTPS (ูููุฐ 443) |
| `permit tcp any 10.10.10.12 eq ftp` | ุงูุณูุงุญ ุจู FTP Control (ูููุฐ 21) |
| `permit tcp any 10.10.10.12 eq ftp-data` | ุงูุณูุงุญ ุจู FTP Data (ูููุฐ 20) |
| `deny ip any any log` | ุญุธุฑ ุฃู ุญุฑูุฉ ุฃุฎุฑู ูุน ุงูุชุณุฌูู |
| `ip access-group 100 in` | ุชุทุจูู ุงููุงุฆูุฉ ุนูู ุงููุงุฌูุฉ |

### ๐ฏ ุงููุฏู ุงูุฃููู
- ุงูุณูุงุญ ุจุงููุตูู ููุท ููููุงูุฐ ุงููุทููุจุฉ
- ููุน ุงููุตูู ุงููุจุงุดุฑ ูุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุณุฌูู ุงููุญุงููุงุช ุงููุดุจููุฉ
- ุชูููู ูุทุงู ุงููุฌูู (Attack Surface)

### โ๏ธ ููุงุญุธุงุช ูููุฉ
- ุงููุตูู ููุงุนุฏุฉ ุงูุจูุงูุงุช ูุฌุจ ุฃู ูุชู ููุท ูู ุฎูุงู ุฎุงุฏู ุงูููุจ
- ุชุฑุชูุจ ุงูููุงุนุฏ ููู ุฌุฏุงู (ูู ุงูุฃุนูู ููุฃุณูู)
- ุงููุงุนุฏุฉ ุงูุถูููุฉ ูู ุงูููุงูุฉ: `deny any any`

---

## 3. FTP ูุขููุฉ Established

### ๐ฏ ุงููุฏู
ููู ุงููุฑู ุจูู FTP Passive ู Active Mode ูุชุฃุซูุฑู ุนูู ACL.

### ๐ ุจููุฉ FTP
ุจุฑูุชูููู FTP ูุณุชุฎุฏู ููุงุชูู ูููุตูุชูู:
- **Port 21:** ููุงุฉ ุงูุชุญูู (Control Channel)
- **Port 20:** ููุงุฉ ุงูุจูุงูุงุช (Data Channel)

### ๐ FTP Passive Mode

```
[Client] -----> [Server]
         Port 21 (Control)
         
[Client] <----- [Server]
         Random High Port (Data)
```

**ุขููุฉ ุงูุนูู:**
1. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุชุญูู ูุญู ุงููููุฐ 21
2. ุงูุนููู ูุทูุจ ูุถุน Passive
3. ุงูุฎุงุฏู ูุฑุฏ ุจูููุฐ ุนุดูุงุฆู ุนุงูู
4. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุจูุงูุงุช ูุญู ูุฐุง ุงููููุฐ
5. ูู ุงูุฑุฏูุฏ ุชุญุชูู ุนูู ุจุช ACK โ **ูุณููุญ ุจูุง** โ

### ๐ FTP Active Mode

```
[Client] -----> [Server]
         Port 21 (Control)
         
[Client] <----- [Server]
         Port 20 (Data initiated by server)
```

**ุขููุฉ ุงูุนูู:**
1. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุชุญูู ูุญู ุงููููุฐ 21
2. ุงูุนููู ูุฎุจุฑ ุงูุฎุงุฏู ุจูููุฐ ูุนูู ูุงุณุชูุจุงู ุงูุจูุงูุงุช
3. **ุงูุฎุงุฏู ูุจุฏุฃ ุงุชุตุงู ุงูุจูุงูุงุช** ูู ุงููููุฐ 20
4. ุฃูู ุญุฒูุฉ ูู ุงูุฎุงุฏู ุชุญุชูู ุนูู SYN ููุท โ **ุชูุฑูุถ** ๐ซ

### โ๏ธ ุงููุดููุฉ ูุน Established

```cisco
access-list 110 permit tcp any any established
```

ูุฐู ุงููุงุนุฏุฉ ุชุณูุญ ููุท ุจุงูุญุฒู ุงูุชู ุชุญุชูู ุนูู:
- ุจุช ACK
- ุฃู ุจุช RST

**ุงููุชูุฌุฉ:**
- ูู Active Modeุ ุงูุฎุงุฏู ูุฑุณู SYN ุฃููุงู
- ูุฐู ุงูุญุฒูุฉ ูุง ุชุญูู ุดุฑุท "established"
- ุงูุงุชุตุงู ููุดู ๐ซ

### โ ุงูุญู ุงูุฃูุซู
ุงุณุชุฎุฏุงู ุฌุฏุงุฑ ูุงุฑู ุญูููู (Stateful Firewall) ูุงุฏุฑ ุนูู:
- ุชุชุจุน ุงูุฌูุณุงุช ุงููุดุทุฉ
- ููู ุงูุจุฑูุชููููุงุช ุงููุนูุฏุฉ ูุซู FTP
- ุงูุณูุงุญ ุจุงูุงุชุตุงูุงุช ุงูุฏููุงููููุฉ ุชููุงุฆูุงู

### ๐ ุงูุฎูุงุตุฉ
- `established` ูุง ูููู ููุจุฑูุชููููุงุช ุงููุนูุฏุฉ
- FTP Passive Mode ุฃูุซุฑ ุชูุงููุงู ูุน ุงูุฌุฏุฑุงู ุงููุงุฑูุฉ
- Stateful Firewalls ุถุฑูุฑูุฉ ููุจูุฆุงุช ุงูุฅูุชุงุฌูุฉ

---

## 4. WAF ู Load Balancer

### ๐ฏ ุงููุฏู
ุจูุงุก ุจููุฉ ุชุญุชูุฉ ุขููุฉ ููุงุจูุฉ ููุชูุณุน ููููุน ููุจ.

### ๐ ุงูุณููุงุฑูู
ูููุน ููุจ ูุญุชูู ุนูู ุนุฏุฉ ุฎูุงุฏู Web Servers ุฎูู Load Balancerุ ูุน ุญูุงูุฉ ูู ูุฌูุงุช XSS.

### ๐๏ธ ุงูุจููุฉ ุงููุนูุงุฑูุฉ

```
[Internet]
    |
    โ
[WAF - Web Application Firewall]
    |
    โ
[Load Balancer]
    |
    โ------------------โ------------------โ------------------โ
[Web Server 1]   [Web Server 2]   [Web Server 3]   [Web Server 4]
```

### โ๏ธ ููุงู Load Balancer

**ุฎูุงุฑุฒููุฉ ุงูุชูุฒูุน:**
- **Round Robin:** ุชูุฒูุน ูุชุณุงูู ุนูู ุฌููุน ุงูุฎูุงุฏู
- ุฏูุฑุฉ ููุชุธูุฉ: Server 1 โ Server 2 โ Server 3 โ Server 4 โ ุชูุฑุงุฑ

**ุฅุฏุงุฑุฉ ุงูุฃุนุทุงู:**
1. ูุฑุงูุจุฉ ุตุญุฉ ุงูุฎูุงุฏู (Health Checks)
2. ุนูุฏ ูุดู ุฃุญุฏ ุงูุฎูุงุฏู:
   - ุฅุฒุงูุชู ูู ูุงุฆูุฉ ุงูุชูุฒูุน ุชููุงุฆูุงู
   - ุชุญููู ุทูุจุงุชู ุฅูู ุงูุฎูุงุฏู ุงูุณูููุฉ
3. ุนูุฏ ุนูุฏุฉ ุงูุฎุงุฏู: ุฅุนุงุฏุฉ ุฅุฏุฑุงุฌู ุชููุงุฆูุงู

### ๐ก๏ธ ููุงู WAF (ูู Reverse Proxy)

**ุงูุญูุงูุฉ ูู XSS:**
```javascript
// ูุซุงู ุนูู ูุญุงููุฉ ูุฌูู XSS
<script>alert('XSS Attack')</script>
```

**ุขููุฉ ุงูุญูุงูุฉ:**
1. ูุญุต ูู ุทูุจ HTTP ูุจู ูุตููู ููุฎูุงุฏู
2. ูุดู ุงูุดููุฑุงุช ุงูุฎุจูุซุฉ:
   - JavaScript ูุดุจูู
   - SQL Injection
   - Command Injection
3. ููุน ุงูุทูุจุงุช ุงููุดุจููุฉ ููุฑุงู โ
4. ููุน ุชุณุฑูุจ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุงุณุชุฌุงุจุงุช

### ๐ ุณูุงุณุงุช ุงูุฃูุงู

| ููุน ุงูุญูุงูุฉ | ุงููุธููุฉ |
|-------------|---------|
| XSS Prevention | ููุน ุญูู JavaScript |
| SQL Injection | ุญูุงูุฉ ููุงุนุฏ ุงูุจูุงูุงุช |
| CSRF Protection | ููุน ุงูุทูุจุงุช ุงููุฒูุฑุฉ |
| Rate Limiting | ุงูุญุฏ ูู ูุนุฏู ุงูุทูุจุงุช |
| IP Blacklisting | ุญุธุฑ IP ุงููุดุจููุฉ |

### โ ุงููุฒุงูุง ุงููุญููุฉ

**ุงูุฃุฏุงุก:**
- โก ุชูุฒูุน ุงูุฃุญูุงู ุจุดูู ูุชูุงุฒู
- ๐ ุชุญูู ุงูุฃุนุทุงู (Fault Tolerance)
- ๐ ูุงุจููุฉ ุงูุชูุณุน ุงูุฃููู

**ุงูุฃูุงู:**
- ๐ก๏ธ ุญูุงูุฉ ูุชูุฏูุฉ ูู WAF
- ๐ ูุญุต ุฌููุน ุงูุทูุจุงุช
- ๐ ุชุณุฌูู ุงููุญุงููุงุช ุงููุดุจููุฉ
- ๐ซ ุญุธุฑ ุงููุฌูุงุช ูู ุงูููุช ุงูุญูููู

### ๐ ูุซุงู ุนูู ุณุฌูุงุช WAF

```
2025-10-26 10:15:32 | BLOCKED | XSS Attempt | IP: 192.168.1.100
2025-10-26 10:16:45 | BLOCKED | SQL Injection | IP: 10.0.0.50
2025-10-26 10:17:12 | ALLOWED | Normal Request | IP: 172.16.0.25
```

---

## 5. Cisco Firepower - ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ

### ๐ฏ ุงููุฏู
ููู ููููุฉ ุนูู ุฃูุธูุฉ ูุดู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ ุงููุชูุฏูุฉ ูุชุชุจุน ุงูุชุดุงุฑูุง.

### ๐ ุงูุณููุงุฑูู
ููู ุจุงุณู `tool.exe` ุชู ุงูุชุดุงูู ุถูู ุญุฑูุฉ ุงููุฑูุฑ ุนูู ุงูุดุจูุฉ.

### ๐ ูุฑุงุญู ุงููุดู ูุงูุชุญููู

#### ุงููุฑุญูุฉ 1: ุงููุญุต ุงูุฃููู
1. **ุงุนุชุฑุงุถ ุงูููู:** ุฌูุงุฒ Cisco Firepower ููุญุต ุฌููุน ุงููููุงุช ุงููุงุฑุฉ
2. **ุญุณุงุจ ุงูุจุตูุฉ:** ุงุณุชุฎุฑุงุฌ ุจุตูุฉ SHA-256 ููููู
   ```
   SHA-256: a3f7b8c9d2e1f4a6b5c8d7e9f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0
   ```
3. **ุงูููุงุฑูุฉ:** ููุงุฑูุฉ ุงูุจุตูุฉ ูุน ูุงุนุฏุฉ ุจูุงูุงุช ุงูุชูุฏูุฏุงุช

#### ุงููุฑุญูุฉ 2: ุงูุชุตููู
```
Status: โ๏ธ MALWARE DETECTED
Threat Name: Generic.Trojan.Downloader
Threat Score: 95/100 (High)
Category: Trojan
First Seen: 2025-10-25 14:30:22
```

#### ุงููุฑุญูุฉ 3: ุชุญุฏูุฏ ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ
ุงูุฃุฌูุฒุฉ ุงูุชุงููุฉ ุชู ุชุญุฏูุฏูุง ููุตุงุจุฉ:
- ๐ฅ๏ธ `192.168.10.90`
- ๐ฅ๏ธ `192.168.133.50`

### ๐ Trajectory Map (ุฎุฑูุทุฉ ุงููุณุงุฑ)

```
Time โ
Device 1: --------[*]==========[*]-------
                   โ            โ
Device 2: --------[*]----[*]----[*]------
                         โ      โ
Device 3: ---------------[*]=====[*]-----
```

**ุฑููุฒ ุงูุฎุฑูุทุฉ:**
- `[*]` ููุทุฉ ุงูุชูุงู ุงูููู
- `=` ูุชุฑุฉ ูุดุงุท ุงูููู ุนูู ุงูุฌูุงุฒ
- `โ` ุงุชุฌุงู ุงูุชูุงู ุงูุนุฏูู (ูู ุฌูุงุฒ ูุขุฎุฑ)
- `-` ูุชุฑุฉ ุฎููู

### ๐ ุฌุฏูู ุงูุฃุญุฏุงุซ (Events Table)

| ุงูููุช | ุงูุฌูุงุฒ ุงููุตุฏุฑ | ุงูุฌูุงุฒ ุงููุฏู | ุงูุญุฏุซ | ุงูุญุงูุฉ |
|------|---------------|--------------|--------|--------|
| 14:30:22 | External | 192.168.10.90 | File Download | Infected |
| 14:35:18 | 192.168.10.90 | 192.168.133.50 | File Transfer | Infected |
| 14:42:33 | 192.168.133.50 | Network Share | Propagation Attempt | Blocked |

### ๐ฏ ุงุณุชุฎุฏุงูุงุช Trajectory Map

1. **ุชุญุฏูุฏ ุงููุตุฏุฑ ุงูุฃููู:**
   - ุฃูู ุฌูุงุฒ ุชููู ุงูููู
   - ููุทุฉ ุงูุฏุฎูู ุฅูู ุงูุดุจูุฉ

2. **ุชุชุจุน ูุณุงุฑ ุงูุงูุชุดุงุฑ:**
   - ุงูุฃุฌูุฒุฉ ุงููุณูุทุฉ
   - ุทุฑู ุงูุงูุชูุงู ุงููุณุชุฎุฏูุฉ

3. **ุชูููู ูุทุงู ุงูุฅุตุงุจุฉ:**
   - ุนุฏุฏ ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ
   - ุงูุฃูุณุงู ุงููุชุฃุซุฑุฉ

4. **ุงูุชุฎุทูุท ููุงุณุชุฌุงุจุฉ:**
   - ุฃููููุฉ ุงููุนุงูุฌุฉ
   - ุฎุทุฉ ุงูุนุฒู ูุงูุฅุฒุงูุฉ

### ๐จ ุฎุทุฉ ุงูุงุณุชุฌุงุจุฉ ููุญุงุฏุซ

**ุงูุฎุทูุงุช ุงูููุฑูุฉ:**
1. โ ุนุฒู ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ ุนู ุงูุดุจูุฉ
2. โ ุญุธุฑ ุจุตูุฉ ุงูููู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
3. โ ูุญุต ุดุงูู ููุฃุฌูุฒุฉ ุงููุฌุงูุฑุฉ
4. โ ุชุญููู ุณุฌูุงุช ุงููุดุงุท

**ุงูุฅุฌุฑุงุกุงุช ุงูุชุตุญูุญูุฉ:**
1. ๐ง ุฅุฒุงูุฉ ุงูุจุฑูุฌูุฉ ุงูุฎุจูุซุฉ
2. ๐ง ุชุญุฏูุซ ุชุนุฑููุงุช ููุงูุญ ุงูููุฑูุณุงุช
3. ๐ง ุชุตุญูุญ ุงูุซุบุฑุงุช ุงููุณุชุบูุฉ
4. ๐ง ุงุณุชุนุงุฏุฉ ุงููุธุงู ูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุธููุฉ

**ุงููุชุงุจุนุฉ:**
1. ๐ ุชูุซูู ุงูุญุงุฏุซ
2. ๐ ุชุญุฏูุซ ุงูุณูุงุณุงุช ุงูุฃูููุฉ
3. ๐ ุชุฏุฑูุจ ุงููุณุชุฎุฏููู
4. ๐ ูุฑุงูุจุฉ ูุนุฒุฒุฉ ููุชุฑุฉ

### ๐ก ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ
- ุฃูููุฉ ุงููุญุต ุงูุนููู ูุญุฑูุฉ ุงููุฑูุฑ
- ุถุฑูุฑุฉ ุงูุชุณุฌูู ุงูุดุงูู ููุฃุญุฏุงุซ
- ูููุฉ ุฃุฏูุงุช ุงูุชุญููู ุงูุจุตุฑู
- ุฃูููุฉ ุงูุงุณุชุฌุงุจุฉ ุงูุณุฑูุนุฉ

---

## 6. ARP - ุจุฑูุชูููู ุชุญููู ุงูุนูุงููู

### ๐ฏ ุงููุฏู
ููู ุขููุฉ ุนูู ุจุฑูุชูููู ARP ููุฑุงูุจุฉ ุงูุฌุฏูู ุงูุฎุงุต ุจู.

### ๐ ูุธุฑุฉ ุนุงูุฉ
ARP (Address Resolution Protocol) ูุฑุจุท ุจูู:
- **ุนููุงู IP** (Layer 3)
- **ุนููุงู MAC** (Layer 2)

### ๐ ุงูุชุทุจูู ุงูุนููู

#### ุงูุฎุทูุฉ 1: ุนุฑุถ ุฌุฏูู ARP

**ุนูู Windows:**
```cmd
arp -a
```

**ุนูู Linux/macOS:**
```bash
arp -a
```

#### ุงูุฎุทูุฉ 2: ูุฑุงุกุฉ ุงููุชุงุฆุฌ

```
Interface: 192.168.1.100 --- 0x4
  Internet Address      Physical Address      Type
  192.168.1.1          00-1A-2B-3C-4D-5E     dynamic
  192.168.1.10         00-AA-BB-CC-DD-EE     dynamic
  192.168.1.255        FF-FF-FF-FF-FF-FF     static
  224.0.0.22           01-00-5E-00-00-16     static
```

### ๐ ุชุญููู ุงูุฌุฏูู

| ุงููููู | ุงูุดุฑุญ |
|--------|--------|
| **Internet Address** | ุนููุงู IP ููุฌูุงุฒ |
| **Physical Address** | ุนููุงู MAC ููุฌูุงุฒ |
| **Type** | ููุน ุงูุฅุฏุฎุงู |

### ๐ท๏ธ ุฃููุงุน ุงูุฅุฏุฎุงูุงุช

**Dynamic:**
- ูุชู ุชุนููู ุชููุงุฆูุงู ูู ุญุฑูุฉ ุงููุฑูุฑ
- ููุญุฐู ุจุนุฏ ูุชุฑุฉ ุนุฏู ุงููุดุงุท (ุนุงุฏุฉ 2-10 ุฏูุงุฆู)
- ุงูุฃูุซุฑ ุดููุนุงู ูู ุงูุดุจูุงุช

**Static:**
- ูุชู ุฅุถุงูุชู ูุฏููุงู ุจูุงุณุทุฉ ุงููุฏูุฑ
- ูุง ููุญุฐู ุชููุงุฆูุงู
- ููุณุชุฎุฏู ููุฃุฌูุฒุฉ ุงูุญุณุงุณุฉ

### ๐ ุนูุงููู ุฎุงุตุฉ

**Broadcast:**
```
192.168.1.255 โ FF-FF-FF-FF-FF-FF
```
- ููุฑุณู ูุฌููุน ุงูุฃุฌูุฒุฉ ูู ุงูุดุจูุฉ

**Multicast:**
```
224.0.0.22 โ 01-00-5E-00-00-16
```
- ููุฑุณู ููุฌููุนุฉ ูุญุฏุฏุฉ ูู ุงูุฃุฌูุฒุฉ

### ๐งน ูุณุญ ุงููุงุด

**ูุณุญ ุฌููุน ุงูุฅุฏุฎุงูุงุช (Windows):**
```cmd
arp -d *
```

**ูุณุญ ุฅุฏุฎุงู ูุญุฏุฏ:**
```cmd
arp -d 192.168.1.10
```

**ุนูู Linux:**
```bash
sudo ip -s -s neigh flush all
```

### ๐ ุฅุถุงูุฉ ุฅุฏุฎุงู ุซุงุจุช

**Windows:**
```cmd
arp -s 192.168.1.50 00-11-22-33-44-55
```

**Linux:**
```bash
sudo arp -s 192.168.1.50 00:11:22:33:44:55
```

### ๐ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

**1. ุชุดุฎูุต ูุดุงูู ุงูุงุชุตุงู:**
```bash
# ูุญุต ูุฌูุฏ ุงูุฌูุงุฒ ูู ุงูุฌุฏูู
arp -a | grep 192.168.1.10

# ุฅุฐุง ูู ูุธูุฑุ ุงููุดููุฉ ูุฏ ุชููู ูู Layer 2
```

**2. ูุดู ุชุถุงุฑุจ IP:**
```bash
# ุฅุฐุง ุธูุฑ ููุณ IP ุจุนููุงูู MAC ูุฎุชูููู
192.168.1.50    00-AA-BB-CC-DD-EE
192.168.1.50    00-11-22-33-44-55  # โ๏ธ ุชุถุงุฑุจ!
```

**3. ูุฑุงูุจุฉ ุงูุฃุฌูุฒุฉ ุงููุดุทุฉ:**
```bash
# ุนุฏ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ
arp -a | grep dynamic | wc -l
```

### โ๏ธ ููุงุญุธุงุช ุฃูููุฉ

**ARP Spoofing/Poisoning:**
- ููุงุฌู ูุฑุณู ุฑุณุงุฆู ARP ูุฒููุฉ
- ูุฎุฏุน ุงูุฃุฌูุฒุฉ ูุฅุฑุณุงู ุงูุจูุงูุงุช ูู
- **ุงูุญูุงูุฉ:** ARP Inspection ุนูู ุงูุณููุชุดุงุช

**ุงูููุงูุฉ:**
```cisco
# ุชูุนูู Dynamic ARP Inspection
Switch(config)# ip arp inspection vlan 10
Switch(config)# interface gi0/1
Switch(config-if)# ip arp inspection trust
```

### ๐ก ูุตุงุฆุญ ุนูููุฉ
- ุฑุงูุจ ุฌุฏูู ARP ุจุดูู ุฏูุฑู
- ุงูุชุจู ููุชุบููุฑุงุช ุงูููุงุฌุฆุฉ ูู ุนูุงููู MAC
- ุงุณุชุฎุฏู ุฅุฏุฎุงูุงุช ุซุงุจุชุฉ ููุฃุฌูุฒุฉ ุงูุญุณุงุณุฉ
- ูุนูู ARP Inspection ูู ุงูุจูุฆุงุช ุงูุญุณุงุณุฉ

---

## 7. Nmap - ูุณุญ ุงูุดุจูุงุช

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู Nmap ูุงูุชุดุงู ุงูุฃุฌูุฒุฉ ูุงูุฎุฏูุงุช ุงููุดุทุฉ ุนูู ุงูุดุจูุฉ.

### ๐ ุงููุชุทูุจุงุช
- ูุธุงู Linux (ููุถู Kali Linux)
- ุตูุงุญูุงุช root ูููุณุญ ุงููุชูุฏู
- **ุจูุฆุฉ ุงุฎุชุจุงุฑูุฉ ููุท** โ๏ธ

### ๐ ุฃููุงุน ุงููุณุญ

#### 1. ุงูุชุดุงู ุงูุฃุฌูุฒุฉ ุงููุดุทุฉ (Host Discovery)

```bash
nmap -sn 192.168.1.0/24
```

**ุงูุดุฑุญ:**
- `-sn`: Ping Scan (ุจุฏูู ูุญุต ุงูููุงูุฐ)
- ูุณุชุฎุฏู ICMP Echo Request
- ููุธูุฑ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ ูุงููุดุทุฉ

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
Starting Nmap 7.94
Nmap scan report for 192.168.1.1
Host is up (0.0012s latency).

Nmap scan report for 192.168.1.50
Host is up (0.0034s latency).

Nmap scan report for 192.168.1.100
Host is up (0.0028s latency).

Nmap done: 256 IP addresses (3 hosts up) scanned in 2.85 seconds
```

#### 2. ูุญุต ุงูููุงูุฐ (Port Scanning)

**Basic TCP Scan:**
```bash
nmap 192.168.1.50
```

**Comprehensive Scan:**
```bash
nmap -sS -sV -O 192.168.1.50
```

**ุงูุดุฑุญ:**
- `-sS`: SYN Stealth Scan (ุฃูู ูุงุจููุฉ ูููุดู)
- `-sV`: ูุดู ุฅุตุฏุงุฑุงุช ุงูุฎุฏูุงุช
- `-O`: ุชุฎููู ูุธุงู ุงูุชุดุบูู

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PORT     STATE SERVICE    VERSION
21/tcp   open  ftp        vsftpd 3.0.3
22/tcp   open  ssh        OpenSSH 8.2p1
80/tcp   open  http       Apache httpd 2.4.41
443/tcp  open  ssl/http   Apache httpd 2.4.41
3306/tcp open  mysql      MySQL 5.7.33

OS details: Linux 3.2 - 4.9
```

#### 3. ูุญุต ุฌููุน ุงูููุงูุฐ

```bash
nmap -p- 192.168.1.50
```

- `-p-`: ูุญุต ุฌููุน ุงูููุงูุฐ (1-65535)
- ูุณุชุบุฑู ููุชุงู ุฃุทูู

#### 4. ูุญุต ููุงูุฐ ูุญุฏุฏุฉ

```bash
nmap -p 21,22,80,443,3306 192.168.1.50
```

### ๐ญ ุฃููุงุน ูุณุญ ุงูููุงูุฐ

#### TCP SYN Scan (ุงูุฃูุซุฑ ุดููุนุงู)
```bash
nmap -sS 192.168.1.50
```
- ูุฑุณู SYN ููุท
- ูุง ููููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ุฃูู ูุงุจููุฉ ูููุดู

#### TCP Connect Scan
```bash
nmap -sT 192.168.1.50
```
- ููููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ูุง ูุญุชุงุฌ ุตูุงุญูุงุช root
- ุฃูุซุฑ ูุงุจููุฉ ูููุดู

#### UDP Scan
```bash
nmap -sU 192.168.1.50
```
- ูุญุต ููุงูุฐ UDP
- ุจุทูุก ุฌุฏุงู
- ููู ูุฎุฏูุงุช ูุซู DNS, DHCP

### ๐ฌ ูุญุต ุงูุซุบุฑุงุช

```bash
nmap --script vuln 192.168.1.50
```

ูุณุชุฎุฏู NSE (Nmap Scripting Engine) ููุจุญุซ ุนู ุซุบุฑุงุช ูุนุฑููุฉ.

### ๐ ุชูููู ุงููุฎุงุทุฑ

#### ููุงูุฐ ุนุงููุฉ ุงูุฎุทูุฑุฉ:

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุงูุฎุทุฑ |
|--------|---------|-------|
| 21 | FTP | ููู ุจูุงูุงุช ุจุฏูู ุชุดููุฑ |
| 23 | Telnet | ุฅุฏุงุฑุฉ ุนู ุจุนุฏ ุจุฏูู ุชุดููุฑ |
| 445 | SMB | ุนุฑุถุฉ ููุฌูุงุช WannaCry ูุบูุฑูุง |
| 3389 | RDP | ูุฏู ุดุงุฆุน ูููุฌูุงุช |
| 1433 | MSSQL | ูุงุนุฏุฉ ุจูุงูุงุช ูุฏ ุชููู ุนุฑุถุฉ |

### ๐ก๏ธ ุงูุญูุงูุฉ ูู Nmap

**1. ุนูู ูุณุชูู ุงูุฌุฏุงุฑ ุงููุงุฑู:**
```cisco
# ุฑูุถ ุงููุณุญ ูู ูุตุงุฏุฑ ุฎุงุฑุฌูุฉ
access-list 100 deny tcp any any range 1 1024
```

**2. ุนูู ูุณุชูู ุงูุฎุงุฏู:**
```bash
# ุงุณุชุฎุฏุงู iptables ูููุน ุงููุณุญ
iptables -A INPUT -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT
```

**3. ุฃุฏูุงุช ูุดู ุงููุณุญ:**
```bash
# ุชุซุจูุช portsentry
sudo apt install portsentry

# ูุฑุงูุจุฉ ูุญุงููุงุช ุงููุณุญ
tail -f /var/log/syslog | grep portsentry
```

### ๐ก ูุตุงุฆุญ ููุงุณุชุฎุฏุงู ุงูุขูู
- โ๏ธ **ูุง ุชูู ุจูุณุญ ุดุจูุงุช ูุง ุชููููุง**
- ๐ ุงุญุตู ุนูู ุฅุฐู ุฎุทู ูุจู ุฃู ุงุฎุชุจุงุฑ ุงุฎุชุฑุงู
- ๐ ุงุณุชุฎุฏู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ููุชุฏุฑูุจ
- ๐ ูุซูู ุฌููุน ุนูููุงุช ุงููุณุญ ููุชุงุฆุฌูุง

### ๐ ุฃูุซูุฉ ุชุนููููุฉ ุฅุถุงููุฉ

**ูุณุญ ุณุฑูุน ูุฃูู 100 ูููุฐ:**
```bash
nmap --top-ports 100 192.168.1.50
```

**ูุณุญ ูุน ุชุฌูุจ ุงููุดู:**
```bash
nmap -sS -T2 -f 192.168.1.50
```
- `-T2`: ุณุฑุนุฉ ุจุทูุฆุฉ (ุฃูู ุฅุฒุนุงุฌุงู)
- `-f`: ุชุฌุฒุฆุฉ ุงูุญุฒู

**ุญูุธ ุงููุชุงุฆุฌ:**
```bash
nmap -oN results.txt 192.168.1.50
nmap -oX results.xml 192.168.1.50
```

---

## 8. ICMP - ุงุฎุชุจุงุฑุงุช ุงูุดุจูุฉ

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู ุฃุฏูุงุช ICMP ูุชุดุฎูุต ูุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจุงูุดุจูุฉ.

### ๐ ุจุฑูุชูููู ICMP
Internet Control Message Protocol - ุจุฑูุชูููู ุฑุณุงุฆู ุงูุชุญูู ูู ุงูุฅูุชุฑูุช
- Layer 3 Protocol
- ููุณุชุฎุฏู ููุชุดุฎูุต ูุฅุจูุงุบ ุงูุฃุฎุทุงุก
- ูุง ูุญูู ุจูุงูุงุช ุงููุณุชุฎุฏู

### ๐ ุงูุฃูุงูุฑ ุงูุฃุณุงุณูุฉ

#### 1. Ping - ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

**ุงูุงุณุชุฎุฏุงู ุงูุจุณูุท:**
```bash
ping 8.8.8.8
```

**ูุน ุฎูุงุฑุงุช ูุชูุฏูุฉ:**
```bash
# ุฅุฑุณุงู 10 ุญุฒู ููุท
ping -c 10 8.8.8.8

# ุชุบููุฑ ุญุฌู ุงูุญุฒูุฉ
ping -s 1000 8.8.8.8

# ุชุญุฏูุฏ ุงูููุช ุจูู ุงูุญุฒู (ุซุงููุฉ ูุงุญุฏุฉ)
ping -i 1 8.8.8.8
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=116 time=12.4 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=116 time=11.8 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=116 time=12.1 ms

--- 8.8.8.8 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2003ms
rtt min/avg/max/mdev = 11.8/12.1/12.4/0.3 ms
```

#### 2. Traceroute - ุชุชุจุน ุงููุณุงุฑ

**ุนูู Linux:**
```bash
traceroute 8.8.8.8
```

**ุนูู Windows:**
```cmd
tracert 8.8.8.8
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  192.168.1.1 (192.168.1.1)  1.245 ms  1.123 ms  1.089 ms
 2  10.0.0.1 (10.0.0.1)  8.456 ms  8.234 ms  8.123 ms
 3  172.16.0.1 (172.16.0.1)  15.678 ms  15.456 ms  15.234 ms
 4  * * *
 5  8.8.8.8 (8.8.8.8)  22.345 ms  22.123 ms  21.987 ms
```

**ุงูุชุญููู:**
- ูู ุณุทุฑ ููุซู ููุฌูู (router) ูู ุงููุณุงุฑ
- ุงูุฃุฑูุงู ุงูุซูุงุซุฉ: ุฒูู ุงูุงุณุชุฌุงุจุฉ ูููุญุงููุงุช ุงูุซูุงุซ
- `* * *`: ุงูููุฌูู ูุง ูุณุชุฌูุจ ูุทูุจุงุช ICMP

#### 3. MTR - ุชุชุจุน ูุชูุฏู

```bash
mtr 8.8.8.8
```

ูุฌูุน ุจูู ping ู traceroute ูุน ุฅุญุตุงุฆูุงุช ูุณุชูุฑุฉ:
```
                             Packets               Pings
 Host                      Loss%   Snt   Last   Avg  Best  Wrst StDev
 1. 192.168.1.1             0.0%    10    1.2   1.3   1.1   1.5   0.1
 2. 10.0.0.1                0.0%    10    8.4   8.5   8.1   9.2   0.3
 3. 8.8.8.8                 0.0%    10   22.1  22.3  21.8  23.1   0.4
```

### ๐ ุฃููุงุน ุฑุณุงุฆู ICMP

| ุงูููุน | ุงูุงุณู | ุงูุงุณุชุฎุฏุงู |
|-------|-------|-----------|
| Type 0 | Echo Reply | ุฑุฏ ุนูู Ping |
| Type 3 | Destination Unreachable | ุงููุฌูุฉ ุบูุฑ ูุชุงุญุฉ |
| Type 5 | Redirect | ุฅุนุงุฏุฉ ุชูุฌูู ุงููุณุงุฑ |
| Type 8 | Echo Request | ุทูุจ Ping |
| Type 11 | Time Exceeded | ุงูุชูุงุก TTL (ูุณุชุฎุฏูู traceroute) |

### โ๏ธ ุงุฎุชุจุงุฑุงุช ูุชูุฏูุฉ (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ููุท)

#### ICMP Flood Test

```bash
# โ๏ธ ููุงุฎุชุจุงุฑ ูู ุจูุฆุฉ ูุนุฒููุฉ ููุท
sudo ping -f -s 65500 TARGET_IP
```

**ุงูุดุฑุญ:**
- `-f`: Flood mode (ุฅุฑุณุงู ุณุฑูุน ุฌุฏุงู)
- `-s 65500`: ุญุฌู ุงูุญุฒูุฉ (ุฃูุตู ุญุฏ)
- **ููุณุชุฎุฏู ูุงุฎุชุจุงุฑ ุชุญูู ุงูุดุจูุฉ**

**ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
```
PING target (192.168.1.50) 65500(65528) bytes of data.
..................................
--- target ping statistics ---
10000 packets transmitted, 9856 received, 1.44% packet loss
```

#### Ping of Death (ุชุงุฑูุฎู)

```bash
# โ๏ธ ูุง ูุนูู ุนูู ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ
ping -s 65510 TARGET_IP
```

**ุงูุฎูููุฉ:**
- ูุงู ููุณุจุจ ุชุนุทู ุงูุฃูุธูุฉ ุงููุฏููุฉ
- ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ ูุญููุฉ ุถุฏู

### ๐ก๏ธ ุงูุญูุงูุฉ ูู ูุฌูุงุช ICMP

#### 1. ุชุญุฏูุฏ ูุนุฏู ICMP

**ุนูู Linux:**
```bash
# ุชุญุฏูุฏ ุนุฏุฏ ุญุฒู ICMP ูู ุงูุซุงููุฉ
iptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT
iptables -A INPUT -p icmp --icmp-type echo-request -j DROP
```

#### 2. ุนูู Cisco Router

```cisco
# ุชุญุฏูุฏ ูุนุฏู ICMP
access-list 100 permit icmp any any echo-reply
access-list 100 deny icmp any any echo-request
interface gi0/0
ip access-group 100 in
rate-limit input access-group 100 1000000 250000 500000 conform-action transmit exceed-action drop
```

#### 3. ุญุธุฑ ICMP ููุงุฆูุงู (ุบูุฑ ูุณุชุญุณู)

```bash
# ููููุฏ ุงููุฏุฑุฉ ุนูู ุงูุชุดุฎูุต
iptables -A INPUT -p icmp -j DROP
```

### ๐ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงูุนูููุฉ

**1. ุชุดุฎูุต ุงููุทุงุน ุงูุงุชุตุงู:**
```bash
# ุฎุทูุฉ ุจุฎุทูุฉ
ping 192.168.1.1  # ุงูุจูุงุจุฉ ุงููุญููุฉ
ping 8.8.8.8      # ุฎุงุฏู ุฎุงุฑุฌู
traceroute 8.8.8.8  # ุชุญุฏูุฏ ููุทุฉ ุงูุงููุทุงุน
```

**2. ููุงุณ ุฌูุฏุฉ ุงูุงุชุตุงู:**
```bash
# ูุฑุงูุจุฉ ููุฏุฉ 5 ุฏูุงุฆู
ping -c 300 -i 1 8.8.8.8 | tee ping_results.txt

# ุชุญููู ุงููุชุงุฆุฌ
grep "time=" ping_results.txt | awk '{print $7}' | sed 's/time=//' | sort -n
```

**3. ุงุฎุชุจุงุฑ MTU (Maximum Transmission Unit):**
```bash
# ุงุจุฏุฃ ุจุญุฌู ูุจูุฑ ููููู ุชุฏุฑูุฌูุงู
ping -M do -s 1472 8.8.8.8

# ุฅุฐุง ูุดูุ ููู ุงูุญุฌู ุญุชู ููุฌุญ
ping -M do -s 1400 8.8.8.8
```

### ๐ก ูุตุงุฆุญ ูููุฉ
- ICMP ููุณ ุขููุงู 100% - ูููู ุงุณุชุฎุฏุงูู ูู ุงููุฌูุงุช
- ุจุนุถ ุงูุดุจูุงุช ุชุญุธุฑ ICMP ููุฃูุงู
- ุงุณุชุฎุฏู ุฃุฏูุงุช ุจุฏููุฉ (TCP ping) ุนูุฏ ุงูุญุงุฌุฉ
- ูุง ุชุนุชูุฏ ุนูู ICMP ููุท ูููุฑุงูุจุฉ

---

## 9. SYN Flooding Attack

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุฉ ูุฌูู SYN Flood ูุชุฃุซูุฑู ุนูู ุงูุฎูุงุฏู.

### โ๏ธ ุชุญุฐูุฑ ููู ุฌุฏุงู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ๏ธ  ูุฐุง ุงููุญุชูู ูุฃุบุฑุงุถ ุชุนููููุฉ ููุท  โ๏ธ       โ
โ                                                  โ
โ  ุชูููุฐ ูุฐุง ุงููุฌูู ุนูู ุฃูุธูุฉ ุญููููุฉ:           โ
โ  โข ุฌุฑููุฉ ูุนุงูุจ ุนูููุง ุงููุงููู                   โ
โ  โข ูุชุทูุจ ุฅุฐู ุฎุทู ูุณุจู                          โ
โ  โข ููุณูุญ ููุท ูู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุฌูู

#### ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ ุงูุทุจูุนูุฉ (TCP Three-Way Handshake)

```
Client                    Server
  |                         |
  |-------- SYN ---------->|  [1]
  |<----- SYN-ACK ---------|  [2]
  |-------- ACK ---------->|  [3]
  |                         |
  |==== Connection Open ====|
```

#### ูุฌูู SYN Flood

```
Attacker                  Server
  |                         |
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |      (thousands)        |
  |                         |
  |   โ No ACK Sent โ    |
  |                         |
  |                    [Server]
  |                   SYN Queue
  |                   โโโโโโโโโโโ
  |                   โ SYN #1  โ โณ
  |                   โ SYN #2  โ โณ
  |                   โ SYN #3  โ โณ
  |                   โ SYN #... โ โณ
  |                   โ FULL!   โ ๐ด
  |                   โโโโโโโโโโโ
```

### ๐ฌ ุงูุชุทุจูู ุงูุนููู (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ููุท)

#### ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุขูุฉ ุงูุชุฑุงุถูุฉ ููููุงุฌู (Kali Linux)
- ุฎุงุฏู ุงุฎุชุจุงุฑ ูุนุฒูู
- ุดุจูุฉ ูุญููุฉ ููุนุฒูุฉ ุชูุงูุงู

#### ุงูุฃุฏุงุฉ: hping3

**ุงูุชุซุจูุช:**
```bash
sudo apt update
sudo apt install hping3
```

**ุงููุฌูู ุงูุฃุณุงุณู:**
```bash
sudo hping3 -S -p 80 --flood TARGET_IP
```

**ุงูุดุฑุญ:**
- `-S`: ุฅุฑุณุงู ุญุฒู SYN ููุท
- `-p 80`: ุงุณุชูุฏุงู ุงููููุฐ 80 (HTTP)
- `--flood`: ุฅุฑุณุงู ุฃุณุฑุน ูุง ูููู (ุจุฏูู ุงูุชุธุงุฑ)
- `TARGET_IP`: ุนููุงู ุงูุฎุงุฏู ุงููุณุชูุฏู

**ูุฌูู ูุชูุฏู ูุน ุนูุงููู ูุฒููุฉ:**
```bash
sudo hping3 -S -p 80 --flood --rand-source TARGET_IP
```

- `--rand-source`: ุนูุงููู IP ูุตุฏุฑ ุนุดูุงุฆูุฉ
- ููุตุนูุจ ุชุชุจุน ุงูููุงุฌู
- ูุชุฌุงูุฒ ุจุนุถ ุขููุงุช ุงูุญูุงูุฉ ุงูุจุณูุทุฉ

### ๐ ุงููุฑุงูุจุฉ ุนูู ุงูุฎุงุฏู ุงููุณุชูุฏู

#### ุนุฑุถ ุงูุงุชุตุงูุงุช ูุตู ุงูููุชูุญุฉ

```bash
netstat -ant | grep SYN_RECV
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ ุฃุซูุงุก ุงููุฌูู:**
```
tcp    0    0 192.168.1.50:80    10.0.0.100:45123    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.101:45124    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.102:45125    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.103:45126    SYN_RECV
... (ูุฆุงุช ุฃู ุขูุงู ุงูุณุทูุฑ)
```

#### ูุฑุงูุจุฉ ุงุณุชููุงู ุงูููุงุฑุฏ

```bash
# ุนุฑุถ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
ss -tan | grep SYN-RECV | wc -l

# ูุฑุงูุจุฉ ุงูุฐุงูุฑุฉ
free -h

# ูุฑุงูุจุฉ CPU
top
```

**ูุคุดุฑุงุช ุงููุฌูู:**
```
SYN-RECV connections: 5000+  ๐ด (ุทุจูุนู: < 100)
Memory usage: 95%             ๐ด (ุทุจูุนู: < 70%)
CPU load: 100%                ๐ด (ุทุจูุนู: < 50%)
```

### ๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ

#### 1. SYN Cookies

**ุชูุนูู SYN Cookies ุนูู Linux:**
```bash
# ุงูุชุญูู ูู ุงูุญุงูุฉ ุงูุญุงููุฉ
cat /proc/sys/net/ipv4/tcp_syncookies

# ุงูุชูุนูู (1 = enabled)
sudo sysctl -w net.ipv4.tcp_syncookies=1

# ุฌุนูู ุฏุงุฆูุงู
echo "net.ipv4.tcp_syncookies = 1" | sudo tee -a /etc/sysctl.conf
```

**ููู ุชุนูู:**
```
ุจุฏูุงู ูู ุชุฎุฒูู ุงูุงุชุตุงู ูู ุงูุฐุงูุฑุฉ:
1. ุงูุฎุงุฏู ูุญุณุจ ูููุฉ ูุดูุฑุฉ (cookie)
2. ููุฑุณููุง ูู SYN-ACK
3. ูุง ูุญูุธ ุดูุก ูู ุงูุฐุงูุฑุฉ
4. ุนูุฏ ุงุณุชูุงู ACKุ ูุชุญูู ูู ุงูู cookie
5. ุฅู ุตุญุ ููููู ุงูุงุชุตุงู

ุงููุชูุฌุฉ: ูุง ุงุณุชูุฒุงู ููุฐุงูุฑุฉ โ
```

#### 2. ุชุญุฏูุฏ ูุนุฏู ุงูุงุชุตุงูุงุช ุงูุฌุฏูุฏุฉ

**ุจุงุณุชุฎุฏุงู iptables:**
```bash
# ุงูุณูุงุญ ุจู 5 ุงุชุตุงูุงุช ุฌุฏูุฏุฉ ููุท ูู ุงูุซุงููุฉ ูู ููุณ IP
iptables -A INPUT -p tcp --syn -m limit --limit 5/s --limit-burst 10 -j ACCEPT
iptables -A INPUT -p tcp --syn -j DROP
```

**ุจุงุณุชุฎุฏุงู nftables:**
```bash
nft add rule ip filter input tcp flags syn ct state new limit rate 5/second accept
```

#### 3. ุฒูุงุฏุฉ ุญุฌู ูุงุฆูุฉ SYN

```bash
# ุฒูุงุฏุฉ ุงูุญุฏ ุงูุฃูุตู ููุงุชุตุงูุงุช ูุตู ุงูููุชูุญุฉ
sudo sysctl -w net.ipv4.tcp_max_syn_backlog=4096

# ุชูููู ููุช ุงูุงูุชุธุงุฑ
sudo sysctl -w net.ipv4.tcp_synack_retries=2
```

#### 4. ุงุณุชุฎุฏุงู Firewall ูุชูุฏู

**Cisco ASA:**
```cisco
! ุชุญุฏูุฏ ุนุฏุฏ ุงูุงุชุตุงูุงุช ุงููุชุฒุงููุฉ
access-list OUTSIDE_IN extended permit tcp any host 203.0.113.50 eq www
class-map SYN-ATTACK
 match access-list OUTSIDE_IN
policy-map OUTSIDE_POLICY
 class SYN-ATTACK
  set connection conn-max 100 embryonic-conn-max 50
service-policy OUTSIDE_POLICY interface outside
```

**pfSense/OPNsense:**
- ุชูุนูู "SYN Proxy"
- ุถุจุท "Maximum States" ู "Maximum Source Nodes"

#### 5. ุงุณุชุฎุฏุงู CDN/DDoS Protection

ุฎุฏูุงุช ูุซู:
- Cloudflare
- AWS Shield
- Akamai

ุชููู ุจู:
- ุงูุชุตุงุต ุงููุฌูุงุช ุงูุถุฎูุฉ
- ุชูุฒูุน ุงูุญูู
- ููุชุฑุฉ ุงูุญุฑูุฉ ุงูุฎุจูุซุฉ

### ๐ ุงูุชุฃุซูุฑ ุนูู ุงูุฎุงุฏู

#### ูุฑุงุญู ุงููุฌูู

**ุงููุฑุญูุฉ 1: ุงูุจุฏุงูุฉ (0-30 ุซุงููุฉ)**
```
SYN Queue: 20% full
Response Time: 100ms โ 500ms
```

**ุงููุฑุญูุฉ 2: ุงูุชุตุนูุฏ (30-60 ุซุงููุฉ)**
```
SYN Queue: 80% full
Response Time: 500ms โ 3000ms
New connections: ุจุทูุฆุฉ ุฌุฏุงู
```

**ุงููุฑุญูุฉ 3: ุงูุงูููุงุฑ (60+ ุซุงููุฉ)**
```
SYN Queue: 100% full
Response Time: timeout
New connections: ูุฑููุถุฉ ุจุงููุงูู
Service: ุบูุฑ ูุชุงุญ ๐ด
```

### ๐ ูุดู ุงููุฌูู

#### ุนูุงูุงุช ุงูุชุญุฐูุฑ

```bash
# ุงุฑุชูุงุน ููุงุฌุฆ ูู SYN_RECV
watch -n 1 'netstat -ant | grep SYN_RECV | wc -l'

# ุชูุจูู ุนูุฏ ุชุฌุงูุฒ ุญุฏ ูุนูู
while true; do
  COUNT=$(netstat -ant | grep SYN_RECV | wc -l)
  if [ $COUNT -gt 1000 ]; then
    echo "โ๏ธ Possible SYN Flood: $COUNT connections"
  fi
  sleep 5
done
```

#### ุชุญููู ุงูุณุฌูุงุช

```bash
# ุนุฑุถ ุฃูุซุฑ IP ูุตุฏุฑูุฉ ูุดุงุทุงู
netstat -ant | grep SYN_RECV | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -nr | head -10
```

### ๐ก ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ

**ูููุฏุงูุนูู:**
1. โ ูุนูู SYN Cookies ุฏุงุฆูุงู
2. โ ุฑุงูุจ ูุนุฏูุงุช ุงูุงุชุตุงู ุจุดูู ูุณุชูุฑ
3. โ ุงุณุชุฎุฏู Firewall ูุน ุฅููุงููุงุช DDoS protection
4. โ ุงุญุชูุธ ุจุฎุทุฉ ุงุณุชุฌุงุจุฉ ุฌุงูุฒุฉ

**ููููุงุฌููู ุงูุฃุฎูุงูููู:**
1. ๐ ุงุญุตู ุนูู ุฅุฐู ุฎุทู ูุจู ุงูุงุฎุชุจุงุฑ
2. ๐ ุงุณุชุฎุฏู ุจูุฆุฉ ูุนุฒููุฉ ุชูุงูุงู
3. โฐ ุญุฏุฏ ูุงูุฐุฉ ุฒูููุฉ ูุญุฏูุฏุฉ ููุงุฎุชุจุงุฑ
4. ๐ ูุซูู ุงููุชุงุฆุฌ ุจุดูู ุงุญุชุฑุงูู

---

## 10. UDP Flood Attack

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุฉ ูุฌูู UDP Flood ูุงููุฑู ุจููู ูุจูู SYN Flood.

### โ๏ธ ุชุญุฐูุฑ ูุงูููู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐จ ูุฐุง ุงููุญุชูู ููุชุนููู ูุงูุฃุจุญุงุซ ุงูุฃูููุฉ ููุท  โ
โ                                                   โ
โ  ุงูููุงู ุจูุฐุง ุงููุฌูู ุฏูู ุฅุฐู ูู:                โ
โ  โข ุฌุฑููุฉ ุฅููุชุฑูููุฉ                              โ
โ  โข ููุนุงูุจ ุนูููุง ุจุงูุณุฌู ูุงูุบุฑุงูุฉ                โ
โ  โข ููุณูุญ ููุท ูู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูููููุฉ ูู         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ุงููุฑู ุจูู TCP ู UDP

| ุงูููุฒุฉ | TCP | UDP |
|--------|-----|-----|
| ุงูุงุชุตุงู | Connection-oriented | Connectionless |
| ุงููุตุงูุญุฉ | ูุนู (3-way handshake) | ูุง |
| ุงูููุซูููุฉ | ูุถููู ุงููุตูู | ุบูุฑ ูุถููู |
| ุงูุณุฑุนุฉ | ุฃุจุทุฃ | ุฃุณุฑุน |
| ุงูุชุฑุชูุจ | ูุฑุชุจ | ุบูุฑ ูุฑุชุจ |

### ๐ฌ ุขููุฉ ูุฌูู UDP Flood

```
Attacker                    Target Server
  |                              |
  |------- UDP Packet ---------->| Port 53 (DNS)
  |------- UDP Packet ---------->| Port 161 (SNMP)
  |------- UDP Packet ---------->| Port 12345 (Random)
  |------- UDP Packet ---------->| Port 9999 (Closed)
  |       (thousands/sec)        |
  |                              |
  |                         [Server Process]
  |                         1. ุชููู ุงูุญุฒูุฉ
  |                         2. ูุญุต ุงููููุฐ
  |                         3. ุงููููุฐ ูุบููุ
  |                         4. ุฅุฑุณุงู ICMP Port Unreachable
  |                              |
  |<---- ICMP Unreachable -------|
  |<---- ICMP Unreachable -------|
  |<---- ICMP Unreachable -------|
  |                              |
  |                    [Result: Resource Exhaustion]
  |                    โข CPU: 100%
  |                    โข Bandwidth: Saturated
  |                    โข Service: Unavailable
```

### ๐ฌ ุงูุชุทุจูู ุงูุนููู (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ููุท)

#### ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุดุจูุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ุชูุงูุงู
- ุฎุงุฏู ุงุฎุชุจุงุฑ ูุฎุตุต
- ุฅุฐู ุฎุทู ููุซู

#### ุงุณุชุฎุฏุงู hping3

**ุงููุฌูู ุงูุฃุณุงุณู:**
```bash
sudo hping3 --udp -p 53 --flood TARGET_IP
```

**ุงูุดุฑุญ:**
- `--udp`: ุงุณุชุฎุฏุงู ุจุฑูุชูููู UDP
- `-p 53`: ุงุณุชูุฏุงู ูููุฐ DNS
- `--flood`: ุฅุฑุณุงู ุจุฃูุตู ุณุฑุนุฉ ููููุฉ

**ูุฌูู ูุน ููุงูุฐ ุนุดูุงุฆูุฉ:**
```bash
sudo hping3 --udp --rand-dest --flood TARGET_IP
```

- `--rand-dest`: ููุงูุฐ ูุฌูุฉ ุนุดูุงุฆูุฉ
- ููุถุนู ุงูุฎุงุฏู ุฃูุซุฑ (ููุญุต ูู ูููุฐ)

**ูุฌูู ูุน ุญุฌู ุญุฒูุฉ ูุจูุฑ:**
```bash
sudo hping3 --udp -p 53 --flood -d 65500 TARGET_IP
```

- `-d 65500`: ุญุฌู ุงูุจูุงูุงุช (ุฃูุตู ุญุฏ ูู UDP)
- ูุณุชููู bandwidth ุฃูุซุฑ

### ๐ ุงููุฑุงูุจุฉ ุนูู ุงูุฎุงุฏู ุงููุณุชูุฏู

#### ุนุฑุถ ุฅุญุตุงุฆูุงุช UDP

```bash
netstat -s | grep UDP
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ ุฃุซูุงุก ุงููุฌูู:**
```
UDP:
    125847 packets received
    98234 packets to unknown port received
    89123 packet receive errors
    45678 packets sent
    RcvbufErrors: 12345
    SndbufErrors: 0
    InErrors: 89123
```

#### ูุฑุงูุจุฉ ุงูุญุฒู ูู ุงูููุช ุงููุนูู

```bash
# ุนุฑุถ ูุนุฏู ุญุฒู UDP
watch -n 1 'netstat -su | grep "packets received"'

# ูุฑุงูุจุฉ ููุงูุฐ ูุญุฏุฏุฉ
tcpdump -i eth0 udp port 53 -nn
```

**ูุคุดุฑุงุช ุงููุฌูู:**
```
UDP packets/sec: 50,000+     ๐ด (ุทุจูุนู: < 1,000)
Port Unreachable: 40,000+    ๐ด (ุทุจูุนู: < 10)
Bandwidth usage: 90%+        ๐ด (ุทุจูุนู: < 50%)
CPU usage: 100%              ๐ด (ุทุจูุนู: < 30%)
```

#### ุชุญุฏูุฏ ุฃูุซุฑ ุงูููุงูุฐ ุงููุณุชูุฏูุฉ

```bash
tcpdump -i eth0 -nn udp -c 1000 | awk '{print $5}' | cut -d'.' -f5 | sort | uniq -c | sort -nr | head -10
```

### ๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ

#### 1. Rate Limiting ุนูู Linux

```bash
# ุชุญุฏูุฏ ูุนุฏู ุญุฒู UDP ูู ูู IP
iptables -A INPUT -p udp -m limit --limit 100/s --limit-burst 200 -j ACCEPT
iptables -A INPUT -p udp -j DROP

# ุญูุงูุฉ ููุงูุฐ ูุญุฏุฏุฉ
iptables -A INPUT -p udp --dport 53 -m limit --limit 50/s -j ACCEPT
iptables -A INPUT -p udp --dport 53 -j DROP
```

#### 2. ุชุนุทูู ICMP Port Unreachable

```bash
# ููุน ุฅุฑุณุงู ุฑุณุงุฆู Port Unreachable
iptables -A OUTPUT -p icmp --icmp-type destination-unreachable -j DROP

# ุฃู ุนุจุฑ sysctl
sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1
```

**ุงููุงุฆุฏุฉ:**
- ูููุฑ ููุงุฑุฏ CPU
- ูููุน ุงุณุชูุฒุงู bandwidth ุจุงูุฑุฏูุฏ

#### 3. ุญูุงูุฉ ุนูู ูุณุชูู ุงูุฎุงุฏู

```bash
# ุฒูุงุฏุฉ ุญุฌู buffer ููู UDP
sysctl -w net.core.rmem_max=26214400
sysctl -w net.core.rmem_default=26214400

# ุชุญุณูู ูุนุงูุฌุฉ ุงูุญุฒู
sysctl -w net.core.netdev_max_backlog=5000
```

#### 4. Firewall Rules ุนูู Cisco

```cisco
! ุชุญุฏูุฏ ูุนุฏู UDP
access-list 110 permit udp any host 203.0.113.50 eq domain
access-list 110 deny udp any any

interface GigabitEthernet0/0
 ip access-group 110 in
 rate-limit input access-group 110 10000000 1000000 2000000 conform-action transmit exceed-action drop
```

#### 5. ุงุณุชุฎุฏุงู fail2ban

```bash
# ุชุซุจูุช fail2ban
sudo apt install fail2ban

# ุฅูุดุงุก ูุงุนุฏุฉ ูู UDP flood
sudo nano /etc/fail2ban/filter.d/udp-flood.conf
```

**ูุญุชูู ุงูููู:**
```ini
[Definition]
failregex = .*kernel.*UDP.*SRC=<HOST>.*
ignoreregex =
```

**ุงูุชูุนูู:**
```ini
# /etc/fail2ban/jail.local
[udp-flood]
enabled = true
filter = udp-flood
logpath = /var/log/syslog
maxretry = 100
findtime = 60
bantime = 3600
```

### ๐ ุงูููุงูุฐ ุงูุดุงุฆุนุฉ ุงููุณุชูุฏูุฉ

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุณุจุจ ุงูุงุณุชูุฏุงู |
|--------|---------|---------------|
| 53 | DNS | ุญููู ููุดุจูุฉุ ูููุฏ ุงุณุชุฌุงุจุงุช |
| 123 | NTP | ูููู ุชุถุฎููู (Amplification) |
| 161 | SNMP | ุฅุฏุงุฑุฉุ ุบุงูุจุงู ููุชูุญ |
| 1900 | SSDP | UPnPุ ุดุงุฆุน ูู ุงูุฃุฌูุฒุฉ ุงูููุฒููุฉ |
: MD5
- `$5# ุชุฏุฑูุจุงุช ุนูููุฉ ูู ุฃูู ุงูุดุจูุงุช
## Network Security - Practical Labs

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [NAT/PAT - ุชุฑุฌูุฉ ุนูุงููู ุงูุดุจูุฉ](#1-natpat---ุชุฑุฌูุฉ-ุนูุงููู-ุงูุดุจูุฉ)
2. [ACL - ููุงุฆู ุงูุชุญูู ุจุงููุตูู](#2-acl---ููุงุฆู-ุงูุชุญูู-ุจุงููุตูู)
3. [FTP ูุขููุฉ Established](#3-ftp-ูุขููุฉ-established)
4. [WAF ู Load Balancer](#4-waf-ู-load-balancer)
5. [Cisco Firepower - ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ](#5-cisco-firepower---ุชุญููู-ุงูุจุฑูุฌูุงุช-ุงูุฎุจูุซุฉ)
6. [ARP - ุจุฑูุชูููู ุชุญููู ุงูุนูุงููู](#6-arp---ุจุฑูุชูููู-ุชุญููู-ุงูุนูุงููู)
7. [Nmap - ูุณุญ ุงูุดุจูุงุช](#7-nmap---ูุณุญ-ุงูุดุจูุงุช)
8. [ICMP - ุงุฎุชุจุงุฑุงุช ุงูุดุจูุฉ](#8-icmp---ุงุฎุชุจุงุฑุงุช-ุงูุดุจูุฉ)
9. [SYN Flooding Attack](#9-syn-flooding-attack)
10. [UDP Flood Attack](#10-udp-flood-attack)
11. [Nmap Port Scanning](#11-nmap-port-scanning)
12. [John the Ripper - ูุณุฑ ูููุงุช ุงููุฑูุฑ](#12-john-the-ripper---ูุณุฑ-ูููุงุช-ุงููุฑูุฑ)
13. [DHCP Snooping](#13-dhcp-snooping)

---

## 1. NAT/PAT - ุชุฑุฌูุฉ ุนูุงููู ุงูุดุจูุฉ

### ๐ฏ ุงููุฏู
ููู ุขููุฉ ุนูู NAT/PAT ูู ุชุฑุฌูุฉ ุงูุนูุงููู ุงูุฎุงุตุฉ ุฅูู ุนูุงููู ุนุงูุฉ.

### ๐ ุงูุณููุงุฑูู
ุฌูุงุฒ ุฏุงุฎูู ุจุนููุงู `10.0.0.5` ูุฑูุฏ ุชุตูุญ ุงูุฅูุชุฑูุช ุนุจุฑ ุฌุฏุงุฑ ูุงุฑู ูุณุชุฎุฏู NAT.

### ๐ ุฎุทูุงุช ุงูุนูู

1. **ุงูุทูุจ ุงูุตุงุฏุฑ:**
   - ุงูุฌูุงุฒ ุงูุฏุงุฎูู `10.0.0.5` ูุฑุณู ุทูุจ HTTP
   - ุงูุฌุฏุงุฑ ุงููุงุฑู ูุชุฑุฌู ุงูุนููุงู ุฅูู `203.0.113.2:10500`
   - ุงูุนููุงู `203.0.113.2` ูู ุงูุนููุงู ุงูุนุงู
   - ุงููููุฐ `10500` ููุณุชุฎุฏู ูุชูููุฒ ุงูุงุชุตุงู

2. **ุงูุฑุฏ ุงููุงุฑุฏ:**
   - ุนูุฏ ูุตูู ุงูุฑุฏ ูู ุงูุฅูุชุฑูุช ุฅูู `203.0.113.2:10500`
   - ูุนูุฏ NAT ุงูุชุฑุฌูุฉ ุงูุนูุณูุฉ ุฅูู `10.0.0.5` ุจุงููููุฐ ุงูุฃุตูู
   - ูุชู ุชุณููู ุงูุจูุงูุงุช ููุฌูุงุฒ ุงูุฏุงุฎูู

### โ ุงููุงุฆุฏุฉ
- ูุฆุงุช ุงูุฃุฌูุฒุฉ ูููููุง ูุดุงุฑูุฉ ุนููุงู ุนุงู ูุงุญุฏ
- ูุง ููุฌุฏ ุชุถุงุฑุจ ุจูุถู ุงุณุชุฎุฏุงู ุฃุฑูุงู ุงูููุงูุฐ (Port Numbers)
- ุชูููุฑ ูู ุนูุงููู IPv4 ุงูุนุงูุฉ

### ๐ ููุงุญุธุงุช
- PAT (Port Address Translation) ูู ููุน ูู NAT
- ููุณูู ุฃูุถุงู NAT Overload
- ุงูุฌุฏูู ุงูุฏุงุฎูู ูุญุชูุธ ุจุงูุฑุจุท ุจูู ุงูุนูุงููู ุงูุฏุงุฎููุฉ ูุงูููุงูุฐ

---

## 2. ACL - ููุงุฆู ุงูุชุญูู ุจุงููุตูู

### ๐ฏ ุงููุฏู
ุชุทุจูู ุณูุงุณุงุช ุฃูููุฉ ุจุงุณุชุฎุฏุงู ููุงุฆู ุงูุชุญูู ุจุงููุตูู (Access Control Lists).

### ๐ ุงูุณููุงุฑูู
ูุฏูู:
- **Web Server** ูู DMZ (Demilitarized Zone)
- **Database Server** ุฏุงุฎู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ

> ๐ก **DMZ:** ููุทูุฉ ููุฒูุนุฉ ุงูุณูุงุญุ ููู ููุทูุฉ ุจูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ูุงูุฅูุชุฑูุช ูุชูููู ุงููุฎุงุทุฑ ุงูุฃูููุฉ.

### ๐ง ุงูุชูููู ุงูุนููู

```cisco
access-list 100 permit tcp any 10.10.10.10 eq www
access-list 100 permit tcp any 10.10.10.10 eq 443
access-list 100 permit tcp any 10.10.10.12 eq ftp
access-list 100 permit tcp any 10.10.10.12 eq ftp-data
access-list 100 deny ip any any log

interface gi0/1
ip access-group 100 in
```

### ๐ ุดุฑุญ ุงูุฃูุงูุฑ

| ุงูุฃูุฑ | ุงููุธููุฉ |
|------|---------|
| `permit tcp any 10.10.10.10 eq www` | ุงูุณูุงุญ ุจุงููุตูู ูุฎุงุฏู ุงูููุจ ุนุจุฑ HTTP (ูููุฐ 80) |
| `permit tcp any 10.10.10.10 eq 443` | ุงูุณูุงุญ ุจุงููุตูู ุนุจุฑ HTTPS (ูููุฐ 443) |
| `permit tcp any 10.10.10.12 eq ftp` | ุงูุณูุงุญ ุจู FTP Control (ูููุฐ 21) |
| `permit tcp any 10.10.10.12 eq ftp-data` | ุงูุณูุงุญ ุจู FTP Data (ูููุฐ 20) |
| `deny ip any any log` | ุญุธุฑ ุฃู ุญุฑูุฉ ุฃุฎุฑู ูุน ุงูุชุณุฌูู |
| `ip access-group 100 in` | ุชุทุจูู ุงููุงุฆูุฉ ุนูู ุงููุงุฌูุฉ |

### ๐ฏ ุงููุฏู ุงูุฃููู
- ุงูุณูุงุญ ุจุงููุตูู ููุท ููููุงูุฐ ุงููุทููุจุฉ
- ููุน ุงููุตูู ุงููุจุงุดุฑ ูุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุณุฌูู ุงููุญุงููุงุช ุงููุดุจููุฉ
- ุชูููู ูุทุงู ุงููุฌูู (Attack Surface)

### โ๏ธ ููุงุญุธุงุช ูููุฉ
- ุงููุตูู ููุงุนุฏุฉ ุงูุจูุงูุงุช ูุฌุจ ุฃู ูุชู ููุท ูู ุฎูุงู ุฎุงุฏู ุงูููุจ
- ุชุฑุชูุจ ุงูููุงุนุฏ ููู ุฌุฏุงู (ูู ุงูุฃุนูู ููุฃุณูู)
- ุงููุงุนุฏุฉ ุงูุถูููุฉ ูู ุงูููุงูุฉ: `deny any any`

---

## 3. FTP ูุขููุฉ Established

### ๐ฏ ุงููุฏู
ููู ุงููุฑู ุจูู FTP Passive ู Active Mode ูุชุฃุซูุฑู ุนูู ACL.

### ๐ ุจููุฉ FTP
ุจุฑูุชูููู FTP ูุณุชุฎุฏู ููุงุชูู ูููุตูุชูู:
- **Port 21:** ููุงุฉ ุงูุชุญูู (Control Channel)
- **Port 20:** ููุงุฉ ุงูุจูุงูุงุช (Data Channel)

### ๐ FTP Passive Mode

```
[Client] -----> [Server]
         Port 21 (Control)
         
[Client] <----- [Server]
         Random High Port (Data)
```

**ุขููุฉ ุงูุนูู:**
1. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุชุญูู ูุญู ุงููููุฐ 21
2. ุงูุนููู ูุทูุจ ูุถุน Passive
3. ุงูุฎุงุฏู ูุฑุฏ ุจูููุฐ ุนุดูุงุฆู ุนุงูู
4. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุจูุงูุงุช ูุญู ูุฐุง ุงููููุฐ
5. ูู ุงูุฑุฏูุฏ ุชุญุชูู ุนูู ุจุช ACK โ **ูุณููุญ ุจูุง** โ

### ๐ FTP Active Mode

```
[Client] -----> [Server]
         Port 21 (Control)
         
[Client] <----- [Server]
         Port 20 (Data initiated by server)
```

**ุขููุฉ ุงูุนูู:**
1. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุชุญูู ูุญู ุงููููุฐ 21
2. ุงูุนููู ูุฎุจุฑ ุงูุฎุงุฏู ุจูููุฐ ูุนูู ูุงุณุชูุจุงู ุงูุจูุงูุงุช
3. **ุงูุฎุงุฏู ูุจุฏุฃ ุงุชุตุงู ุงูุจูุงูุงุช** ูู ุงููููุฐ 20
4. ุฃูู ุญุฒูุฉ ูู ุงูุฎุงุฏู ุชุญุชูู ุนูู SYN ููุท โ **ุชูุฑูุถ** ๐ซ

### โ๏ธ ุงููุดููุฉ ูุน Established

```cisco
access-list 110 permit tcp any any established
```

ูุฐู ุงููุงุนุฏุฉ ุชุณูุญ ููุท ุจุงูุญุฒู ุงูุชู ุชุญุชูู ุนูู:
- ุจุช ACK
- ุฃู ุจุช RST

**ุงููุชูุฌุฉ:**
- ูู Active Modeุ ุงูุฎุงุฏู ูุฑุณู SYN ุฃููุงู
- ูุฐู ุงูุญุฒูุฉ ูุง ุชุญูู ุดุฑุท "established"
- ุงูุงุชุตุงู ููุดู ๐ซ

### โ ุงูุญู ุงูุฃูุซู
ุงุณุชุฎุฏุงู ุฌุฏุงุฑ ูุงุฑู ุญูููู (Stateful Firewall) ูุงุฏุฑ ุนูู:
- ุชุชุจุน ุงูุฌูุณุงุช ุงููุดุทุฉ
- ููู ุงูุจุฑูุชููููุงุช ุงููุนูุฏุฉ ูุซู FTP
- ุงูุณูุงุญ ุจุงูุงุชุตุงูุงุช ุงูุฏููุงููููุฉ ุชููุงุฆูุงู

### ๐ ุงูุฎูุงุตุฉ
- `established` ูุง ูููู ููุจุฑูุชููููุงุช ุงููุนูุฏุฉ
- FTP Passive Mode ุฃูุซุฑ ุชูุงููุงู ูุน ุงูุฌุฏุฑุงู ุงููุงุฑูุฉ
- Stateful Firewalls ุถุฑูุฑูุฉ ููุจูุฆุงุช ุงูุฅูุชุงุฌูุฉ

---

## 4. WAF ู Load Balancer

### ๐ฏ ุงููุฏู
ุจูุงุก ุจููุฉ ุชุญุชูุฉ ุขููุฉ ููุงุจูุฉ ููุชูุณุน ููููุน ููุจ.

### ๐ ุงูุณููุงุฑูู
ูููุน ููุจ ูุญุชูู ุนูู ุนุฏุฉ ุฎูุงุฏู Web Servers ุฎูู Load Balancerุ ูุน ุญูุงูุฉ ูู ูุฌูุงุช XSS.

### ๐๏ธ ุงูุจููุฉ ุงููุนูุงุฑูุฉ

```
[Internet]
    |
    โ
[WAF - Web Application Firewall]
    |
    โ
[Load Balancer]
    |
    โ------------------โ------------------โ------------------โ
[Web Server 1]   [Web Server 2]   [Web Server 3]   [Web Server 4]
```

### โ๏ธ ููุงู Load Balancer

**ุฎูุงุฑุฒููุฉ ุงูุชูุฒูุน:**
- **Round Robin:** ุชูุฒูุน ูุชุณุงูู ุนูู ุฌููุน ุงูุฎูุงุฏู
- ุฏูุฑุฉ ููุชุธูุฉ: Server 1 โ Server 2 โ Server 3 โ Server 4 โ ุชูุฑุงุฑ

**ุฅุฏุงุฑุฉ ุงูุฃุนุทุงู:**
1. ูุฑุงูุจุฉ ุตุญุฉ ุงูุฎูุงุฏู (Health Checks)
2. ุนูุฏ ูุดู ุฃุญุฏ ุงูุฎูุงุฏู:
   - ุฅุฒุงูุชู ูู ูุงุฆูุฉ ุงูุชูุฒูุน ุชููุงุฆูุงู
   - ุชุญููู ุทูุจุงุชู ุฅูู ุงูุฎูุงุฏู ุงูุณูููุฉ
3. ุนูุฏ ุนูุฏุฉ ุงูุฎุงุฏู: ุฅุนุงุฏุฉ ุฅุฏุฑุงุฌู ุชููุงุฆูุงู

### ๐ก๏ธ ููุงู WAF (ูู Reverse Proxy)

**ุงูุญูุงูุฉ ูู XSS:**
```javascript
// ูุซุงู ุนูู ูุญุงููุฉ ูุฌูู XSS
<script>alert('XSS Attack')</script>
```

**ุขููุฉ ุงูุญูุงูุฉ:**
1. ูุญุต ูู ุทูุจ HTTP ูุจู ูุตููู ููุฎูุงุฏู
2. ูุดู ุงูุดููุฑุงุช ุงูุฎุจูุซุฉ:
   - JavaScript ูุดุจูู
   - SQL Injection
   - Command Injection
3. ููุน ุงูุทูุจุงุช ุงููุดุจููุฉ ููุฑุงู โ
4. ููุน ุชุณุฑูุจ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุงุณุชุฌุงุจุงุช

### ๐ ุณูุงุณุงุช ุงูุฃูุงู

| ููุน ุงูุญูุงูุฉ | ุงููุธููุฉ |
|-------------|---------|
| XSS Prevention | ููุน ุญูู JavaScript |
| SQL Injection | ุญูุงูุฉ ููุงุนุฏ ุงูุจูุงูุงุช |
| CSRF Protection | ููุน ุงูุทูุจุงุช ุงููุฒูุฑุฉ |
| Rate Limiting | ุงูุญุฏ ูู ูุนุฏู ุงูุทูุจุงุช |
| IP Blacklisting | ุญุธุฑ IP ุงููุดุจููุฉ |

### โ ุงููุฒุงูุง ุงููุญููุฉ

**ุงูุฃุฏุงุก:**
- โก ุชูุฒูุน ุงูุฃุญูุงู ุจุดูู ูุชูุงุฒู
- ๐ ุชุญูู ุงูุฃุนุทุงู (Fault Tolerance)
- ๐ ูุงุจููุฉ ุงูุชูุณุน ุงูุฃููู

**ุงูุฃูุงู:**
- ๐ก๏ธ ุญูุงูุฉ ูุชูุฏูุฉ ูู WAF
- ๐ ูุญุต ุฌููุน ุงูุทูุจุงุช
- ๐ ุชุณุฌูู ุงููุญุงููุงุช ุงููุดุจููุฉ
- ๐ซ ุญุธุฑ ุงููุฌูุงุช ูู ุงูููุช ุงูุญูููู

### ๐ ูุซุงู ุนูู ุณุฌูุงุช WAF

```
2025-10-26 10:15:32 | BLOCKED | XSS Attempt | IP: 192.168.1.100
2025-10-26 10:16:45 | BLOCKED | SQL Injection | IP: 10.0.0.50
2025-10-26 10:17:12 | ALLOWED | Normal Request | IP: 172.16.0.25
```

---

## 5. Cisco Firepower - ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ

### ๐ฏ ุงููุฏู
ููู ููููุฉ ุนูู ุฃูุธูุฉ ูุดู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ ุงููุชูุฏูุฉ ูุชุชุจุน ุงูุชุดุงุฑูุง.

### ๐ ุงูุณููุงุฑูู
ููู ุจุงุณู `tool.exe` ุชู ุงูุชุดุงูู ุถูู ุญุฑูุฉ ุงููุฑูุฑ ุนูู ุงูุดุจูุฉ.

### ๐ ูุฑุงุญู ุงููุดู ูุงูุชุญููู

#### ุงููุฑุญูุฉ 1: ุงููุญุต ุงูุฃููู
1. **ุงุนุชุฑุงุถ ุงูููู:** ุฌูุงุฒ Cisco Firepower ููุญุต ุฌููุน ุงููููุงุช ุงููุงุฑุฉ
2. **ุญุณุงุจ ุงูุจุตูุฉ:** ุงุณุชุฎุฑุงุฌ ุจุตูุฉ SHA-256 ููููู
   ```
   SHA-256: a3f7b8c9d2e1f4a6b5c8d7e9f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0
   ```
3. **ุงูููุงุฑูุฉ:** ููุงุฑูุฉ ุงูุจุตูุฉ ูุน ูุงุนุฏุฉ ุจูุงูุงุช ุงูุชูุฏูุฏุงุช

#### ุงููุฑุญูุฉ 2: ุงูุชุตููู
```
Status: โ๏ธ MALWARE DETECTED
Threat Name: Generic.Trojan.Downloader
Threat Score: 95/100 (High)
Category: Trojan
First Seen: 2025-10-25 14:30:22
```

#### ุงููุฑุญูุฉ 3: ุชุญุฏูุฏ ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ
ุงูุฃุฌูุฒุฉ ุงูุชุงููุฉ ุชู ุชุญุฏูุฏูุง ููุตุงุจุฉ:
- ๐ฅ๏ธ `192.168.10.90`
- ๐ฅ๏ธ `192.168.133.50`

### ๐ Trajectory Map (ุฎุฑูุทุฉ ุงููุณุงุฑ)

```
Time โ
Device 1: --------[*]==========[*]-------
                   โ            โ
Device 2: --------[*]----[*]----[*]------
                         โ      โ
Device 3: ---------------[*]=====[*]-----
```

**ุฑููุฒ ุงูุฎุฑูุทุฉ:**
- `[*]` ููุทุฉ ุงูุชูุงู ุงูููู
- `=` ูุชุฑุฉ ูุดุงุท ุงูููู ุนูู ุงูุฌูุงุฒ
- `โ` ุงุชุฌุงู ุงูุชูุงู ุงูุนุฏูู (ูู ุฌูุงุฒ ูุขุฎุฑ)
- `-` ูุชุฑุฉ ุฎููู

### ๐ ุฌุฏูู ุงูุฃุญุฏุงุซ (Events Table)

| ุงูููุช | ุงูุฌูุงุฒ ุงููุตุฏุฑ | ุงูุฌูุงุฒ ุงููุฏู | ุงูุญุฏุซ | ุงูุญุงูุฉ |
|------|---------------|--------------|--------|--------|
| 14:30:22 | External | 192.168.10.90 | File Download | Infected |
| 14:35:18 | 192.168.10.90 | 192.168.133.50 | File Transfer | Infected |
| 14:42:33 | 192.168.133.50 | Network Share | Propagation Attempt | Blocked |

### ๐ฏ ุงุณุชุฎุฏุงูุงุช Trajectory Map

1. **ุชุญุฏูุฏ ุงููุตุฏุฑ ุงูุฃููู:**
   - ุฃูู ุฌูุงุฒ ุชููู ุงูููู
   - ููุทุฉ ุงูุฏุฎูู ุฅูู ุงูุดุจูุฉ

2. **ุชุชุจุน ูุณุงุฑ ุงูุงูุชุดุงุฑ:**
   - ุงูุฃุฌูุฒุฉ ุงููุณูุทุฉ
   - ุทุฑู ุงูุงูุชูุงู ุงููุณุชุฎุฏูุฉ

3. **ุชูููู ูุทุงู ุงูุฅุตุงุจุฉ:**
   - ุนุฏุฏ ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ
   - ุงูุฃูุณุงู ุงููุชุฃุซุฑุฉ

4. **ุงูุชุฎุทูุท ููุงุณุชุฌุงุจุฉ:**
   - ุฃููููุฉ ุงููุนุงูุฌุฉ
   - ุฎุทุฉ ุงูุนุฒู ูุงูุฅุฒุงูุฉ

### ๐จ ุฎุทุฉ ุงูุงุณุชุฌุงุจุฉ ููุญุงุฏุซ

**ุงูุฎุทูุงุช ุงูููุฑูุฉ:**
1. โ ุนุฒู ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ ุนู ุงูุดุจูุฉ
2. โ ุญุธุฑ ุจุตูุฉ ุงูููู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
3. โ ูุญุต ุดุงูู ููุฃุฌูุฒุฉ ุงููุฌุงูุฑุฉ
4. โ ุชุญููู ุณุฌูุงุช ุงููุดุงุท

**ุงูุฅุฌุฑุงุกุงุช ุงูุชุตุญูุญูุฉ:**
1. ๐ง ุฅุฒุงูุฉ ุงูุจุฑูุฌูุฉ ุงูุฎุจูุซุฉ
2. ๐ง ุชุญุฏูุซ ุชุนุฑููุงุช ููุงูุญ ุงูููุฑูุณุงุช
3. ๐ง ุชุตุญูุญ ุงูุซุบุฑุงุช ุงููุณุชุบูุฉ
4. ๐ง ุงุณุชุนุงุฏุฉ ุงููุธุงู ูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุธููุฉ

**ุงููุชุงุจุนุฉ:**
1. ๐ ุชูุซูู ุงูุญุงุฏุซ
2. ๐ ุชุญุฏูุซ ุงูุณูุงุณุงุช ุงูุฃูููุฉ
3. ๐ ุชุฏุฑูุจ ุงููุณุชุฎุฏููู
4. ๐ ูุฑุงูุจุฉ ูุนุฒุฒุฉ ููุชุฑุฉ

### ๐ก ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ
- ุฃูููุฉ ุงููุญุต ุงูุนููู ูุญุฑูุฉ ุงููุฑูุฑ
- ุถุฑูุฑุฉ ุงูุชุณุฌูู ุงูุดุงูู ููุฃุญุฏุงุซ
- ูููุฉ ุฃุฏูุงุช ุงูุชุญููู ุงูุจุตุฑู
- ุฃูููุฉ ุงูุงุณุชุฌุงุจุฉ ุงูุณุฑูุนุฉ

---

## 6. ARP - ุจุฑูุชูููู ุชุญููู ุงูุนูุงููู

### ๐ฏ ุงููุฏู
ููู ุขููุฉ ุนูู ุจุฑูุชูููู ARP ููุฑุงูุจุฉ ุงูุฌุฏูู ุงูุฎุงุต ุจู.

### ๐ ูุธุฑุฉ ุนุงูุฉ
ARP (Address Resolution Protocol) ูุฑุจุท ุจูู:
- **ุนููุงู IP** (Layer 3)
- **ุนููุงู MAC** (Layer 2)

### ๐ ุงูุชุทุจูู ุงูุนููู

#### ุงูุฎุทูุฉ 1: ุนุฑุถ ุฌุฏูู ARP

**ุนูู Windows:**
```cmd
arp -a
```

**ุนูู Linux/macOS:**
```bash
arp -a
```

#### ุงูุฎุทูุฉ 2: ูุฑุงุกุฉ ุงููุชุงุฆุฌ

```
Interface: 192.168.1.100 --- 0x4
  Internet Address      Physical Address      Type
  192.168.1.1          00-1A-2B-3C-4D-5E     dynamic
  192.168.1.10         00-AA-BB-CC-DD-EE     dynamic
  192.168.1.255        FF-FF-FF-FF-FF-FF     static
  224.0.0.22           01-00-5E-00-00-16     static
```

### ๐ ุชุญููู ุงูุฌุฏูู

| ุงููููู | ุงูุดุฑุญ |
|--------|--------|
| **Internet Address** | ุนููุงู IP ููุฌูุงุฒ |
| **Physical Address** | ุนููุงู MAC ููุฌูุงุฒ |
| **Type** | ููุน ุงูุฅุฏุฎุงู |

### ๐ท๏ธ ุฃููุงุน ุงูุฅุฏุฎุงูุงุช

**Dynamic:**
- ูุชู ุชุนููู ุชููุงุฆูุงู ูู ุญุฑูุฉ ุงููุฑูุฑ
- ููุญุฐู ุจุนุฏ ูุชุฑุฉ ุนุฏู ุงููุดุงุท (ุนุงุฏุฉ 2-10 ุฏูุงุฆู)
- ุงูุฃูุซุฑ ุดููุนุงู ูู ุงูุดุจูุงุช

**Static:**
- ูุชู ุฅุถุงูุชู ูุฏููุงู ุจูุงุณุทุฉ ุงููุฏูุฑ
- ูุง ููุญุฐู ุชููุงุฆูุงู
- ููุณุชุฎุฏู ููุฃุฌูุฒุฉ ุงูุญุณุงุณุฉ

### ๐ ุนูุงููู ุฎุงุตุฉ

**Broadcast:**
```
192.168.1.255 โ FF-FF-FF-FF-FF-FF
```
- ููุฑุณู ูุฌููุน ุงูุฃุฌูุฒุฉ ูู ุงูุดุจูุฉ

**Multicast:**
```
224.0.0.22 โ 01-00-5E-00-00-16
```
- ููุฑุณู ููุฌููุนุฉ ูุญุฏุฏุฉ ูู ุงูุฃุฌูุฒุฉ

### ๐งน ูุณุญ ุงููุงุด

**ูุณุญ ุฌููุน ุงูุฅุฏุฎุงูุงุช (Windows):**
```cmd
arp -d *
```

**ูุณุญ ุฅุฏุฎุงู ูุญุฏุฏ:**
```cmd
arp -d 192.168.1.10
```

**ุนูู Linux:**
```bash
sudo ip -s -s neigh flush all
```

### ๐ ุฅุถุงูุฉ ุฅุฏุฎุงู ุซุงุจุช

**Windows:**
```cmd
arp -s 192.168.1.50 00-11-22-33-44-55
```

**Linux:**
```bash
sudo arp -s 192.168.1.50 00:11:22:33:44:55
```

### ๐ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

**1. ุชุดุฎูุต ูุดุงูู ุงูุงุชุตุงู:**
```bash
# ูุญุต ูุฌูุฏ ุงูุฌูุงุฒ ูู ุงูุฌุฏูู
arp -a | grep 192.168.1.10

# ุฅุฐุง ูู ูุธูุฑุ ุงููุดููุฉ ูุฏ ุชููู ูู Layer 2
```

**2. ูุดู ุชุถุงุฑุจ IP:**
```bash
# ุฅุฐุง ุธูุฑ ููุณ IP ุจุนููุงูู MAC ูุฎุชูููู
192.168.1.50    00-AA-BB-CC-DD-EE
192.168.1.50    00-11-22-33-44-55  # โ๏ธ ุชุถุงุฑุจ!
```

**3. ูุฑุงูุจุฉ ุงูุฃุฌูุฒุฉ ุงููุดุทุฉ:**
```bash
# ุนุฏ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ
arp -a | grep dynamic | wc -l
```

### โ๏ธ ููุงุญุธุงุช ุฃูููุฉ

**ARP Spoofing/Poisoning:**
- ููุงุฌู ูุฑุณู ุฑุณุงุฆู ARP ูุฒููุฉ
- ูุฎุฏุน ุงูุฃุฌูุฒุฉ ูุฅุฑุณุงู ุงูุจูุงูุงุช ูู
- **ุงูุญูุงูุฉ:** ARP Inspection ุนูู ุงูุณููุชุดุงุช

**ุงูููุงูุฉ:**
```cisco
# ุชูุนูู Dynamic ARP Inspection
Switch(config)# ip arp inspection vlan 10
Switch(config)# interface gi0/1
Switch(config-if)# ip arp inspection trust
```

### ๐ก ูุตุงุฆุญ ุนูููุฉ
- ุฑุงูุจ ุฌุฏูู ARP ุจุดูู ุฏูุฑู
- ุงูุชุจู ููุชุบููุฑุงุช ุงูููุงุฌุฆุฉ ูู ุนูุงููู MAC
- ุงุณุชุฎุฏู ุฅุฏุฎุงูุงุช ุซุงุจุชุฉ ููุฃุฌูุฒุฉ ุงูุญุณุงุณุฉ
- ูุนูู ARP Inspection ูู ุงูุจูุฆุงุช ุงูุญุณุงุณุฉ

---

## 7. Nmap - ูุณุญ ุงูุดุจูุงุช

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู Nmap ูุงูุชุดุงู ุงูุฃุฌูุฒุฉ ูุงูุฎุฏูุงุช ุงููุดุทุฉ ุนูู ุงูุดุจูุฉ.

### ๐ ุงููุชุทูุจุงุช
- ูุธุงู Linux (ููุถู Kali Linux)
- ุตูุงุญูุงุช root ูููุณุญ ุงููุชูุฏู
- **ุจูุฆุฉ ุงุฎุชุจุงุฑูุฉ ููุท** โ๏ธ

### ๐ ุฃููุงุน ุงููุณุญ

#### 1. ุงูุชุดุงู ุงูุฃุฌูุฒุฉ ุงููุดุทุฉ (Host Discovery)

```bash
nmap -sn 192.168.1.0/24
```

**ุงูุดุฑุญ:**
- `-sn`: Ping Scan (ุจุฏูู ูุญุต ุงูููุงูุฐ)
- ูุณุชุฎุฏู ICMP Echo Request
- ููุธูุฑ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ ูุงููุดุทุฉ

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
Starting Nmap 7.94
Nmap scan report for 192.168.1.1
Host is up (0.0012s latency).

Nmap scan report for 192.168.1.50
Host is up (0.0034s latency).

Nmap scan report for 192.168.1.100
Host is up (0.0028s latency).

Nmap done: 256 IP addresses (3 hosts up) scanned in 2.85 seconds
```

#### 2. ูุญุต ุงูููุงูุฐ (Port Scanning)

**Basic TCP Scan:**
```bash
nmap 192.168.1.50
```

**Comprehensive Scan:**
```bash
nmap -sS -sV -O 192.168.1.50
```

**ุงูุดุฑุญ:**
- `-sS`: SYN Stealth Scan (ุฃูู ูุงุจููุฉ ูููุดู)
- `-sV`: ูุดู ุฅุตุฏุงุฑุงุช ุงูุฎุฏูุงุช
- `-O`: ุชุฎููู ูุธุงู ุงูุชุดุบูู

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PORT     STATE SERVICE    VERSION
21/tcp   open  ftp        vsftpd 3.0.3
22/tcp   open  ssh        OpenSSH 8.2p1
80/tcp   open  http       Apache httpd 2.4.41
443/tcp  open  ssl/http   Apache httpd 2.4.41
3306/tcp open  mysql      MySQL 5.7.33

OS details: Linux 3.2 - 4.9
```

#### 3. ูุญุต ุฌููุน ุงูููุงูุฐ

```bash
nmap -p- 192.168.1.50
```

- `-p-`: ูุญุต ุฌููุน ุงูููุงูุฐ (1-65535)
- ูุณุชุบุฑู ููุชุงู ุฃุทูู

#### 4. ูุญุต ููุงูุฐ ูุญุฏุฏุฉ

```bash
nmap -p 21,22,80,443,3306 192.168.1.50
```

### ๐ญ ุฃููุงุน ูุณุญ ุงูููุงูุฐ

#### TCP SYN Scan (ุงูุฃูุซุฑ ุดููุนุงู)
```bash
nmap -sS 192.168.1.50
```
- ูุฑุณู SYN ููุท
- ูุง ููููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ุฃูู ูุงุจููุฉ ูููุดู

#### TCP Connect Scan
```bash
nmap -sT 192.168.1.50
```
- ููููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ูุง ูุญุชุงุฌ ุตูุงุญูุงุช root
- ุฃูุซุฑ ูุงุจููุฉ ูููุดู

#### UDP Scan
```bash
nmap -sU 192.168.1.50
```
- ูุญุต ููุงูุฐ UDP
- ุจุทูุก ุฌุฏุงู
- ููู ูุฎุฏูุงุช ูุซู DNS, DHCP

### ๐ฌ ูุญุต ุงูุซุบุฑุงุช

```bash
nmap --script vuln 192.168.1.50
```

ูุณุชุฎุฏู NSE (Nmap Scripting Engine) ููุจุญุซ ุนู ุซุบุฑุงุช ูุนุฑููุฉ.

### ๐ ุชูููู ุงููุฎุงุทุฑ

#### ููุงูุฐ ุนุงููุฉ ุงูุฎุทูุฑุฉ:

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุงูุฎุทุฑ |
|--------|---------|-------|
| 21 | FTP | ููู ุจูุงูุงุช ุจุฏูู ุชุดููุฑ |
| 23 | Telnet | ุฅุฏุงุฑุฉ ุนู ุจุนุฏ ุจุฏูู ุชุดููุฑ |
| 445 | SMB | ุนุฑุถุฉ ููุฌูุงุช WannaCry ูุบูุฑูุง |
| 3389 | RDP | ูุฏู ุดุงุฆุน ูููุฌูุงุช |
| 1433 | MSSQL | ูุงุนุฏุฉ ุจูุงูุงุช ูุฏ ุชููู ุนุฑุถุฉ |

### ๐ก๏ธ ุงูุญูุงูุฉ ูู Nmap

**1. ุนูู ูุณุชูู ุงูุฌุฏุงุฑ ุงููุงุฑู:**
```cisco
# ุฑูุถ ุงููุณุญ ูู ูุตุงุฏุฑ ุฎุงุฑุฌูุฉ
access-list 100 deny tcp any any range 1 1024
```

**2. ุนูู ูุณุชูู ุงูุฎุงุฏู:**
```bash
# ุงุณุชุฎุฏุงู iptables ูููุน ุงููุณุญ
iptables -A INPUT -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT
```

**3. ุฃุฏูุงุช ูุดู ุงููุณุญ:**
```bash
# ุชุซุจูุช portsentry
sudo apt install portsentry

# ูุฑุงูุจุฉ ูุญุงููุงุช ุงููุณุญ
tail -f /var/log/syslog | grep portsentry
```

### ๐ก ูุตุงุฆุญ ููุงุณุชุฎุฏุงู ุงูุขูู
- โ๏ธ **ูุง ุชูู ุจูุณุญ ุดุจูุงุช ูุง ุชููููุง**
- ๐ ุงุญุตู ุนูู ุฅุฐู ุฎุทู ูุจู ุฃู ุงุฎุชุจุงุฑ ุงุฎุชุฑุงู
- ๐ ุงุณุชุฎุฏู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ููุชุฏุฑูุจ
- ๐ ูุซูู ุฌููุน ุนูููุงุช ุงููุณุญ ููุชุงุฆุฌูุง

### ๐ ุฃูุซูุฉ ุชุนููููุฉ ุฅุถุงููุฉ

**ูุณุญ ุณุฑูุน ูุฃูู 100 ูููุฐ:**
```bash
nmap --top-ports 100 192.168.1.50
```

**ูุณุญ ูุน ุชุฌูุจ ุงููุดู:**
```bash
nmap -sS -T2 -f 192.168.1.50
```
- `-T2`: ุณุฑุนุฉ ุจุทูุฆุฉ (ุฃูู ุฅุฒุนุงุฌุงู)
- `-f`: ุชุฌุฒุฆุฉ ุงูุญุฒู

**ุญูุธ ุงููุชุงุฆุฌ:**
```bash
nmap -oN results.txt 192.168.1.50
nmap -oX results.xml 192.168.1.50
```

---

## 8. ICMP - ุงุฎุชุจุงุฑุงุช ุงูุดุจูุฉ

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู ุฃุฏูุงุช ICMP ูุชุดุฎูุต ูุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจุงูุดุจูุฉ.

### ๐ ุจุฑูุชูููู ICMP
Internet Control Message Protocol - ุจุฑูุชูููู ุฑุณุงุฆู ุงูุชุญูู ูู ุงูุฅูุชุฑูุช
- Layer 3 Protocol
- ููุณุชุฎุฏู ููุชุดุฎูุต ูุฅุจูุงุบ ุงูุฃุฎุทุงุก
- ูุง ูุญูู ุจูุงูุงุช ุงููุณุชุฎุฏู

### ๐ ุงูุฃูุงูุฑ ุงูุฃุณุงุณูุฉ

#### 1. Ping - ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

**ุงูุงุณุชุฎุฏุงู ุงูุจุณูุท:**
```bash
ping 8.8.8.8
```

**ูุน ุฎูุงุฑุงุช ูุชูุฏูุฉ:**
```bash
# ุฅุฑุณุงู 10 ุญุฒู ููุท
ping -c 10 8.8.8.8

# ุชุบููุฑ ุญุฌู ุงูุญุฒูุฉ
ping -s 1000 8.8.8.8

# ุชุญุฏูุฏ ุงูููุช ุจูู ุงูุญุฒู (ุซุงููุฉ ูุงุญุฏุฉ)
ping -i 1 8.8.8.8
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=116 time=12.4 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=116 time=11.8 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=116 time=12.1 ms

--- 8.8.8.8 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2003ms
rtt min/avg/max/mdev = 11.8/12.1/12.4/0.3 ms
```

#### 2. Traceroute - ุชุชุจุน ุงููุณุงุฑ

**ุนูู Linux:**
```bash
traceroute 8.8.8.8
```

**ุนูู Windows:**
```cmd
tracert 8.8.8.8
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  192.168.1.1 (192.168.1.1)  1.245 ms  1.123 ms  1.089 ms
 2  10.0.0.1 (10.0.0.1)  8.456 ms  8.234 ms  8.123 ms
 3  172.16.0.1 (172.16.0.1)  15.678 ms  15.456 ms  15.234 ms
 4  * * *
 5  8.8.8.8 (8.8.8.8)  22.345 ms  22.123 ms  21.987 ms
```

**ุงูุชุญููู:**
- ูู ุณุทุฑ ููุซู ููุฌูู (router) ูู ุงููุณุงุฑ
- ุงูุฃุฑูุงู ุงูุซูุงุซุฉ: ุฒูู ุงูุงุณุชุฌุงุจุฉ ูููุญุงููุงุช ุงูุซูุงุซ
- `* * *`: ุงูููุฌูู ูุง ูุณุชุฌูุจ ูุทูุจุงุช ICMP

#### 3. MTR - ุชุชุจุน ูุชูุฏู

```bash
mtr 8.8.8.8
```

ูุฌูุน ุจูู ping ู traceroute ูุน ุฅุญุตุงุฆูุงุช ูุณุชูุฑุฉ:
```
                             Packets               Pings
 Host                      Loss%   Snt   Last   Avg  Best  Wrst StDev
 1. 192.168.1.1             0.0%    10    1.2   1.3   1.1   1.5   0.1
 2. 10.0.0.1                0.0%    10    8.4   8.5   8.1   9.2   0.3
 3. 8.8.8.8                 0.0%    10   22.1  22.3  21.8  23.1   0.4
```

### ๐ ุฃููุงุน ุฑุณุงุฆู ICMP

| ุงูููุน | ุงูุงุณู | ุงูุงุณุชุฎุฏุงู |
|-------|-------|-----------|
| Type 0 | Echo Reply | ุฑุฏ ุนูู Ping |
| Type 3 | Destination Unreachable | ุงููุฌูุฉ ุบูุฑ ูุชุงุญุฉ |
| Type 5 | Redirect | ุฅุนุงุฏุฉ ุชูุฌูู ุงููุณุงุฑ |
| Type 8 | Echo Request | ุทูุจ Ping |
| Type 11 | Time Exceeded | ุงูุชูุงุก TTL (ูุณุชุฎุฏูู traceroute) |

### โ๏ธ ุงุฎุชุจุงุฑุงุช ูุชูุฏูุฉ (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ููุท)

#### ICMP Flood Test

```bash
# โ๏ธ ููุงุฎุชุจุงุฑ ูู ุจูุฆุฉ ูุนุฒููุฉ ููุท
sudo ping -f -s 65500 TARGET_IP
```

**ุงูุดุฑุญ:**
- `-f`: Flood mode (ุฅุฑุณุงู ุณุฑูุน ุฌุฏุงู)
- `-s 65500`: ุญุฌู ุงูุญุฒูุฉ (ุฃูุตู ุญุฏ)
- **ููุณุชุฎุฏู ูุงุฎุชุจุงุฑ ุชุญูู ุงูุดุจูุฉ**

**ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
```
PING target (192.168.1.50) 65500(65528) bytes of data.
..................................
--- target ping statistics ---
10000 packets transmitted, 9856 received, 1.44% packet loss
```

#### Ping of Death (ุชุงุฑูุฎู)

```bash
# โ๏ธ ูุง ูุนูู ุนูู ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ
ping -s 65510 TARGET_IP
```

**ุงูุฎูููุฉ:**
- ูุงู ููุณุจุจ ุชุนุทู ุงูุฃูุธูุฉ ุงููุฏููุฉ
- ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ ูุญููุฉ ุถุฏู

### ๐ก๏ธ ุงูุญูุงูุฉ ูู ูุฌูุงุช ICMP

#### 1. ุชุญุฏูุฏ ูุนุฏู ICMP

**ุนูู Linux:**
```bash
# ุชุญุฏูุฏ ุนุฏุฏ ุญุฒู ICMP ูู ุงูุซุงููุฉ
iptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT
iptables -A INPUT -p icmp --icmp-type echo-request -j DROP
```

#### 2. ุนูู Cisco Router

```cisco
# ุชุญุฏูุฏ ูุนุฏู ICMP
access-list 100 permit icmp any any echo-reply
access-list 100 deny icmp any any echo-request
interface gi0/0
ip access-group 100 in
rate-limit input access-group 100 1000000 250000 500000 conform-action transmit exceed-action drop
```

#### 3. ุญุธุฑ ICMP ููุงุฆูุงู (ุบูุฑ ูุณุชุญุณู)

```bash
# ููููุฏ ุงููุฏุฑุฉ ุนูู ุงูุชุดุฎูุต
iptables -A INPUT -p icmp -j DROP
```

### ๐ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงูุนูููุฉ

**1. ุชุดุฎูุต ุงููุทุงุน ุงูุงุชุตุงู:**
```bash
# ุฎุทูุฉ ุจุฎุทูุฉ
ping 192.168.1.1  # ุงูุจูุงุจุฉ ุงููุญููุฉ
ping 8.8.8.8      # ุฎุงุฏู ุฎุงุฑุฌู
traceroute 8.8.8.8  # ุชุญุฏูุฏ ููุทุฉ ุงูุงููุทุงุน
```

**2. ููุงุณ ุฌูุฏุฉ ุงูุงุชุตุงู:**
```bash
# ูุฑุงูุจุฉ ููุฏุฉ 5 ุฏูุงุฆู
ping -c 300 -i 1 8.8.8.8 | tee ping_results.txt

# ุชุญููู ุงููุชุงุฆุฌ
grep "time=" ping_results.txt | awk '{print $7}' | sed 's/time=//' | sort -n
```

**3. ุงุฎุชุจุงุฑ MTU (Maximum Transmission Unit):**
```bash
# ุงุจุฏุฃ ุจุญุฌู ูุจูุฑ ููููู ุชุฏุฑูุฌูุงู
ping -M do -s 1472 8.8.8.8

# ุฅุฐุง ูุดูุ ููู ุงูุญุฌู ุญุชู ููุฌุญ
ping -M do -s 1400 8.8.8.8
```

### ๐ก ูุตุงุฆุญ ูููุฉ
- ICMP ููุณ ุขููุงู 100% - ูููู ุงุณุชุฎุฏุงูู ูู ุงููุฌูุงุช
- ุจุนุถ ุงูุดุจูุงุช ุชุญุธุฑ ICMP ููุฃูุงู
- ุงุณุชุฎุฏู ุฃุฏูุงุช ุจุฏููุฉ (TCP ping) ุนูุฏ ุงูุญุงุฌุฉ
- ูุง ุชุนุชูุฏ ุนูู ICMP ููุท ูููุฑุงูุจุฉ

---

## 9. SYN Flooding Attack

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุฉ ูุฌูู SYN Flood ูุชุฃุซูุฑู ุนูู ุงูุฎูุงุฏู.

### โ๏ธ ุชุญุฐูุฑ ููู ุฌุฏุงู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ๏ธ  ูุฐุง ุงููุญุชูู ูุฃุบุฑุงุถ ุชุนููููุฉ ููุท  โ๏ธ       โ
โ                                                  โ
โ  ุชูููุฐ ูุฐุง ุงููุฌูู ุนูู ุฃูุธูุฉ ุญููููุฉ:           โ
โ  โข ุฌุฑููุฉ ูุนุงูุจ ุนูููุง ุงููุงููู                   โ
โ  โข ูุชุทูุจ ุฅุฐู ุฎุทู ูุณุจู                          โ
โ  โข ููุณูุญ ููุท ูู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุฌูู

#### ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ ุงูุทุจูุนูุฉ (TCP Three-Way Handshake)

```
Client                    Server
  |                         |
  |-------- SYN ---------->|  [1]
  |<----- SYN-ACK ---------|  [2]
  |-------- ACK ---------->|  [3]
  |                         |
  |==== Connection Open ====|
```

#### ูุฌูู SYN Flood

```
Attacker                  Server
  |                         |
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |      (thousands)        |
  |                         |
  |   โ No ACK Sent โ    |
  |                         |
  |                    [Server]
  |                   SYN Queue
  |                   โโโโโโโโโโโ
  |                   โ SYN #1  โ โณ
  |                   โ SYN #2  โ โณ
  |                   โ SYN #3  โ โณ
  |                   โ SYN #... โ โณ
  |                   โ FULL!   โ ๐ด
  |                   โโโโโโโโโโโ
```

### ๐ฌ ุงูุชุทุจูู ุงูุนููู (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ููุท)

#### ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุขูุฉ ุงูุชุฑุงุถูุฉ ููููุงุฌู (Kali Linux)
- ุฎุงุฏู ุงุฎุชุจุงุฑ ูุนุฒูู
- ุดุจูุฉ ูุญููุฉ ููุนุฒูุฉ ุชูุงูุงู

#### ุงูุฃุฏุงุฉ: hping3

**ุงูุชุซุจูุช:**
```bash
sudo apt update
sudo apt install hping3
```

**ุงููุฌูู ุงูุฃุณุงุณู:**
```bash
sudo hping3 -S -p 80 --flood TARGET_IP
```

**ุงูุดุฑุญ:**
- `-S`: ุฅุฑุณุงู ุญุฒู SYN ููุท
- `-p 80`: ุงุณุชูุฏุงู ุงููููุฐ 80 (HTTP)
- `--flood`: ุฅุฑุณุงู ุฃุณุฑุน ูุง ูููู (ุจุฏูู ุงูุชุธุงุฑ)
- `TARGET_IP`: ุนููุงู ุงูุฎุงุฏู ุงููุณุชูุฏู

**ูุฌูู ูุชูุฏู ูุน ุนูุงููู ูุฒููุฉ:**
```bash
sudo hping3 -S -p 80 --flood --rand-source TARGET_IP
```

- `--rand-source`: ุนูุงููู IP ูุตุฏุฑ ุนุดูุงุฆูุฉ
- ููุตุนูุจ ุชุชุจุน ุงูููุงุฌู
- ูุชุฌุงูุฒ ุจุนุถ ุขููุงุช ุงูุญูุงูุฉ ุงูุจุณูุทุฉ

### ๐ ุงููุฑุงูุจุฉ ุนูู ุงูุฎุงุฏู ุงููุณุชูุฏู

#### ุนุฑุถ ุงูุงุชุตุงูุงุช ูุตู ุงูููุชูุญุฉ

```bash
netstat -ant | grep SYN_RECV
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ ุฃุซูุงุก ุงููุฌูู:**
```
tcp    0    0 192.168.1.50:80    10.0.0.100:45123    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.101:45124    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.102:45125    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.103:45126    SYN_RECV
... (ูุฆุงุช ุฃู ุขูุงู ุงูุณุทูุฑ)
```

#### ูุฑุงูุจุฉ ุงุณุชููุงู ุงูููุงุฑุฏ

```bash
# ุนุฑุถ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
ss -tan | grep SYN-RECV | wc -l

# ูุฑุงูุจุฉ ุงูุฐุงูุฑุฉ
free -h

# ูุฑุงูุจุฉ CPU
top
```

**ูุคุดุฑุงุช ุงููุฌูู:**
```
SYN-RECV connections: 5000+  ๐ด (ุทุจูุนู: < 100)
Memory usage: 95%             ๐ด (ุทุจูุนู: < 70%)
CPU load: 100%                ๐ด (ุทุจูุนู: < 50%)
```

### ๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ

#### 1. SYN Cookies

**ุชูุนูู SYN Cookies ุนูู Linux:**
```bash
# ุงูุชุญูู ูู ุงูุญุงูุฉ ุงูุญุงููุฉ
cat /proc/sys/net/ipv4/tcp_syncookies

# ุงูุชูุนูู (1 = enabled)
sudo sysctl -w net.ipv4.tcp_syncookies=1

# ุฌุนูู ุฏุงุฆูุงู
echo "net.ipv4.tcp_syncookies = 1" | sudo tee -a /etc/sysctl.conf
```

**ููู ุชุนูู:**
```
ุจุฏูุงู ูู ุชุฎุฒูู ุงูุงุชุตุงู ูู ุงูุฐุงูุฑุฉ:
1. ุงูุฎุงุฏู ูุญุณุจ ูููุฉ ูุดูุฑุฉ (cookie)
2. ููุฑุณููุง ูู SYN-ACK
3. ูุง ูุญูุธ ุดูุก ูู ุงูุฐุงูุฑุฉ
4. ุนูุฏ ุงุณุชูุงู ACKุ ูุชุญูู ูู ุงูู cookie
5. ุฅู ุตุญุ ููููู ุงูุงุชุตุงู

ุงููุชูุฌุฉ: ูุง ุงุณุชูุฒุงู ููุฐุงูุฑุฉ โ
```

#### 2. ุชุญุฏูุฏ ูุนุฏู ุงูุงุชุตุงูุงุช ุงูุฌุฏูุฏุฉ

**ุจุงุณุชุฎุฏุงู iptables:**
```bash
# ุงูุณูุงุญ ุจู 5 ุงุชุตุงูุงุช ุฌุฏูุฏุฉ ููุท ูู ุงูุซุงููุฉ ูู ููุณ IP
iptables -A INPUT -p tcp --syn -m limit --limit 5/s --limit-burst 10 -j ACCEPT
iptables -A INPUT -p tcp --syn -j DROP
```

**ุจุงุณุชุฎุฏุงู nftables:**
```bash
nft add rule ip filter input tcp flags syn ct state new limit rate 5/second accept
```

#### 3. ุฒูุงุฏุฉ ุญุฌู ูุงุฆูุฉ SYN

```bash
# ุฒูุงุฏุฉ ุงูุญุฏ ุงูุฃูุตู ููุงุชุตุงูุงุช ูุตู ุงูููุชูุญุฉ
sudo sysctl -w net.ipv4.tcp_max_syn_backlog=4096

# ุชูููู ููุช ุงูุงูุชุธุงุฑ
sudo sysctl -w net.ipv4.tcp_synack_retries=2
```

#### 4. ุงุณุชุฎุฏุงู Firewall ูุชูุฏู

**Cisco ASA:**
```cisco
! ุชุญุฏูุฏ ุนุฏุฏ ุงูุงุชุตุงูุงุช ุงููุชุฒุงููุฉ
access-list OUTSIDE_IN extended permit tcp any host 203.0.113.50 eq www
class-map SYN-ATTACK
 match access-list OUTSIDE_IN
policy-map OUTSIDE_POLICY
 class SYN-ATTACK
  set connection conn-max 100 embryonic-conn-max 50
service-policy OUTSIDE_POLICY interface outside
```

**pfSense/OPNsense:**
- ุชูุนูู "SYN Proxy"
- ุถุจุท "Maximum States" ู "Maximum Source Nodes"

#### 5. ุงุณุชุฎุฏุงู CDN/DDoS Protection

ุฎุฏูุงุช ูุซู:
- Cloudflare
- AWS Shield
- Akamai

ุชููู ุจู:
- ุงูุชุตุงุต ุงููุฌูุงุช ุงูุถุฎูุฉ
- ุชูุฒูุน ุงูุญูู
- ููุชุฑุฉ ุงูุญุฑูุฉ ุงูุฎุจูุซุฉ

### ๐ ุงูุชุฃุซูุฑ ุนูู ุงูุฎุงุฏู

#### ูุฑุงุญู ุงููุฌูู

**ุงููุฑุญูุฉ 1: ุงูุจุฏุงูุฉ (0-30 ุซุงููุฉ)**
```
SYN Queue: 20% full
Response Time: 100ms โ 500ms
```

**ุงููุฑุญูุฉ 2: ุงูุชุตุนูุฏ (30-60 ุซุงููุฉ)**
```
SYN Queue: 80% full
Response Time: 500ms โ 3000ms
New connections: ุจุทูุฆุฉ ุฌุฏุงู
```

**ุงููุฑุญูุฉ 3: ุงูุงูููุงุฑ (60+ ุซุงููุฉ)**
```
SYN Queue: 100% full
Response Time: timeout
New connections: ูุฑููุถุฉ ุจุงููุงูู
Service: ุบูุฑ ูุชุงุญ ๐ด
```

### ๐ ูุดู ุงููุฌูู

#### ุนูุงูุงุช ุงูุชุญุฐูุฑ

```bash
# ุงุฑุชูุงุน ููุงุฌุฆ ูู SYN_RECV
watch -n 1 'netstat -ant | grep SYN_RECV | wc -l'

# ุชูุจูู ุนูุฏ ุชุฌุงูุฒ ุญุฏ ูุนูู
while true; do
  COUNT=$(netstat -ant | grep SYN_RECV | wc -l)
  if [ $COUNT -gt 1000 ]; then
    echo "โ๏ธ Possible SYN Flood: $COUNT connections"
  fi
  sleep 5
done
```

#### ุชุญููู ุงูุณุฌูุงุช

```bash
# ุนุฑุถ ุฃูุซุฑ IP ูุตุฏุฑูุฉ ูุดุงุทุงู
netstat -ant | grep SYN_RECV | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -nr | head -10
```

### ๐ก ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ

**ูููุฏุงูุนูู:**
1. โ ูุนูู SYN Cookies ุฏุงุฆูุงู
2. โ ุฑุงูุจ ูุนุฏูุงุช ุงูุงุชุตุงู ุจุดูู ูุณุชูุฑ
3. โ ุงุณุชุฎุฏู Firewall ูุน ุฅููุงููุงุช DDoS protection
4. โ ุงุญุชูุธ ุจุฎุทุฉ ุงุณุชุฌุงุจุฉ ุฌุงูุฒุฉ

**ููููุงุฌููู ุงูุฃุฎูุงูููู:**
1. ๐ ุงุญุตู ุนูู ุฅุฐู ุฎุทู ูุจู ุงูุงุฎุชุจุงุฑ
2. ๐ ุงุณุชุฎุฏู ุจูุฆุฉ ูุนุฒููุฉ ุชูุงูุงู
3. โฐ ุญุฏุฏ ูุงูุฐุฉ ุฒูููุฉ ูุญุฏูุฏุฉ ููุงุฎุชุจุงุฑ
4. ๐ ูุซูู ุงููุชุงุฆุฌ ุจุดูู ุงุญุชุฑุงูู

---

## 10. UDP Flood Attack

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุฉ ูุฌูู UDP Flood ูุงููุฑู ุจููู ูุจูู SYN Flood.

### โ๏ธ ุชุญุฐูุฑ ูุงูููู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐จ ูุฐุง ุงููุญุชูู ููุชุนููู ูุงูุฃุจุญุงุซ ุงูุฃูููุฉ ููุท  โ
โ                                                   โ
โ  ุงูููุงู ุจูุฐุง ุงููุฌูู ุฏูู ุฅุฐู ูู:                โ
โ  โข ุฌุฑููุฉ ุฅููุชุฑูููุฉ                              โ
โ  โข ููุนุงูุจ ุนูููุง ุจุงูุณุฌู ูุงูุบุฑุงูุฉ                โ
โ  โข ููุณูุญ ููุท ูู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูููููุฉ ูู         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ุงููุฑู ุจูู TCP ู UDP

| ุงูููุฒุฉ | TCP | UDP |
|--------|-----|-----|
| ุงูุงุชุตุงู | Connection-oriented | Connectionless |
| ุงููุตุงูุญุฉ | ูุนู (3-way handshake) | ูุง |
| ุงูููุซูููุฉ | ูุถููู ุงููุตูู | ุบูุฑ ูุถููู |
| ุงูุณุฑุนุฉ | ุฃุจุทุฃ | ุฃุณุฑุน |
| ุงูุชุฑุชูุจ | ูุฑุชุจ | ุบูุฑ ูุฑุชุจ |

### ๐ฌ ุขููุฉ ูุฌูู UDP Flood

```
Attacker                    Target Server
  |                              |
  |------- UDP Packet ---------->| Port 53 (DNS)
  |------- UDP Packet ---------->| Port 161 (SNMP)
  |------- UDP Packet ---------->| Port 12345 (Random)
  |------- UDP Packet ---------->| Port 9999 (Closed)
  |       (thousands/sec)        |
  |                              |
  |                         [Server Process]
  |                         1. ุชููู ุงูุญุฒูุฉ
  |                         2. ูุญุต ุงููููุฐ
  |                         3. ุงููููุฐ ูุบููุ
  |                         4. ุฅุฑุณุงู ICMP Port Unreachable
  |                              |
  |<---- ICMP Unreachable -------|
  |<---- ICMP Unreachable -------|
  |<---- ICMP Unreachable -------|
  |                              |
  |                    [Result: Resource Exhaustion]
  |                    โข CPU: 100%
  |                    โข Bandwidth: Saturated
  |                    โข Service: Unavailable
```

### ๐ฌ ุงูุชุทุจูู ุงูุนููู (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ููุท)

#### ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุดุจูุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ุชูุงูุงู
- ุฎุงุฏู ุงุฎุชุจุงุฑ ูุฎุตุต
- ุฅุฐู ุฎุทู ููุซู

#### ุงุณุชุฎุฏุงู hping3

**ุงููุฌูู ุงูุฃุณุงุณู:**
```bash
sudo hping3 --udp -p 53 --flood TARGET_IP
```

**ุงูุดุฑุญ:**
- `--udp`: ุงุณุชุฎุฏุงู ุจุฑูุชูููู UDP
- `-p 53`: ุงุณุชูุฏุงู ูููุฐ DNS
- `--flood`: ุฅุฑุณุงู ุจุฃูุตู ุณุฑุนุฉ ููููุฉ

**ูุฌูู ูุน ููุงูุฐ ุนุดูุงุฆูุฉ:**
```bash
sudo hping3 --udp --rand-dest --flood TARGET_IP
```

- `--rand-dest`: ููุงูุฐ ูุฌูุฉ ุนุดูุงุฆูุฉ
- ููุถุนู ุงูุฎุงุฏู ุฃูุซุฑ (ููุญุต ูู ูููุฐ)

**ูุฌูู ูุน ุญุฌู ุญุฒูุฉ ูุจูุฑ:**
```bash
sudo hping3 --udp -p 53 --flood -d 65500 TARGET_IP
```

- `-d 65500`: ุญุฌู ุงูุจูุงูุงุช (ุฃูุตู ุญุฏ ูู UDP)
- ูุณุชููู bandwidth ุฃูุซุฑ

### ๐ ุงููุฑุงูุจุฉ ุนูู ุงูุฎุงุฏู ุงููุณุชูุฏู

#### ุนุฑุถ ุฅุญุตุงุฆูุงุช UDP

```bash
netstat -s | grep UDP
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ ุฃุซูุงุก ุงููุฌูู:**
```
UDP:
    125847 packets received
    98234 packets to unknown port received
    89123 packet receive errors
    45678 packets sent
    RcvbufErrors: 12345
    SndbufErrors: 0
    InErrors: 89123
```

#### ูุฑุงูุจุฉ ุงูุญุฒู ูู ุงูููุช ุงููุนูู

```bash
# ุนุฑุถ ูุนุฏู ุญุฒู UDP
watch -n 1 'netstat -su | grep "packets received"'

# ูุฑุงูุจุฉ ููุงูุฐ ูุญุฏุฏุฉ
tcpdump -i eth0 udp port 53 -nn
```

**ูุคุดุฑุงุช ุงููุฌูู:**
```
UDP packets/sec: 50,000+     ๐ด (ุทุจูุนู: < 1,000)
Port Unreachable: 40,000+    ๐ด (ุทุจูุนู: < 10)
Bandwidth usage: 90%+        ๐ด (ุทุจูุนู: < 50%)
CPU usage: 100%              ๐ด (ุทุจูุนู: < 30%)
```

#### ุชุญุฏูุฏ ุฃูุซุฑ ุงูููุงูุฐ ุงููุณุชูุฏูุฉ

```bash
tcpdump -i eth0 -nn udp -c 1000 | awk '{print $5}' | cut -d'.' -f5 | sort | uniq -c | sort -nr | head -10
```

### ๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ

#### 1. Rate Limiting ุนูู Linux

```bash
# ุชุญุฏูุฏ ูุนุฏู ุญุฒู UDP ูู ูู IP
iptables -A INPUT -p udp -m limit --limit 100/s --limit-burst 200 -j ACCEPT
iptables -A INPUT -p udp -j DROP

# ุญูุงูุฉ ููุงูุฐ ูุญุฏุฏุฉ
iptables -A INPUT -p udp --dport 53 -m limit --limit 50/s -j ACCEPT
iptables -A INPUT -p udp --dport 53 -j DROP
```

#### 2. ุชุนุทูู ICMP Port Unreachable

```bash
# ููุน ุฅุฑุณุงู ุฑุณุงุฆู Port Unreachable
iptables -A OUTPUT -p icmp --icmp-type destination-unreachable -j DROP

# ุฃู ุนุจุฑ sysctl
sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1
```

**ุงููุงุฆุฏุฉ:**
- ูููุฑ ููุงุฑุฏ CPU
- ูููุน ุงุณุชูุฒุงู bandwidth ุจุงูุฑุฏูุฏ

#### 3. ุญูุงูุฉ ุนูู ูุณุชูู ุงูุฎุงุฏู

```bash
# ุฒูุงุฏุฉ ุญุฌู buffer ููู UDP
sysctl -w net.core.rmem_max=26214400
sysctl -w net.core.rmem_default=26214400

# ุชุญุณูู ูุนุงูุฌุฉ ุงูุญุฒู
sysctl -w net.core.netdev_max_backlog=5000
```

#### 4. Firewall Rules ุนูู Cisco

```cisco
! ุชุญุฏูุฏ ูุนุฏู UDP
access-list 110 permit udp any host 203.0.113.50 eq domain
access-list 110 deny udp any any

interface GigabitEthernet0/0
 ip access-group 110 in
 rate-limit input access-group 110 10000000 1000000 2000000 conform-action transmit exceed-action drop
```

#### 5. ุงุณุชุฎุฏุงู fail2ban

```bash
# ุชุซุจูุช fail2ban
sudo apt install fail2ban

# ุฅูุดุงุก ูุงุนุฏุฉ ูู UDP flood
sudo nano /etc/fail2ban/filter.d/udp-flood.conf
```

**ูุญุชูู ุงูููู:**
```ini
[Definition]
failregex = .*kernel.*UDP.*SRC=<HOST>.*
ignoreregex =
```

**ุงูุชูุนูู:**
```ini
# /etc/fail2ban/jail.local
[udp-flood]
enabled = true
filter = udp-flood
logpath = /var/log/syslog
maxretry = 100
findtime = 60
bantime = 3600
```

### ๐ ุงูููุงูุฐ ุงูุดุงุฆุนุฉ ุงููุณุชูุฏูุฉ

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุณุจุจ ุงูุงุณุชูุฏุงู |
|--------|---------|---------------|
| 53 | DNS | ุญููู ููุดุจูุฉุ ูููุฏ ุงุณุชุฌุงุจุงุช |
| 123 | NTP | ูููู ุชุถุฎููู (Amplification) |
| 161 | SNMP | ุฅุฏุงุฑุฉุ ุบุงูุจุงู ููุชูุญ |
| 1900 | SSDP | UPnPุ ุดุงุฆุน ูู ุงูุฃุฌูุฒุฉ ุงูููุฒููุฉ |
: SHA-256
- `$6# ุชุฏุฑูุจุงุช ุนูููุฉ ูู ุฃูู ุงูุดุจูุงุช
## Network Security - Practical Labs

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [NAT/PAT - ุชุฑุฌูุฉ ุนูุงููู ุงูุดุจูุฉ](#1-natpat---ุชุฑุฌูุฉ-ุนูุงููู-ุงูุดุจูุฉ)
2. [ACL - ููุงุฆู ุงูุชุญูู ุจุงููุตูู](#2-acl---ููุงุฆู-ุงูุชุญูู-ุจุงููุตูู)
3. [FTP ูุขููุฉ Established](#3-ftp-ูุขููุฉ-established)
4. [WAF ู Load Balancer](#4-waf-ู-load-balancer)
5. [Cisco Firepower - ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ](#5-cisco-firepower---ุชุญููู-ุงูุจุฑูุฌูุงุช-ุงูุฎุจูุซุฉ)
6. [ARP - ุจุฑูุชูููู ุชุญููู ุงูุนูุงููู](#6-arp---ุจุฑูุชูููู-ุชุญููู-ุงูุนูุงููู)
7. [Nmap - ูุณุญ ุงูุดุจูุงุช](#7-nmap---ูุณุญ-ุงูุดุจูุงุช)
8. [ICMP - ุงุฎุชุจุงุฑุงุช ุงูุดุจูุฉ](#8-icmp---ุงุฎุชุจุงุฑุงุช-ุงูุดุจูุฉ)
9. [SYN Flooding Attack](#9-syn-flooding-attack)
10. [UDP Flood Attack](#10-udp-flood-attack)
11. [Nmap Port Scanning](#11-nmap-port-scanning)
12. [John the Ripper - ูุณุฑ ูููุงุช ุงููุฑูุฑ](#12-john-the-ripper---ูุณุฑ-ูููุงุช-ุงููุฑูุฑ)
13. [DHCP Snooping](#13-dhcp-snooping)

---

## 1. NAT/PAT - ุชุฑุฌูุฉ ุนูุงููู ุงูุดุจูุฉ

### ๐ฏ ุงููุฏู
ููู ุขููุฉ ุนูู NAT/PAT ูู ุชุฑุฌูุฉ ุงูุนูุงููู ุงูุฎุงุตุฉ ุฅูู ุนูุงููู ุนุงูุฉ.

### ๐ ุงูุณููุงุฑูู
ุฌูุงุฒ ุฏุงุฎูู ุจุนููุงู `10.0.0.5` ูุฑูุฏ ุชุตูุญ ุงูุฅูุชุฑูุช ุนุจุฑ ุฌุฏุงุฑ ูุงุฑู ูุณุชุฎุฏู NAT.

### ๐ ุฎุทูุงุช ุงูุนูู

1. **ุงูุทูุจ ุงูุตุงุฏุฑ:**
   - ุงูุฌูุงุฒ ุงูุฏุงุฎูู `10.0.0.5` ูุฑุณู ุทูุจ HTTP
   - ุงูุฌุฏุงุฑ ุงููุงุฑู ูุชุฑุฌู ุงูุนููุงู ุฅูู `203.0.113.2:10500`
   - ุงูุนููุงู `203.0.113.2` ูู ุงูุนููุงู ุงูุนุงู
   - ุงููููุฐ `10500` ููุณุชุฎุฏู ูุชูููุฒ ุงูุงุชุตุงู

2. **ุงูุฑุฏ ุงููุงุฑุฏ:**
   - ุนูุฏ ูุตูู ุงูุฑุฏ ูู ุงูุฅูุชุฑูุช ุฅูู `203.0.113.2:10500`
   - ูุนูุฏ NAT ุงูุชุฑุฌูุฉ ุงูุนูุณูุฉ ุฅูู `10.0.0.5` ุจุงููููุฐ ุงูุฃุตูู
   - ูุชู ุชุณููู ุงูุจูุงูุงุช ููุฌูุงุฒ ุงูุฏุงุฎูู

### โ ุงููุงุฆุฏุฉ
- ูุฆุงุช ุงูุฃุฌูุฒุฉ ูููููุง ูุดุงุฑูุฉ ุนููุงู ุนุงู ูุงุญุฏ
- ูุง ููุฌุฏ ุชุถุงุฑุจ ุจูุถู ุงุณุชุฎุฏุงู ุฃุฑูุงู ุงูููุงูุฐ (Port Numbers)
- ุชูููุฑ ูู ุนูุงููู IPv4 ุงูุนุงูุฉ

### ๐ ููุงุญุธุงุช
- PAT (Port Address Translation) ูู ููุน ูู NAT
- ููุณูู ุฃูุถุงู NAT Overload
- ุงูุฌุฏูู ุงูุฏุงุฎูู ูุญุชูุธ ุจุงูุฑุจุท ุจูู ุงูุนูุงููู ุงูุฏุงุฎููุฉ ูุงูููุงูุฐ

---

## 2. ACL - ููุงุฆู ุงูุชุญูู ุจุงููุตูู

### ๐ฏ ุงููุฏู
ุชุทุจูู ุณูุงุณุงุช ุฃูููุฉ ุจุงุณุชุฎุฏุงู ููุงุฆู ุงูุชุญูู ุจุงููุตูู (Access Control Lists).

### ๐ ุงูุณููุงุฑูู
ูุฏูู:
- **Web Server** ูู DMZ (Demilitarized Zone)
- **Database Server** ุฏุงุฎู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ

> ๐ก **DMZ:** ููุทูุฉ ููุฒูุนุฉ ุงูุณูุงุญุ ููู ููุทูุฉ ุจูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ูุงูุฅูุชุฑูุช ูุชูููู ุงููุฎุงุทุฑ ุงูุฃูููุฉ.

### ๐ง ุงูุชูููู ุงูุนููู

```cisco
access-list 100 permit tcp any 10.10.10.10 eq www
access-list 100 permit tcp any 10.10.10.10 eq 443
access-list 100 permit tcp any 10.10.10.12 eq ftp
access-list 100 permit tcp any 10.10.10.12 eq ftp-data
access-list 100 deny ip any any log

interface gi0/1
ip access-group 100 in
```

### ๐ ุดุฑุญ ุงูุฃูุงูุฑ

| ุงูุฃูุฑ | ุงููุธููุฉ |
|------|---------|
| `permit tcp any 10.10.10.10 eq www` | ุงูุณูุงุญ ุจุงููุตูู ูุฎุงุฏู ุงูููุจ ุนุจุฑ HTTP (ูููุฐ 80) |
| `permit tcp any 10.10.10.10 eq 443` | ุงูุณูุงุญ ุจุงููุตูู ุนุจุฑ HTTPS (ูููุฐ 443) |
| `permit tcp any 10.10.10.12 eq ftp` | ุงูุณูุงุญ ุจู FTP Control (ูููุฐ 21) |
| `permit tcp any 10.10.10.12 eq ftp-data` | ุงูุณูุงุญ ุจู FTP Data (ูููุฐ 20) |
| `deny ip any any log` | ุญุธุฑ ุฃู ุญุฑูุฉ ุฃุฎุฑู ูุน ุงูุชุณุฌูู |
| `ip access-group 100 in` | ุชุทุจูู ุงููุงุฆูุฉ ุนูู ุงููุงุฌูุฉ |

### ๐ฏ ุงููุฏู ุงูุฃููู
- ุงูุณูุงุญ ุจุงููุตูู ููุท ููููุงูุฐ ุงููุทููุจุฉ
- ููุน ุงููุตูู ุงููุจุงุดุฑ ูุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุณุฌูู ุงููุญุงููุงุช ุงููุดุจููุฉ
- ุชูููู ูุทุงู ุงููุฌูู (Attack Surface)

### โ๏ธ ููุงุญุธุงุช ูููุฉ
- ุงููุตูู ููุงุนุฏุฉ ุงูุจูุงูุงุช ูุฌุจ ุฃู ูุชู ููุท ูู ุฎูุงู ุฎุงุฏู ุงูููุจ
- ุชุฑุชูุจ ุงูููุงุนุฏ ููู ุฌุฏุงู (ูู ุงูุฃุนูู ููุฃุณูู)
- ุงููุงุนุฏุฉ ุงูุถูููุฉ ูู ุงูููุงูุฉ: `deny any any`

---

## 3. FTP ูุขููุฉ Established

### ๐ฏ ุงููุฏู
ููู ุงููุฑู ุจูู FTP Passive ู Active Mode ูุชุฃุซูุฑู ุนูู ACL.

### ๐ ุจููุฉ FTP
ุจุฑูุชูููู FTP ูุณุชุฎุฏู ููุงุชูู ูููุตูุชูู:
- **Port 21:** ููุงุฉ ุงูุชุญูู (Control Channel)
- **Port 20:** ููุงุฉ ุงูุจูุงูุงุช (Data Channel)

### ๐ FTP Passive Mode

```
[Client] -----> [Server]
         Port 21 (Control)
         
[Client] <----- [Server]
         Random High Port (Data)
```

**ุขููุฉ ุงูุนูู:**
1. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุชุญูู ูุญู ุงููููุฐ 21
2. ุงูุนููู ูุทูุจ ูุถุน Passive
3. ุงูุฎุงุฏู ูุฑุฏ ุจูููุฐ ุนุดูุงุฆู ุนุงูู
4. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุจูุงูุงุช ูุญู ูุฐุง ุงููููุฐ
5. ูู ุงูุฑุฏูุฏ ุชุญุชูู ุนูู ุจุช ACK โ **ูุณููุญ ุจูุง** โ

### ๐ FTP Active Mode

```
[Client] -----> [Server]
         Port 21 (Control)
         
[Client] <----- [Server]
         Port 20 (Data initiated by server)
```

**ุขููุฉ ุงูุนูู:**
1. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุชุญูู ูุญู ุงููููุฐ 21
2. ุงูุนููู ูุฎุจุฑ ุงูุฎุงุฏู ุจูููุฐ ูุนูู ูุงุณุชูุจุงู ุงูุจูุงูุงุช
3. **ุงูุฎุงุฏู ูุจุฏุฃ ุงุชุตุงู ุงูุจูุงูุงุช** ูู ุงููููุฐ 20
4. ุฃูู ุญุฒูุฉ ูู ุงูุฎุงุฏู ุชุญุชูู ุนูู SYN ููุท โ **ุชูุฑูุถ** ๐ซ

### โ๏ธ ุงููุดููุฉ ูุน Established

```cisco
access-list 110 permit tcp any any established
```

ูุฐู ุงููุงุนุฏุฉ ุชุณูุญ ููุท ุจุงูุญุฒู ุงูุชู ุชุญุชูู ุนูู:
- ุจุช ACK
- ุฃู ุจุช RST

**ุงููุชูุฌุฉ:**
- ูู Active Modeุ ุงูุฎุงุฏู ูุฑุณู SYN ุฃููุงู
- ูุฐู ุงูุญุฒูุฉ ูุง ุชุญูู ุดุฑุท "established"
- ุงูุงุชุตุงู ููุดู ๐ซ

### โ ุงูุญู ุงูุฃูุซู
ุงุณุชุฎุฏุงู ุฌุฏุงุฑ ูุงุฑู ุญูููู (Stateful Firewall) ูุงุฏุฑ ุนูู:
- ุชุชุจุน ุงูุฌูุณุงุช ุงููุดุทุฉ
- ููู ุงูุจุฑูุชููููุงุช ุงููุนูุฏุฉ ูุซู FTP
- ุงูุณูุงุญ ุจุงูุงุชุตุงูุงุช ุงูุฏููุงููููุฉ ุชููุงุฆูุงู

### ๐ ุงูุฎูุงุตุฉ
- `established` ูุง ูููู ููุจุฑูุชููููุงุช ุงููุนูุฏุฉ
- FTP Passive Mode ุฃูุซุฑ ุชูุงููุงู ูุน ุงูุฌุฏุฑุงู ุงููุงุฑูุฉ
- Stateful Firewalls ุถุฑูุฑูุฉ ููุจูุฆุงุช ุงูุฅูุชุงุฌูุฉ

---

## 4. WAF ู Load Balancer

### ๐ฏ ุงููุฏู
ุจูุงุก ุจููุฉ ุชุญุชูุฉ ุขููุฉ ููุงุจูุฉ ููุชูุณุน ููููุน ููุจ.

### ๐ ุงูุณููุงุฑูู
ูููุน ููุจ ูุญุชูู ุนูู ุนุฏุฉ ุฎูุงุฏู Web Servers ุฎูู Load Balancerุ ูุน ุญูุงูุฉ ูู ูุฌูุงุช XSS.

### ๐๏ธ ุงูุจููุฉ ุงููุนูุงุฑูุฉ

```
[Internet]
    |
    โ
[WAF - Web Application Firewall]
    |
    โ
[Load Balancer]
    |
    โ------------------โ------------------โ------------------โ
[Web Server 1]   [Web Server 2]   [Web Server 3]   [Web Server 4]
```

### โ๏ธ ููุงู Load Balancer

**ุฎูุงุฑุฒููุฉ ุงูุชูุฒูุน:**
- **Round Robin:** ุชูุฒูุน ูุชุณุงูู ุนูู ุฌููุน ุงูุฎูุงุฏู
- ุฏูุฑุฉ ููุชุธูุฉ: Server 1 โ Server 2 โ Server 3 โ Server 4 โ ุชูุฑุงุฑ

**ุฅุฏุงุฑุฉ ุงูุฃุนุทุงู:**
1. ูุฑุงูุจุฉ ุตุญุฉ ุงูุฎูุงุฏู (Health Checks)
2. ุนูุฏ ูุดู ุฃุญุฏ ุงูุฎูุงุฏู:
   - ุฅุฒุงูุชู ูู ูุงุฆูุฉ ุงูุชูุฒูุน ุชููุงุฆูุงู
   - ุชุญููู ุทูุจุงุชู ุฅูู ุงูุฎูุงุฏู ุงูุณูููุฉ
3. ุนูุฏ ุนูุฏุฉ ุงูุฎุงุฏู: ุฅุนุงุฏุฉ ุฅุฏุฑุงุฌู ุชููุงุฆูุงู

### ๐ก๏ธ ููุงู WAF (ูู Reverse Proxy)

**ุงูุญูุงูุฉ ูู XSS:**
```javascript
// ูุซุงู ุนูู ูุญุงููุฉ ูุฌูู XSS
<script>alert('XSS Attack')</script>
```

**ุขููุฉ ุงูุญูุงูุฉ:**
1. ูุญุต ูู ุทูุจ HTTP ูุจู ูุตููู ููุฎูุงุฏู
2. ูุดู ุงูุดููุฑุงุช ุงูุฎุจูุซุฉ:
   - JavaScript ูุดุจูู
   - SQL Injection
   - Command Injection
3. ููุน ุงูุทูุจุงุช ุงููุดุจููุฉ ููุฑุงู โ
4. ููุน ุชุณุฑูุจ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุงุณุชุฌุงุจุงุช

### ๐ ุณูุงุณุงุช ุงูุฃูุงู

| ููุน ุงูุญูุงูุฉ | ุงููุธููุฉ |
|-------------|---------|
| XSS Prevention | ููุน ุญูู JavaScript |
| SQL Injection | ุญูุงูุฉ ููุงุนุฏ ุงูุจูุงูุงุช |
| CSRF Protection | ููุน ุงูุทูุจุงุช ุงููุฒูุฑุฉ |
| Rate Limiting | ุงูุญุฏ ูู ูุนุฏู ุงูุทูุจุงุช |
| IP Blacklisting | ุญุธุฑ IP ุงููุดุจููุฉ |

### โ ุงููุฒุงูุง ุงููุญููุฉ

**ุงูุฃุฏุงุก:**
- โก ุชูุฒูุน ุงูุฃุญูุงู ุจุดูู ูุชูุงุฒู
- ๐ ุชุญูู ุงูุฃุนุทุงู (Fault Tolerance)
- ๐ ูุงุจููุฉ ุงูุชูุณุน ุงูุฃููู

**ุงูุฃูุงู:**
- ๐ก๏ธ ุญูุงูุฉ ูุชูุฏูุฉ ูู WAF
- ๐ ูุญุต ุฌููุน ุงูุทูุจุงุช
- ๐ ุชุณุฌูู ุงููุญุงููุงุช ุงููุดุจููุฉ
- ๐ซ ุญุธุฑ ุงููุฌูุงุช ูู ุงูููุช ุงูุญูููู

### ๐ ูุซุงู ุนูู ุณุฌูุงุช WAF

```
2025-10-26 10:15:32 | BLOCKED | XSS Attempt | IP: 192.168.1.100
2025-10-26 10:16:45 | BLOCKED | SQL Injection | IP: 10.0.0.50
2025-10-26 10:17:12 | ALLOWED | Normal Request | IP: 172.16.0.25
```

---

## 5. Cisco Firepower - ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ

### ๐ฏ ุงููุฏู
ููู ููููุฉ ุนูู ุฃูุธูุฉ ูุดู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ ุงููุชูุฏูุฉ ูุชุชุจุน ุงูุชุดุงุฑูุง.

### ๐ ุงูุณููุงุฑูู
ููู ุจุงุณู `tool.exe` ุชู ุงูุชุดุงูู ุถูู ุญุฑูุฉ ุงููุฑูุฑ ุนูู ุงูุดุจูุฉ.

### ๐ ูุฑุงุญู ุงููุดู ูุงูุชุญููู

#### ุงููุฑุญูุฉ 1: ุงููุญุต ุงูุฃููู
1. **ุงุนุชุฑุงุถ ุงูููู:** ุฌูุงุฒ Cisco Firepower ููุญุต ุฌููุน ุงููููุงุช ุงููุงุฑุฉ
2. **ุญุณุงุจ ุงูุจุตูุฉ:** ุงุณุชุฎุฑุงุฌ ุจุตูุฉ SHA-256 ููููู
   ```
   SHA-256: a3f7b8c9d2e1f4a6b5c8d7e9f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0
   ```
3. **ุงูููุงุฑูุฉ:** ููุงุฑูุฉ ุงูุจุตูุฉ ูุน ูุงุนุฏุฉ ุจูุงูุงุช ุงูุชูุฏูุฏุงุช

#### ุงููุฑุญูุฉ 2: ุงูุชุตููู
```
Status: โ๏ธ MALWARE DETECTED
Threat Name: Generic.Trojan.Downloader
Threat Score: 95/100 (High)
Category: Trojan
First Seen: 2025-10-25 14:30:22
```

#### ุงููุฑุญูุฉ 3: ุชุญุฏูุฏ ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ
ุงูุฃุฌูุฒุฉ ุงูุชุงููุฉ ุชู ุชุญุฏูุฏูุง ููุตุงุจุฉ:
- ๐ฅ๏ธ `192.168.10.90`
- ๐ฅ๏ธ `192.168.133.50`

### ๐ Trajectory Map (ุฎุฑูุทุฉ ุงููุณุงุฑ)

```
Time โ
Device 1: --------[*]==========[*]-------
                   โ            โ
Device 2: --------[*]----[*]----[*]------
                         โ      โ
Device 3: ---------------[*]=====[*]-----
```

**ุฑููุฒ ุงูุฎุฑูุทุฉ:**
- `[*]` ููุทุฉ ุงูุชูุงู ุงูููู
- `=` ูุชุฑุฉ ูุดุงุท ุงูููู ุนูู ุงูุฌูุงุฒ
- `โ` ุงุชุฌุงู ุงูุชูุงู ุงูุนุฏูู (ูู ุฌูุงุฒ ูุขุฎุฑ)
- `-` ูุชุฑุฉ ุฎููู

### ๐ ุฌุฏูู ุงูุฃุญุฏุงุซ (Events Table)

| ุงูููุช | ุงูุฌูุงุฒ ุงููุตุฏุฑ | ุงูุฌูุงุฒ ุงููุฏู | ุงูุญุฏุซ | ุงูุญุงูุฉ |
|------|---------------|--------------|--------|--------|
| 14:30:22 | External | 192.168.10.90 | File Download | Infected |
| 14:35:18 | 192.168.10.90 | 192.168.133.50 | File Transfer | Infected |
| 14:42:33 | 192.168.133.50 | Network Share | Propagation Attempt | Blocked |

### ๐ฏ ุงุณุชุฎุฏุงูุงุช Trajectory Map

1. **ุชุญุฏูุฏ ุงููุตุฏุฑ ุงูุฃููู:**
   - ุฃูู ุฌูุงุฒ ุชููู ุงูููู
   - ููุทุฉ ุงูุฏุฎูู ุฅูู ุงูุดุจูุฉ

2. **ุชุชุจุน ูุณุงุฑ ุงูุงูุชุดุงุฑ:**
   - ุงูุฃุฌูุฒุฉ ุงููุณูุทุฉ
   - ุทุฑู ุงูุงูุชูุงู ุงููุณุชุฎุฏูุฉ

3. **ุชูููู ูุทุงู ุงูุฅุตุงุจุฉ:**
   - ุนุฏุฏ ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ
   - ุงูุฃูุณุงู ุงููุชุฃุซุฑุฉ

4. **ุงูุชุฎุทูุท ููุงุณุชุฌุงุจุฉ:**
   - ุฃููููุฉ ุงููุนุงูุฌุฉ
   - ุฎุทุฉ ุงูุนุฒู ูุงูุฅุฒุงูุฉ

### ๐จ ุฎุทุฉ ุงูุงุณุชุฌุงุจุฉ ููุญุงุฏุซ

**ุงูุฎุทูุงุช ุงูููุฑูุฉ:**
1. โ ุนุฒู ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ ุนู ุงูุดุจูุฉ
2. โ ุญุธุฑ ุจุตูุฉ ุงูููู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
3. โ ูุญุต ุดุงูู ููุฃุฌูุฒุฉ ุงููุฌุงูุฑุฉ
4. โ ุชุญููู ุณุฌูุงุช ุงููุดุงุท

**ุงูุฅุฌุฑุงุกุงุช ุงูุชุตุญูุญูุฉ:**
1. ๐ง ุฅุฒุงูุฉ ุงูุจุฑูุฌูุฉ ุงูุฎุจูุซุฉ
2. ๐ง ุชุญุฏูุซ ุชุนุฑููุงุช ููุงูุญ ุงูููุฑูุณุงุช
3. ๐ง ุชุตุญูุญ ุงูุซุบุฑุงุช ุงููุณุชุบูุฉ
4. ๐ง ุงุณุชุนุงุฏุฉ ุงููุธุงู ูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุธููุฉ

**ุงููุชุงุจุนุฉ:**
1. ๐ ุชูุซูู ุงูุญุงุฏุซ
2. ๐ ุชุญุฏูุซ ุงูุณูุงุณุงุช ุงูุฃูููุฉ
3. ๐ ุชุฏุฑูุจ ุงููุณุชุฎุฏููู
4. ๐ ูุฑุงูุจุฉ ูุนุฒุฒุฉ ููุชุฑุฉ

### ๐ก ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ
- ุฃูููุฉ ุงููุญุต ุงูุนููู ูุญุฑูุฉ ุงููุฑูุฑ
- ุถุฑูุฑุฉ ุงูุชุณุฌูู ุงูุดุงูู ููุฃุญุฏุงุซ
- ูููุฉ ุฃุฏูุงุช ุงูุชุญููู ุงูุจุตุฑู
- ุฃูููุฉ ุงูุงุณุชุฌุงุจุฉ ุงูุณุฑูุนุฉ

---

## 6. ARP - ุจุฑูุชูููู ุชุญููู ุงูุนูุงููู

### ๐ฏ ุงููุฏู
ููู ุขููุฉ ุนูู ุจุฑูุชูููู ARP ููุฑุงูุจุฉ ุงูุฌุฏูู ุงูุฎุงุต ุจู.

### ๐ ูุธุฑุฉ ุนุงูุฉ
ARP (Address Resolution Protocol) ูุฑุจุท ุจูู:
- **ุนููุงู IP** (Layer 3)
- **ุนููุงู MAC** (Layer 2)

### ๐ ุงูุชุทุจูู ุงูุนููู

#### ุงูุฎุทูุฉ 1: ุนุฑุถ ุฌุฏูู ARP

**ุนูู Windows:**
```cmd
arp -a
```

**ุนูู Linux/macOS:**
```bash
arp -a
```

#### ุงูุฎุทูุฉ 2: ูุฑุงุกุฉ ุงููุชุงุฆุฌ

```
Interface: 192.168.1.100 --- 0x4
  Internet Address      Physical Address      Type
  192.168.1.1          00-1A-2B-3C-4D-5E     dynamic
  192.168.1.10         00-AA-BB-CC-DD-EE     dynamic
  192.168.1.255        FF-FF-FF-FF-FF-FF     static
  224.0.0.22           01-00-5E-00-00-16     static
```

### ๐ ุชุญููู ุงูุฌุฏูู

| ุงููููู | ุงูุดุฑุญ |
|--------|--------|
| **Internet Address** | ุนููุงู IP ููุฌูุงุฒ |
| **Physical Address** | ุนููุงู MAC ููุฌูุงุฒ |
| **Type** | ููุน ุงูุฅุฏุฎุงู |

### ๐ท๏ธ ุฃููุงุน ุงูุฅุฏุฎุงูุงุช

**Dynamic:**
- ูุชู ุชุนููู ุชููุงุฆูุงู ูู ุญุฑูุฉ ุงููุฑูุฑ
- ููุญุฐู ุจุนุฏ ูุชุฑุฉ ุนุฏู ุงููุดุงุท (ุนุงุฏุฉ 2-10 ุฏูุงุฆู)
- ุงูุฃูุซุฑ ุดููุนุงู ูู ุงูุดุจูุงุช

**Static:**
- ูุชู ุฅุถุงูุชู ูุฏููุงู ุจูุงุณุทุฉ ุงููุฏูุฑ
- ูุง ููุญุฐู ุชููุงุฆูุงู
- ููุณุชุฎุฏู ููุฃุฌูุฒุฉ ุงูุญุณุงุณุฉ

### ๐ ุนูุงููู ุฎุงุตุฉ

**Broadcast:**
```
192.168.1.255 โ FF-FF-FF-FF-FF-FF
```
- ููุฑุณู ูุฌููุน ุงูุฃุฌูุฒุฉ ูู ุงูุดุจูุฉ

**Multicast:**
```
224.0.0.22 โ 01-00-5E-00-00-16
```
- ููุฑุณู ููุฌููุนุฉ ูุญุฏุฏุฉ ูู ุงูุฃุฌูุฒุฉ

### ๐งน ูุณุญ ุงููุงุด

**ูุณุญ ุฌููุน ุงูุฅุฏุฎุงูุงุช (Windows):**
```cmd
arp -d *
```

**ูุณุญ ุฅุฏุฎุงู ูุญุฏุฏ:**
```cmd
arp -d 192.168.1.10
```

**ุนูู Linux:**
```bash
sudo ip -s -s neigh flush all
```

### ๐ ุฅุถุงูุฉ ุฅุฏุฎุงู ุซุงุจุช

**Windows:**
```cmd
arp -s 192.168.1.50 00-11-22-33-44-55
```

**Linux:**
```bash
sudo arp -s 192.168.1.50 00:11:22:33:44:55
```

### ๐ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

**1. ุชุดุฎูุต ูุดุงูู ุงูุงุชุตุงู:**
```bash
# ูุญุต ูุฌูุฏ ุงูุฌูุงุฒ ูู ุงูุฌุฏูู
arp -a | grep 192.168.1.10

# ุฅุฐุง ูู ูุธูุฑุ ุงููุดููุฉ ูุฏ ุชููู ูู Layer 2
```

**2. ูุดู ุชุถุงุฑุจ IP:**
```bash
# ุฅุฐุง ุธูุฑ ููุณ IP ุจุนููุงูู MAC ูุฎุชูููู
192.168.1.50    00-AA-BB-CC-DD-EE
192.168.1.50    00-11-22-33-44-55  # โ๏ธ ุชุถุงุฑุจ!
```

**3. ูุฑุงูุจุฉ ุงูุฃุฌูุฒุฉ ุงููุดุทุฉ:**
```bash
# ุนุฏ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ
arp -a | grep dynamic | wc -l
```

### โ๏ธ ููุงุญุธุงุช ุฃูููุฉ

**ARP Spoofing/Poisoning:**
- ููุงุฌู ูุฑุณู ุฑุณุงุฆู ARP ูุฒููุฉ
- ูุฎุฏุน ุงูุฃุฌูุฒุฉ ูุฅุฑุณุงู ุงูุจูุงูุงุช ูู
- **ุงูุญูุงูุฉ:** ARP Inspection ุนูู ุงูุณููุชุดุงุช

**ุงูููุงูุฉ:**
```cisco
# ุชูุนูู Dynamic ARP Inspection
Switch(config)# ip arp inspection vlan 10
Switch(config)# interface gi0/1
Switch(config-if)# ip arp inspection trust
```

### ๐ก ูุตุงุฆุญ ุนูููุฉ
- ุฑุงูุจ ุฌุฏูู ARP ุจุดูู ุฏูุฑู
- ุงูุชุจู ููุชุบููุฑุงุช ุงูููุงุฌุฆุฉ ูู ุนูุงููู MAC
- ุงุณุชุฎุฏู ุฅุฏุฎุงูุงุช ุซุงุจุชุฉ ููุฃุฌูุฒุฉ ุงูุญุณุงุณุฉ
- ูุนูู ARP Inspection ูู ุงูุจูุฆุงุช ุงูุญุณุงุณุฉ

---

## 7. Nmap - ูุณุญ ุงูุดุจูุงุช

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู Nmap ูุงูุชุดุงู ุงูุฃุฌูุฒุฉ ูุงูุฎุฏูุงุช ุงููุดุทุฉ ุนูู ุงูุดุจูุฉ.

### ๐ ุงููุชุทูุจุงุช
- ูุธุงู Linux (ููุถู Kali Linux)
- ุตูุงุญูุงุช root ูููุณุญ ุงููุชูุฏู
- **ุจูุฆุฉ ุงุฎุชุจุงุฑูุฉ ููุท** โ๏ธ

### ๐ ุฃููุงุน ุงููุณุญ

#### 1. ุงูุชุดุงู ุงูุฃุฌูุฒุฉ ุงููุดุทุฉ (Host Discovery)

```bash
nmap -sn 192.168.1.0/24
```

**ุงูุดุฑุญ:**
- `-sn`: Ping Scan (ุจุฏูู ูุญุต ุงูููุงูุฐ)
- ูุณุชุฎุฏู ICMP Echo Request
- ููุธูุฑ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ ูุงููุดุทุฉ

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
Starting Nmap 7.94
Nmap scan report for 192.168.1.1
Host is up (0.0012s latency).

Nmap scan report for 192.168.1.50
Host is up (0.0034s latency).

Nmap scan report for 192.168.1.100
Host is up (0.0028s latency).

Nmap done: 256 IP addresses (3 hosts up) scanned in 2.85 seconds
```

#### 2. ูุญุต ุงูููุงูุฐ (Port Scanning)

**Basic TCP Scan:**
```bash
nmap 192.168.1.50
```

**Comprehensive Scan:**
```bash
nmap -sS -sV -O 192.168.1.50
```

**ุงูุดุฑุญ:**
- `-sS`: SYN Stealth Scan (ุฃูู ูุงุจููุฉ ูููุดู)
- `-sV`: ูุดู ุฅุตุฏุงุฑุงุช ุงูุฎุฏูุงุช
- `-O`: ุชุฎููู ูุธุงู ุงูุชุดุบูู

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PORT     STATE SERVICE    VERSION
21/tcp   open  ftp        vsftpd 3.0.3
22/tcp   open  ssh        OpenSSH 8.2p1
80/tcp   open  http       Apache httpd 2.4.41
443/tcp  open  ssl/http   Apache httpd 2.4.41
3306/tcp open  mysql      MySQL 5.7.33

OS details: Linux 3.2 - 4.9
```

#### 3. ูุญุต ุฌููุน ุงูููุงูุฐ

```bash
nmap -p- 192.168.1.50
```

- `-p-`: ูุญุต ุฌููุน ุงูููุงูุฐ (1-65535)
- ูุณุชุบุฑู ููุชุงู ุฃุทูู

#### 4. ูุญุต ููุงูุฐ ูุญุฏุฏุฉ

```bash
nmap -p 21,22,80,443,3306 192.168.1.50
```

### ๐ญ ุฃููุงุน ูุณุญ ุงูููุงูุฐ

#### TCP SYN Scan (ุงูุฃูุซุฑ ุดููุนุงู)
```bash
nmap -sS 192.168.1.50
```
- ูุฑุณู SYN ููุท
- ูุง ููููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ุฃูู ูุงุจููุฉ ูููุดู

#### TCP Connect Scan
```bash
nmap -sT 192.168.1.50
```
- ููููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ูุง ูุญุชุงุฌ ุตูุงุญูุงุช root
- ุฃูุซุฑ ูุงุจููุฉ ูููุดู

#### UDP Scan
```bash
nmap -sU 192.168.1.50
```
- ูุญุต ููุงูุฐ UDP
- ุจุทูุก ุฌุฏุงู
- ููู ูุฎุฏูุงุช ูุซู DNS, DHCP

### ๐ฌ ูุญุต ุงูุซุบุฑุงุช

```bash
nmap --script vuln 192.168.1.50
```

ูุณุชุฎุฏู NSE (Nmap Scripting Engine) ููุจุญุซ ุนู ุซุบุฑุงุช ูุนุฑููุฉ.

### ๐ ุชูููู ุงููุฎุงุทุฑ

#### ููุงูุฐ ุนุงููุฉ ุงูุฎุทูุฑุฉ:

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุงูุฎุทุฑ |
|--------|---------|-------|
| 21 | FTP | ููู ุจูุงูุงุช ุจุฏูู ุชุดููุฑ |
| 23 | Telnet | ุฅุฏุงุฑุฉ ุนู ุจุนุฏ ุจุฏูู ุชุดููุฑ |
| 445 | SMB | ุนุฑุถุฉ ููุฌูุงุช WannaCry ูุบูุฑูุง |
| 3389 | RDP | ูุฏู ุดุงุฆุน ูููุฌูุงุช |
| 1433 | MSSQL | ูุงุนุฏุฉ ุจูุงูุงุช ูุฏ ุชููู ุนุฑุถุฉ |

### ๐ก๏ธ ุงูุญูุงูุฉ ูู Nmap

**1. ุนูู ูุณุชูู ุงูุฌุฏุงุฑ ุงููุงุฑู:**
```cisco
# ุฑูุถ ุงููุณุญ ูู ูุตุงุฏุฑ ุฎุงุฑุฌูุฉ
access-list 100 deny tcp any any range 1 1024
```

**2. ุนูู ูุณุชูู ุงูุฎุงุฏู:**
```bash
# ุงุณุชุฎุฏุงู iptables ูููุน ุงููุณุญ
iptables -A INPUT -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT
```

**3. ุฃุฏูุงุช ูุดู ุงููุณุญ:**
```bash
# ุชุซุจูุช portsentry
sudo apt install portsentry

# ูุฑุงูุจุฉ ูุญุงููุงุช ุงููุณุญ
tail -f /var/log/syslog | grep portsentry
```

### ๐ก ูุตุงุฆุญ ููุงุณุชุฎุฏุงู ุงูุขูู
- โ๏ธ **ูุง ุชูู ุจูุณุญ ุดุจูุงุช ูุง ุชููููุง**
- ๐ ุงุญุตู ุนูู ุฅุฐู ุฎุทู ูุจู ุฃู ุงุฎุชุจุงุฑ ุงุฎุชุฑุงู
- ๐ ุงุณุชุฎุฏู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ููุชุฏุฑูุจ
- ๐ ูุซูู ุฌููุน ุนูููุงุช ุงููุณุญ ููุชุงุฆุฌูุง

### ๐ ุฃูุซูุฉ ุชุนููููุฉ ุฅุถุงููุฉ

**ูุณุญ ุณุฑูุน ูุฃูู 100 ูููุฐ:**
```bash
nmap --top-ports 100 192.168.1.50
```

**ูุณุญ ูุน ุชุฌูุจ ุงููุดู:**
```bash
nmap -sS -T2 -f 192.168.1.50
```
- `-T2`: ุณุฑุนุฉ ุจุทูุฆุฉ (ุฃูู ุฅุฒุนุงุฌุงู)
- `-f`: ุชุฌุฒุฆุฉ ุงูุญุฒู

**ุญูุธ ุงููุชุงุฆุฌ:**
```bash
nmap -oN results.txt 192.168.1.50
nmap -oX results.xml 192.168.1.50
```

---

## 8. ICMP - ุงุฎุชุจุงุฑุงุช ุงูุดุจูุฉ

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู ุฃุฏูุงุช ICMP ูุชุดุฎูุต ูุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจุงูุดุจูุฉ.

### ๐ ุจุฑูุชูููู ICMP
Internet Control Message Protocol - ุจุฑูุชูููู ุฑุณุงุฆู ุงูุชุญูู ูู ุงูุฅูุชุฑูุช
- Layer 3 Protocol
- ููุณุชุฎุฏู ููุชุดุฎูุต ูุฅุจูุงุบ ุงูุฃุฎุทุงุก
- ูุง ูุญูู ุจูุงูุงุช ุงููุณุชุฎุฏู

### ๐ ุงูุฃูุงูุฑ ุงูุฃุณุงุณูุฉ

#### 1. Ping - ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

**ุงูุงุณุชุฎุฏุงู ุงูุจุณูุท:**
```bash
ping 8.8.8.8
```

**ูุน ุฎูุงุฑุงุช ูุชูุฏูุฉ:**
```bash
# ุฅุฑุณุงู 10 ุญุฒู ููุท
ping -c 10 8.8.8.8

# ุชุบููุฑ ุญุฌู ุงูุญุฒูุฉ
ping -s 1000 8.8.8.8

# ุชุญุฏูุฏ ุงูููุช ุจูู ุงูุญุฒู (ุซุงููุฉ ูุงุญุฏุฉ)
ping -i 1 8.8.8.8
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=116 time=12.4 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=116 time=11.8 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=116 time=12.1 ms

--- 8.8.8.8 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2003ms
rtt min/avg/max/mdev = 11.8/12.1/12.4/0.3 ms
```

#### 2. Traceroute - ุชุชุจุน ุงููุณุงุฑ

**ุนูู Linux:**
```bash
traceroute 8.8.8.8
```

**ุนูู Windows:**
```cmd
tracert 8.8.8.8
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  192.168.1.1 (192.168.1.1)  1.245 ms  1.123 ms  1.089 ms
 2  10.0.0.1 (10.0.0.1)  8.456 ms  8.234 ms  8.123 ms
 3  172.16.0.1 (172.16.0.1)  15.678 ms  15.456 ms  15.234 ms
 4  * * *
 5  8.8.8.8 (8.8.8.8)  22.345 ms  22.123 ms  21.987 ms
```

**ุงูุชุญููู:**
- ูู ุณุทุฑ ููุซู ููุฌูู (router) ูู ุงููุณุงุฑ
- ุงูุฃุฑูุงู ุงูุซูุงุซุฉ: ุฒูู ุงูุงุณุชุฌุงุจุฉ ูููุญุงููุงุช ุงูุซูุงุซ
- `* * *`: ุงูููุฌูู ูุง ูุณุชุฌูุจ ูุทูุจุงุช ICMP

#### 3. MTR - ุชุชุจุน ูุชูุฏู

```bash
mtr 8.8.8.8
```

ูุฌูุน ุจูู ping ู traceroute ูุน ุฅุญุตุงุฆูุงุช ูุณุชูุฑุฉ:
```
                             Packets               Pings
 Host                      Loss%   Snt   Last   Avg  Best  Wrst StDev
 1. 192.168.1.1             0.0%    10    1.2   1.3   1.1   1.5   0.1
 2. 10.0.0.1                0.0%    10    8.4   8.5   8.1   9.2   0.3
 3. 8.8.8.8                 0.0%    10   22.1  22.3  21.8  23.1   0.4
```

### ๐ ุฃููุงุน ุฑุณุงุฆู ICMP

| ุงูููุน | ุงูุงุณู | ุงูุงุณุชุฎุฏุงู |
|-------|-------|-----------|
| Type 0 | Echo Reply | ุฑุฏ ุนูู Ping |
| Type 3 | Destination Unreachable | ุงููุฌูุฉ ุบูุฑ ูุชุงุญุฉ |
| Type 5 | Redirect | ุฅุนุงุฏุฉ ุชูุฌูู ุงููุณุงุฑ |
| Type 8 | Echo Request | ุทูุจ Ping |
| Type 11 | Time Exceeded | ุงูุชูุงุก TTL (ูุณุชุฎุฏูู traceroute) |

### โ๏ธ ุงุฎุชุจุงุฑุงุช ูุชูุฏูุฉ (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ููุท)

#### ICMP Flood Test

```bash
# โ๏ธ ููุงุฎุชุจุงุฑ ูู ุจูุฆุฉ ูุนุฒููุฉ ููุท
sudo ping -f -s 65500 TARGET_IP
```

**ุงูุดุฑุญ:**
- `-f`: Flood mode (ุฅุฑุณุงู ุณุฑูุน ุฌุฏุงู)
- `-s 65500`: ุญุฌู ุงูุญุฒูุฉ (ุฃูุตู ุญุฏ)
- **ููุณุชุฎุฏู ูุงุฎุชุจุงุฑ ุชุญูู ุงูุดุจูุฉ**

**ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
```
PING target (192.168.1.50) 65500(65528) bytes of data.
..................................
--- target ping statistics ---
10000 packets transmitted, 9856 received, 1.44% packet loss
```

#### Ping of Death (ุชุงุฑูุฎู)

```bash
# โ๏ธ ูุง ูุนูู ุนูู ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ
ping -s 65510 TARGET_IP
```

**ุงูุฎูููุฉ:**
- ูุงู ููุณุจุจ ุชุนุทู ุงูุฃูุธูุฉ ุงููุฏููุฉ
- ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ ูุญููุฉ ุถุฏู

### ๐ก๏ธ ุงูุญูุงูุฉ ูู ูุฌูุงุช ICMP

#### 1. ุชุญุฏูุฏ ูุนุฏู ICMP

**ุนูู Linux:**
```bash
# ุชุญุฏูุฏ ุนุฏุฏ ุญุฒู ICMP ูู ุงูุซุงููุฉ
iptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT
iptables -A INPUT -p icmp --icmp-type echo-request -j DROP
```

#### 2. ุนูู Cisco Router

```cisco
# ุชุญุฏูุฏ ูุนุฏู ICMP
access-list 100 permit icmp any any echo-reply
access-list 100 deny icmp any any echo-request
interface gi0/0
ip access-group 100 in
rate-limit input access-group 100 1000000 250000 500000 conform-action transmit exceed-action drop
```

#### 3. ุญุธุฑ ICMP ููุงุฆูุงู (ุบูุฑ ูุณุชุญุณู)

```bash
# ููููุฏ ุงููุฏุฑุฉ ุนูู ุงูุชุดุฎูุต
iptables -A INPUT -p icmp -j DROP
```

### ๐ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงูุนูููุฉ

**1. ุชุดุฎูุต ุงููุทุงุน ุงูุงุชุตุงู:**
```bash
# ุฎุทูุฉ ุจุฎุทูุฉ
ping 192.168.1.1  # ุงูุจูุงุจุฉ ุงููุญููุฉ
ping 8.8.8.8      # ุฎุงุฏู ุฎุงุฑุฌู
traceroute 8.8.8.8  # ุชุญุฏูุฏ ููุทุฉ ุงูุงููุทุงุน
```

**2. ููุงุณ ุฌูุฏุฉ ุงูุงุชุตุงู:**
```bash
# ูุฑุงูุจุฉ ููุฏุฉ 5 ุฏูุงุฆู
ping -c 300 -i 1 8.8.8.8 | tee ping_results.txt

# ุชุญููู ุงููุชุงุฆุฌ
grep "time=" ping_results.txt | awk '{print $7}' | sed 's/time=//' | sort -n
```

**3. ุงุฎุชุจุงุฑ MTU (Maximum Transmission Unit):**
```bash
# ุงุจุฏุฃ ุจุญุฌู ูุจูุฑ ููููู ุชุฏุฑูุฌูุงู
ping -M do -s 1472 8.8.8.8

# ุฅุฐุง ูุดูุ ููู ุงูุญุฌู ุญุชู ููุฌุญ
ping -M do -s 1400 8.8.8.8
```

### ๐ก ูุตุงุฆุญ ูููุฉ
- ICMP ููุณ ุขููุงู 100% - ูููู ุงุณุชุฎุฏุงูู ูู ุงููุฌูุงุช
- ุจุนุถ ุงูุดุจูุงุช ุชุญุธุฑ ICMP ููุฃูุงู
- ุงุณุชุฎุฏู ุฃุฏูุงุช ุจุฏููุฉ (TCP ping) ุนูุฏ ุงูุญุงุฌุฉ
- ูุง ุชุนุชูุฏ ุนูู ICMP ููุท ูููุฑุงูุจุฉ

---

## 9. SYN Flooding Attack

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุฉ ูุฌูู SYN Flood ูุชุฃุซูุฑู ุนูู ุงูุฎูุงุฏู.

### โ๏ธ ุชุญุฐูุฑ ููู ุฌุฏุงู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ๏ธ  ูุฐุง ุงููุญุชูู ูุฃุบุฑุงุถ ุชุนููููุฉ ููุท  โ๏ธ       โ
โ                                                  โ
โ  ุชูููุฐ ูุฐุง ุงููุฌูู ุนูู ุฃูุธูุฉ ุญููููุฉ:           โ
โ  โข ุฌุฑููุฉ ูุนุงูุจ ุนูููุง ุงููุงููู                   โ
โ  โข ูุชุทูุจ ุฅุฐู ุฎุทู ูุณุจู                          โ
โ  โข ููุณูุญ ููุท ูู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุฌูู

#### ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ ุงูุทุจูุนูุฉ (TCP Three-Way Handshake)

```
Client                    Server
  |                         |
  |-------- SYN ---------->|  [1]
  |<----- SYN-ACK ---------|  [2]
  |-------- ACK ---------->|  [3]
  |                         |
  |==== Connection Open ====|
```

#### ูุฌูู SYN Flood

```
Attacker                  Server
  |                         |
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |      (thousands)        |
  |                         |
  |   โ No ACK Sent โ    |
  |                         |
  |                    [Server]
  |                   SYN Queue
  |                   โโโโโโโโโโโ
  |                   โ SYN #1  โ โณ
  |                   โ SYN #2  โ โณ
  |                   โ SYN #3  โ โณ
  |                   โ SYN #... โ โณ
  |                   โ FULL!   โ ๐ด
  |                   โโโโโโโโโโโ
```

### ๐ฌ ุงูุชุทุจูู ุงูุนููู (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ููุท)

#### ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุขูุฉ ุงูุชุฑุงุถูุฉ ููููุงุฌู (Kali Linux)
- ุฎุงุฏู ุงุฎุชุจุงุฑ ูุนุฒูู
- ุดุจูุฉ ูุญููุฉ ููุนุฒูุฉ ุชูุงูุงู

#### ุงูุฃุฏุงุฉ: hping3

**ุงูุชุซุจูุช:**
```bash
sudo apt update
sudo apt install hping3
```

**ุงููุฌูู ุงูุฃุณุงุณู:**
```bash
sudo hping3 -S -p 80 --flood TARGET_IP
```

**ุงูุดุฑุญ:**
- `-S`: ุฅุฑุณุงู ุญุฒู SYN ููุท
- `-p 80`: ุงุณุชูุฏุงู ุงููููุฐ 80 (HTTP)
- `--flood`: ุฅุฑุณุงู ุฃุณุฑุน ูุง ูููู (ุจุฏูู ุงูุชุธุงุฑ)
- `TARGET_IP`: ุนููุงู ุงูุฎุงุฏู ุงููุณุชูุฏู

**ูุฌูู ูุชูุฏู ูุน ุนูุงููู ูุฒููุฉ:**
```bash
sudo hping3 -S -p 80 --flood --rand-source TARGET_IP
```

- `--rand-source`: ุนูุงููู IP ูุตุฏุฑ ุนุดูุงุฆูุฉ
- ููุตุนูุจ ุชุชุจุน ุงูููุงุฌู
- ูุชุฌุงูุฒ ุจุนุถ ุขููุงุช ุงูุญูุงูุฉ ุงูุจุณูุทุฉ

### ๐ ุงููุฑุงูุจุฉ ุนูู ุงูุฎุงุฏู ุงููุณุชูุฏู

#### ุนุฑุถ ุงูุงุชุตุงูุงุช ูุตู ุงูููุชูุญุฉ

```bash
netstat -ant | grep SYN_RECV
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ ุฃุซูุงุก ุงููุฌูู:**
```
tcp    0    0 192.168.1.50:80    10.0.0.100:45123    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.101:45124    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.102:45125    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.103:45126    SYN_RECV
... (ูุฆุงุช ุฃู ุขูุงู ุงูุณุทูุฑ)
```

#### ูุฑุงูุจุฉ ุงุณุชููุงู ุงูููุงุฑุฏ

```bash
# ุนุฑุถ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
ss -tan | grep SYN-RECV | wc -l

# ูุฑุงูุจุฉ ุงูุฐุงูุฑุฉ
free -h

# ูุฑุงูุจุฉ CPU
top
```

**ูุคุดุฑุงุช ุงููุฌูู:**
```
SYN-RECV connections: 5000+  ๐ด (ุทุจูุนู: < 100)
Memory usage: 95%             ๐ด (ุทุจูุนู: < 70%)
CPU load: 100%                ๐ด (ุทุจูุนู: < 50%)
```

### ๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ

#### 1. SYN Cookies

**ุชูุนูู SYN Cookies ุนูู Linux:**
```bash
# ุงูุชุญูู ูู ุงูุญุงูุฉ ุงูุญุงููุฉ
cat /proc/sys/net/ipv4/tcp_syncookies

# ุงูุชูุนูู (1 = enabled)
sudo sysctl -w net.ipv4.tcp_syncookies=1

# ุฌุนูู ุฏุงุฆูุงู
echo "net.ipv4.tcp_syncookies = 1" | sudo tee -a /etc/sysctl.conf
```

**ููู ุชุนูู:**
```
ุจุฏูุงู ูู ุชุฎุฒูู ุงูุงุชุตุงู ูู ุงูุฐุงูุฑุฉ:
1. ุงูุฎุงุฏู ูุญุณุจ ูููุฉ ูุดูุฑุฉ (cookie)
2. ููุฑุณููุง ูู SYN-ACK
3. ูุง ูุญูุธ ุดูุก ูู ุงูุฐุงูุฑุฉ
4. ุนูุฏ ุงุณุชูุงู ACKุ ูุชุญูู ูู ุงูู cookie
5. ุฅู ุตุญุ ููููู ุงูุงุชุตุงู

ุงููุชูุฌุฉ: ูุง ุงุณุชูุฒุงู ููุฐุงูุฑุฉ โ
```

#### 2. ุชุญุฏูุฏ ูุนุฏู ุงูุงุชุตุงูุงุช ุงูุฌุฏูุฏุฉ

**ุจุงุณุชุฎุฏุงู iptables:**
```bash
# ุงูุณูุงุญ ุจู 5 ุงุชุตุงูุงุช ุฌุฏูุฏุฉ ููุท ูู ุงูุซุงููุฉ ูู ููุณ IP
iptables -A INPUT -p tcp --syn -m limit --limit 5/s --limit-burst 10 -j ACCEPT
iptables -A INPUT -p tcp --syn -j DROP
```

**ุจุงุณุชุฎุฏุงู nftables:**
```bash
nft add rule ip filter input tcp flags syn ct state new limit rate 5/second accept
```

#### 3. ุฒูุงุฏุฉ ุญุฌู ูุงุฆูุฉ SYN

```bash
# ุฒูุงุฏุฉ ุงูุญุฏ ุงูุฃูุตู ููุงุชุตุงูุงุช ูุตู ุงูููุชูุญุฉ
sudo sysctl -w net.ipv4.tcp_max_syn_backlog=4096

# ุชูููู ููุช ุงูุงูุชุธุงุฑ
sudo sysctl -w net.ipv4.tcp_synack_retries=2
```

#### 4. ุงุณุชุฎุฏุงู Firewall ูุชูุฏู

**Cisco ASA:**
```cisco
! ุชุญุฏูุฏ ุนุฏุฏ ุงูุงุชุตุงูุงุช ุงููุชุฒุงููุฉ
access-list OUTSIDE_IN extended permit tcp any host 203.0.113.50 eq www
class-map SYN-ATTACK
 match access-list OUTSIDE_IN
policy-map OUTSIDE_POLICY
 class SYN-ATTACK
  set connection conn-max 100 embryonic-conn-max 50
service-policy OUTSIDE_POLICY interface outside
```

**pfSense/OPNsense:**
- ุชูุนูู "SYN Proxy"
- ุถุจุท "Maximum States" ู "Maximum Source Nodes"

#### 5. ุงุณุชุฎุฏุงู CDN/DDoS Protection

ุฎุฏูุงุช ูุซู:
- Cloudflare
- AWS Shield
- Akamai

ุชููู ุจู:
- ุงูุชุตุงุต ุงููุฌูุงุช ุงูุถุฎูุฉ
- ุชูุฒูุน ุงูุญูู
- ููุชุฑุฉ ุงูุญุฑูุฉ ุงูุฎุจูุซุฉ

### ๐ ุงูุชุฃุซูุฑ ุนูู ุงูุฎุงุฏู

#### ูุฑุงุญู ุงููุฌูู

**ุงููุฑุญูุฉ 1: ุงูุจุฏุงูุฉ (0-30 ุซุงููุฉ)**
```
SYN Queue: 20% full
Response Time: 100ms โ 500ms
```

**ุงููุฑุญูุฉ 2: ุงูุชุตุนูุฏ (30-60 ุซุงููุฉ)**
```
SYN Queue: 80% full
Response Time: 500ms โ 3000ms
New connections: ุจุทูุฆุฉ ุฌุฏุงู
```

**ุงููุฑุญูุฉ 3: ุงูุงูููุงุฑ (60+ ุซุงููุฉ)**
```
SYN Queue: 100% full
Response Time: timeout
New connections: ูุฑููุถุฉ ุจุงููุงูู
Service: ุบูุฑ ูุชุงุญ ๐ด
```

### ๐ ูุดู ุงููุฌูู

#### ุนูุงูุงุช ุงูุชุญุฐูุฑ

```bash
# ุงุฑุชูุงุน ููุงุฌุฆ ูู SYN_RECV
watch -n 1 'netstat -ant | grep SYN_RECV | wc -l'

# ุชูุจูู ุนูุฏ ุชุฌุงูุฒ ุญุฏ ูุนูู
while true; do
  COUNT=$(netstat -ant | grep SYN_RECV | wc -l)
  if [ $COUNT -gt 1000 ]; then
    echo "โ๏ธ Possible SYN Flood: $COUNT connections"
  fi
  sleep 5
done
```

#### ุชุญููู ุงูุณุฌูุงุช

```bash
# ุนุฑุถ ุฃูุซุฑ IP ูุตุฏุฑูุฉ ูุดุงุทุงู
netstat -ant | grep SYN_RECV | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -nr | head -10
```

### ๐ก ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ

**ูููุฏุงูุนูู:**
1. โ ูุนูู SYN Cookies ุฏุงุฆูุงู
2. โ ุฑุงูุจ ูุนุฏูุงุช ุงูุงุชุตุงู ุจุดูู ูุณุชูุฑ
3. โ ุงุณุชุฎุฏู Firewall ูุน ุฅููุงููุงุช DDoS protection
4. โ ุงุญุชูุธ ุจุฎุทุฉ ุงุณุชุฌุงุจุฉ ุฌุงูุฒุฉ

**ููููุงุฌููู ุงูุฃุฎูุงูููู:**
1. ๐ ุงุญุตู ุนูู ุฅุฐู ุฎุทู ูุจู ุงูุงุฎุชุจุงุฑ
2. ๐ ุงุณุชุฎุฏู ุจูุฆุฉ ูุนุฒููุฉ ุชูุงูุงู
3. โฐ ุญุฏุฏ ูุงูุฐุฉ ุฒูููุฉ ูุญุฏูุฏุฉ ููุงุฎุชุจุงุฑ
4. ๐ ูุซูู ุงููุชุงุฆุฌ ุจุดูู ุงุญุชุฑุงูู

---

## 10. UDP Flood Attack

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุฉ ูุฌูู UDP Flood ูุงููุฑู ุจููู ูุจูู SYN Flood.

### โ๏ธ ุชุญุฐูุฑ ูุงูููู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐จ ูุฐุง ุงููุญุชูู ููุชุนููู ูุงูุฃุจุญุงุซ ุงูุฃูููุฉ ููุท  โ
โ                                                   โ
โ  ุงูููุงู ุจูุฐุง ุงููุฌูู ุฏูู ุฅุฐู ูู:                โ
โ  โข ุฌุฑููุฉ ุฅููุชุฑูููุฉ                              โ
โ  โข ููุนุงูุจ ุนูููุง ุจุงูุณุฌู ูุงูุบุฑุงูุฉ                โ
โ  โข ููุณูุญ ููุท ูู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูููููุฉ ูู         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ุงููุฑู ุจูู TCP ู UDP

| ุงูููุฒุฉ | TCP | UDP |
|--------|-----|-----|
| ุงูุงุชุตุงู | Connection-oriented | Connectionless |
| ุงููุตุงูุญุฉ | ูุนู (3-way handshake) | ูุง |
| ุงูููุซูููุฉ | ูุถููู ุงููุตูู | ุบูุฑ ูุถููู |
| ุงูุณุฑุนุฉ | ุฃุจุทุฃ | ุฃุณุฑุน |
| ุงูุชุฑุชูุจ | ูุฑุชุจ | ุบูุฑ ูุฑุชุจ |

### ๐ฌ ุขููุฉ ูุฌูู UDP Flood

```
Attacker                    Target Server
  |                              |
  |------- UDP Packet ---------->| Port 53 (DNS)
  |------- UDP Packet ---------->| Port 161 (SNMP)
  |------- UDP Packet ---------->| Port 12345 (Random)
  |------- UDP Packet ---------->| Port 9999 (Closed)
  |       (thousands/sec)        |
  |                              |
  |                         [Server Process]
  |                         1. ุชููู ุงูุญุฒูุฉ
  |                         2. ูุญุต ุงููููุฐ
  |                         3. ุงููููุฐ ูุบููุ
  |                         4. ุฅุฑุณุงู ICMP Port Unreachable
  |                              |
  |<---- ICMP Unreachable -------|
  |<---- ICMP Unreachable -------|
  |<---- ICMP Unreachable -------|
  |                              |
  |                    [Result: Resource Exhaustion]
  |                    โข CPU: 100%
  |                    โข Bandwidth: Saturated
  |                    โข Service: Unavailable
```

### ๐ฌ ุงูุชุทุจูู ุงูุนููู (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ููุท)

#### ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุดุจูุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ุชูุงูุงู
- ุฎุงุฏู ุงุฎุชุจุงุฑ ูุฎุตุต
- ุฅุฐู ุฎุทู ููุซู

#### ุงุณุชุฎุฏุงู hping3

**ุงููุฌูู ุงูุฃุณุงุณู:**
```bash
sudo hping3 --udp -p 53 --flood TARGET_IP
```

**ุงูุดุฑุญ:**
- `--udp`: ุงุณุชุฎุฏุงู ุจุฑูุชูููู UDP
- `-p 53`: ุงุณุชูุฏุงู ูููุฐ DNS
- `--flood`: ุฅุฑุณุงู ุจุฃูุตู ุณุฑุนุฉ ููููุฉ

**ูุฌูู ูุน ููุงูุฐ ุนุดูุงุฆูุฉ:**
```bash
sudo hping3 --udp --rand-dest --flood TARGET_IP
```

- `--rand-dest`: ููุงูุฐ ูุฌูุฉ ุนุดูุงุฆูุฉ
- ููุถุนู ุงูุฎุงุฏู ุฃูุซุฑ (ููุญุต ูู ูููุฐ)

**ูุฌูู ูุน ุญุฌู ุญุฒูุฉ ูุจูุฑ:**
```bash
sudo hping3 --udp -p 53 --flood -d 65500 TARGET_IP
```

- `-d 65500`: ุญุฌู ุงูุจูุงูุงุช (ุฃูุตู ุญุฏ ูู UDP)
- ูุณุชููู bandwidth ุฃูุซุฑ

### ๐ ุงููุฑุงูุจุฉ ุนูู ุงูุฎุงุฏู ุงููุณุชูุฏู

#### ุนุฑุถ ุฅุญุตุงุฆูุงุช UDP

```bash
netstat -s | grep UDP
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ ุฃุซูุงุก ุงููุฌูู:**
```
UDP:
    125847 packets received
    98234 packets to unknown port received
    89123 packet receive errors
    45678 packets sent
    RcvbufErrors: 12345
    SndbufErrors: 0
    InErrors: 89123
```

#### ูุฑุงูุจุฉ ุงูุญุฒู ูู ุงูููุช ุงููุนูู

```bash
# ุนุฑุถ ูุนุฏู ุญุฒู UDP
watch -n 1 'netstat -su | grep "packets received"'

# ูุฑุงูุจุฉ ููุงูุฐ ูุญุฏุฏุฉ
tcpdump -i eth0 udp port 53 -nn
```

**ูุคุดุฑุงุช ุงููุฌูู:**
```
UDP packets/sec: 50,000+     ๐ด (ุทุจูุนู: < 1,000)
Port Unreachable: 40,000+    ๐ด (ุทุจูุนู: < 10)
Bandwidth usage: 90%+        ๐ด (ุทุจูุนู: < 50%)
CPU usage: 100%              ๐ด (ุทุจูุนู: < 30%)
```

#### ุชุญุฏูุฏ ุฃูุซุฑ ุงูููุงูุฐ ุงููุณุชูุฏูุฉ

```bash
tcpdump -i eth0 -nn udp -c 1000 | awk '{print $5}' | cut -d'.' -f5 | sort | uniq -c | sort -nr | head -10
```

### ๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ

#### 1. Rate Limiting ุนูู Linux

```bash
# ุชุญุฏูุฏ ูุนุฏู ุญุฒู UDP ูู ูู IP
iptables -A INPUT -p udp -m limit --limit 100/s --limit-burst 200 -j ACCEPT
iptables -A INPUT -p udp -j DROP

# ุญูุงูุฉ ููุงูุฐ ูุญุฏุฏุฉ
iptables -A INPUT -p udp --dport 53 -m limit --limit 50/s -j ACCEPT
iptables -A INPUT -p udp --dport 53 -j DROP
```

#### 2. ุชุนุทูู ICMP Port Unreachable

```bash
# ููุน ุฅุฑุณุงู ุฑุณุงุฆู Port Unreachable
iptables -A OUTPUT -p icmp --icmp-type destination-unreachable -j DROP

# ุฃู ุนุจุฑ sysctl
sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1
```

**ุงููุงุฆุฏุฉ:**
- ูููุฑ ููุงุฑุฏ CPU
- ูููุน ุงุณุชูุฒุงู bandwidth ุจุงูุฑุฏูุฏ

#### 3. ุญูุงูุฉ ุนูู ูุณุชูู ุงูุฎุงุฏู

```bash
# ุฒูุงุฏุฉ ุญุฌู buffer ููู UDP
sysctl -w net.core.rmem_max=26214400
sysctl -w net.core.rmem_default=26214400

# ุชุญุณูู ูุนุงูุฌุฉ ุงูุญุฒู
sysctl -w net.core.netdev_max_backlog=5000
```

#### 4. Firewall Rules ุนูู Cisco

```cisco
! ุชุญุฏูุฏ ูุนุฏู UDP
access-list 110 permit udp any host 203.0.113.50 eq domain
access-list 110 deny udp any any

interface GigabitEthernet0/0
 ip access-group 110 in
 rate-limit input access-group 110 10000000 1000000 2000000 conform-action transmit exceed-action drop
```

#### 5. ุงุณุชุฎุฏุงู fail2ban

```bash
# ุชุซุจูุช fail2ban
sudo apt install fail2ban

# ุฅูุดุงุก ูุงุนุฏุฉ ูู UDP flood
sudo nano /etc/fail2ban/filter.d/udp-flood.conf
```

**ูุญุชูู ุงูููู:**
```ini
[Definition]
failregex = .*kernel.*UDP.*SRC=<HOST>.*
ignoreregex =
```

**ุงูุชูุนูู:**
```ini
# /etc/fail2ban/jail.local
[udp-flood]
enabled = true
filter = udp-flood
logpath = /var/log/syslog
maxretry = 100
findtime = 60
bantime = 3600
```

### ๐ ุงูููุงูุฐ ุงูุดุงุฆุนุฉ ุงููุณุชูุฏูุฉ

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุณุจุจ ุงูุงุณุชูุฏุงู |
|--------|---------|---------------|
| 53 | DNS | ุญููู ููุดุจูุฉุ ูููุฏ ุงุณุชุฌุงุจุงุช |
| 123 | NTP | ูููู ุชุถุฎููู (Amplification) |
| 161 | SNMP | ุฅุฏุงุฑุฉุ ุบุงูุจุงู ููุชูุญ |
| 1900 | SSDP | UPnPุ ุดุงุฆุน ูู ุงูุฃุฌูุฒุฉ ุงูููุฒููุฉ |
: SHA-512
- `$y# ุชุฏุฑูุจุงุช ุนูููุฉ ูู ุฃูู ุงูุดุจูุงุช
## Network Security - Practical Labs

---

## ๐ ุฌุฏูู ุงููุญุชููุงุช

1. [NAT/PAT - ุชุฑุฌูุฉ ุนูุงููู ุงูุดุจูุฉ](#1-natpat---ุชุฑุฌูุฉ-ุนูุงููู-ุงูุดุจูุฉ)
2. [ACL - ููุงุฆู ุงูุชุญูู ุจุงููุตูู](#2-acl---ููุงุฆู-ุงูุชุญูู-ุจุงููุตูู)
3. [FTP ูุขููุฉ Established](#3-ftp-ูุขููุฉ-established)
4. [WAF ู Load Balancer](#4-waf-ู-load-balancer)
5. [Cisco Firepower - ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ](#5-cisco-firepower---ุชุญููู-ุงูุจุฑูุฌูุงุช-ุงูุฎุจูุซุฉ)
6. [ARP - ุจุฑูุชูููู ุชุญููู ุงูุนูุงููู](#6-arp---ุจุฑูุชูููู-ุชุญููู-ุงูุนูุงููู)
7. [Nmap - ูุณุญ ุงูุดุจูุงุช](#7-nmap---ูุณุญ-ุงูุดุจูุงุช)
8. [ICMP - ุงุฎุชุจุงุฑุงุช ุงูุดุจูุฉ](#8-icmp---ุงุฎุชุจุงุฑุงุช-ุงูุดุจูุฉ)
9. [SYN Flooding Attack](#9-syn-flooding-attack)
10. [UDP Flood Attack](#10-udp-flood-attack)
11. [Nmap Port Scanning](#11-nmap-port-scanning)
12. [John the Ripper - ูุณุฑ ูููุงุช ุงููุฑูุฑ](#12-john-the-ripper---ูุณุฑ-ูููุงุช-ุงููุฑูุฑ)
13. [DHCP Snooping](#13-dhcp-snooping)

---

## 1. NAT/PAT - ุชุฑุฌูุฉ ุนูุงููู ุงูุดุจูุฉ

### ๐ฏ ุงููุฏู
ููู ุขููุฉ ุนูู NAT/PAT ูู ุชุฑุฌูุฉ ุงูุนูุงููู ุงูุฎุงุตุฉ ุฅูู ุนูุงููู ุนุงูุฉ.

### ๐ ุงูุณููุงุฑูู
ุฌูุงุฒ ุฏุงุฎูู ุจุนููุงู `10.0.0.5` ูุฑูุฏ ุชุตูุญ ุงูุฅูุชุฑูุช ุนุจุฑ ุฌุฏุงุฑ ูุงุฑู ูุณุชุฎุฏู NAT.

### ๐ ุฎุทูุงุช ุงูุนูู

1. **ุงูุทูุจ ุงูุตุงุฏุฑ:**
   - ุงูุฌูุงุฒ ุงูุฏุงุฎูู `10.0.0.5` ูุฑุณู ุทูุจ HTTP
   - ุงูุฌุฏุงุฑ ุงููุงุฑู ูุชุฑุฌู ุงูุนููุงู ุฅูู `203.0.113.2:10500`
   - ุงูุนููุงู `203.0.113.2` ูู ุงูุนููุงู ุงูุนุงู
   - ุงููููุฐ `10500` ููุณุชุฎุฏู ูุชูููุฒ ุงูุงุชุตุงู

2. **ุงูุฑุฏ ุงููุงุฑุฏ:**
   - ุนูุฏ ูุตูู ุงูุฑุฏ ูู ุงูุฅูุชุฑูุช ุฅูู `203.0.113.2:10500`
   - ูุนูุฏ NAT ุงูุชุฑุฌูุฉ ุงูุนูุณูุฉ ุฅูู `10.0.0.5` ุจุงููููุฐ ุงูุฃุตูู
   - ูุชู ุชุณููู ุงูุจูุงูุงุช ููุฌูุงุฒ ุงูุฏุงุฎูู

### โ ุงููุงุฆุฏุฉ
- ูุฆุงุช ุงูุฃุฌูุฒุฉ ูููููุง ูุดุงุฑูุฉ ุนููุงู ุนุงู ูุงุญุฏ
- ูุง ููุฌุฏ ุชุถุงุฑุจ ุจูุถู ุงุณุชุฎุฏุงู ุฃุฑูุงู ุงูููุงูุฐ (Port Numbers)
- ุชูููุฑ ูู ุนูุงููู IPv4 ุงูุนุงูุฉ

### ๐ ููุงุญุธุงุช
- PAT (Port Address Translation) ูู ููุน ูู NAT
- ููุณูู ุฃูุถุงู NAT Overload
- ุงูุฌุฏูู ุงูุฏุงุฎูู ูุญุชูุธ ุจุงูุฑุจุท ุจูู ุงูุนูุงููู ุงูุฏุงุฎููุฉ ูุงูููุงูุฐ

---

## 2. ACL - ููุงุฆู ุงูุชุญูู ุจุงููุตูู

### ๐ฏ ุงููุฏู
ุชุทุจูู ุณูุงุณุงุช ุฃูููุฉ ุจุงุณุชุฎุฏุงู ููุงุฆู ุงูุชุญูู ุจุงููุตูู (Access Control Lists).

### ๐ ุงูุณููุงุฑูู
ูุฏูู:
- **Web Server** ูู DMZ (Demilitarized Zone)
- **Database Server** ุฏุงุฎู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ

> ๐ก **DMZ:** ููุทูุฉ ููุฒูุนุฉ ุงูุณูุงุญุ ููู ููุทูุฉ ุจูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ูุงูุฅูุชุฑูุช ูุชูููู ุงููุฎุงุทุฑ ุงูุฃูููุฉ.

### ๐ง ุงูุชูููู ุงูุนููู

```cisco
access-list 100 permit tcp any 10.10.10.10 eq www
access-list 100 permit tcp any 10.10.10.10 eq 443
access-list 100 permit tcp any 10.10.10.12 eq ftp
access-list 100 permit tcp any 10.10.10.12 eq ftp-data
access-list 100 deny ip any any log

interface gi0/1
ip access-group 100 in
```

### ๐ ุดุฑุญ ุงูุฃูุงูุฑ

| ุงูุฃูุฑ | ุงููุธููุฉ |
|------|---------|
| `permit tcp any 10.10.10.10 eq www` | ุงูุณูุงุญ ุจุงููุตูู ูุฎุงุฏู ุงูููุจ ุนุจุฑ HTTP (ูููุฐ 80) |
| `permit tcp any 10.10.10.10 eq 443` | ุงูุณูุงุญ ุจุงููุตูู ุนุจุฑ HTTPS (ูููุฐ 443) |
| `permit tcp any 10.10.10.12 eq ftp` | ุงูุณูุงุญ ุจู FTP Control (ูููุฐ 21) |
| `permit tcp any 10.10.10.12 eq ftp-data` | ุงูุณูุงุญ ุจู FTP Data (ูููุฐ 20) |
| `deny ip any any log` | ุญุธุฑ ุฃู ุญุฑูุฉ ุฃุฎุฑู ูุน ุงูุชุณุฌูู |
| `ip access-group 100 in` | ุชุทุจูู ุงููุงุฆูุฉ ุนูู ุงููุงุฌูุฉ |

### ๐ฏ ุงููุฏู ุงูุฃููู
- ุงูุณูุงุญ ุจุงููุตูู ููุท ููููุงูุฐ ุงููุทููุจุฉ
- ููุน ุงููุตูู ุงููุจุงุดุฑ ูุฎุงุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชุณุฌูู ุงููุญุงููุงุช ุงููุดุจููุฉ
- ุชูููู ูุทุงู ุงููุฌูู (Attack Surface)

### โ๏ธ ููุงุญุธุงุช ูููุฉ
- ุงููุตูู ููุงุนุฏุฉ ุงูุจูุงูุงุช ูุฌุจ ุฃู ูุชู ููุท ูู ุฎูุงู ุฎุงุฏู ุงูููุจ
- ุชุฑุชูุจ ุงูููุงุนุฏ ููู ุฌุฏุงู (ูู ุงูุฃุนูู ููุฃุณูู)
- ุงููุงุนุฏุฉ ุงูุถูููุฉ ูู ุงูููุงูุฉ: `deny any any`

---

## 3. FTP ูุขููุฉ Established

### ๐ฏ ุงููุฏู
ููู ุงููุฑู ุจูู FTP Passive ู Active Mode ูุชุฃุซูุฑู ุนูู ACL.

### ๐ ุจููุฉ FTP
ุจุฑูุชูููู FTP ูุณุชุฎุฏู ููุงุชูู ูููุตูุชูู:
- **Port 21:** ููุงุฉ ุงูุชุญูู (Control Channel)
- **Port 20:** ููุงุฉ ุงูุจูุงูุงุช (Data Channel)

### ๐ FTP Passive Mode

```
[Client] -----> [Server]
         Port 21 (Control)
         
[Client] <----- [Server]
         Random High Port (Data)
```

**ุขููุฉ ุงูุนูู:**
1. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุชุญูู ูุญู ุงููููุฐ 21
2. ุงูุนููู ูุทูุจ ูุถุน Passive
3. ุงูุฎุงุฏู ูุฑุฏ ุจูููุฐ ุนุดูุงุฆู ุนุงูู
4. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุจูุงูุงุช ูุญู ูุฐุง ุงููููุฐ
5. ูู ุงูุฑุฏูุฏ ุชุญุชูู ุนูู ุจุช ACK โ **ูุณููุญ ุจูุง** โ

### ๐ FTP Active Mode

```
[Client] -----> [Server]
         Port 21 (Control)
         
[Client] <----- [Server]
         Port 20 (Data initiated by server)
```

**ุขููุฉ ุงูุนูู:**
1. ุงูุนููู ููุชุญ ุงุชุตุงู ุงูุชุญูู ูุญู ุงููููุฐ 21
2. ุงูุนููู ูุฎุจุฑ ุงูุฎุงุฏู ุจูููุฐ ูุนูู ูุงุณุชูุจุงู ุงูุจูุงูุงุช
3. **ุงูุฎุงุฏู ูุจุฏุฃ ุงุชุตุงู ุงูุจูุงูุงุช** ูู ุงููููุฐ 20
4. ุฃูู ุญุฒูุฉ ูู ุงูุฎุงุฏู ุชุญุชูู ุนูู SYN ููุท โ **ุชูุฑูุถ** ๐ซ

### โ๏ธ ุงููุดููุฉ ูุน Established

```cisco
access-list 110 permit tcp any any established
```

ูุฐู ุงููุงุนุฏุฉ ุชุณูุญ ููุท ุจุงูุญุฒู ุงูุชู ุชุญุชูู ุนูู:
- ุจุช ACK
- ุฃู ุจุช RST

**ุงููุชูุฌุฉ:**
- ูู Active Modeุ ุงูุฎุงุฏู ูุฑุณู SYN ุฃููุงู
- ูุฐู ุงูุญุฒูุฉ ูุง ุชุญูู ุดุฑุท "established"
- ุงูุงุชุตุงู ููุดู ๐ซ

### โ ุงูุญู ุงูุฃูุซู
ุงุณุชุฎุฏุงู ุฌุฏุงุฑ ูุงุฑู ุญูููู (Stateful Firewall) ูุงุฏุฑ ุนูู:
- ุชุชุจุน ุงูุฌูุณุงุช ุงููุดุทุฉ
- ููู ุงูุจุฑูุชููููุงุช ุงููุนูุฏุฉ ูุซู FTP
- ุงูุณูุงุญ ุจุงูุงุชุตุงูุงุช ุงูุฏููุงููููุฉ ุชููุงุฆูุงู

### ๐ ุงูุฎูุงุตุฉ
- `established` ูุง ูููู ููุจุฑูุชููููุงุช ุงููุนูุฏุฉ
- FTP Passive Mode ุฃูุซุฑ ุชูุงููุงู ูุน ุงูุฌุฏุฑุงู ุงููุงุฑูุฉ
- Stateful Firewalls ุถุฑูุฑูุฉ ููุจูุฆุงุช ุงูุฅูุชุงุฌูุฉ

---

## 4. WAF ู Load Balancer

### ๐ฏ ุงููุฏู
ุจูุงุก ุจููุฉ ุชุญุชูุฉ ุขููุฉ ููุงุจูุฉ ููุชูุณุน ููููุน ููุจ.

### ๐ ุงูุณููุงุฑูู
ูููุน ููุจ ูุญุชูู ุนูู ุนุฏุฉ ุฎูุงุฏู Web Servers ุฎูู Load Balancerุ ูุน ุญูุงูุฉ ูู ูุฌูุงุช XSS.

### ๐๏ธ ุงูุจููุฉ ุงููุนูุงุฑูุฉ

```
[Internet]
    |
    โ
[WAF - Web Application Firewall]
    |
    โ
[Load Balancer]
    |
    โ------------------โ------------------โ------------------โ
[Web Server 1]   [Web Server 2]   [Web Server 3]   [Web Server 4]
```

### โ๏ธ ููุงู Load Balancer

**ุฎูุงุฑุฒููุฉ ุงูุชูุฒูุน:**
- **Round Robin:** ุชูุฒูุน ูุชุณุงูู ุนูู ุฌููุน ุงูุฎูุงุฏู
- ุฏูุฑุฉ ููุชุธูุฉ: Server 1 โ Server 2 โ Server 3 โ Server 4 โ ุชูุฑุงุฑ

**ุฅุฏุงุฑุฉ ุงูุฃุนุทุงู:**
1. ูุฑุงูุจุฉ ุตุญุฉ ุงูุฎูุงุฏู (Health Checks)
2. ุนูุฏ ูุดู ุฃุญุฏ ุงูุฎูุงุฏู:
   - ุฅุฒุงูุชู ูู ูุงุฆูุฉ ุงูุชูุฒูุน ุชููุงุฆูุงู
   - ุชุญููู ุทูุจุงุชู ุฅูู ุงูุฎูุงุฏู ุงูุณูููุฉ
3. ุนูุฏ ุนูุฏุฉ ุงูุฎุงุฏู: ุฅุนุงุฏุฉ ุฅุฏุฑุงุฌู ุชููุงุฆูุงู

### ๐ก๏ธ ููุงู WAF (ูู Reverse Proxy)

**ุงูุญูุงูุฉ ูู XSS:**
```javascript
// ูุซุงู ุนูู ูุญุงููุฉ ูุฌูู XSS
<script>alert('XSS Attack')</script>
```

**ุขููุฉ ุงูุญูุงูุฉ:**
1. ูุญุต ูู ุทูุจ HTTP ูุจู ูุตููู ููุฎูุงุฏู
2. ูุดู ุงูุดููุฑุงุช ุงูุฎุจูุซุฉ:
   - JavaScript ูุดุจูู
   - SQL Injection
   - Command Injection
3. ููุน ุงูุทูุจุงุช ุงููุดุจููุฉ ููุฑุงู โ
4. ููุน ุชุณุฑูุจ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุงูุงุณุชุฌุงุจุงุช

### ๐ ุณูุงุณุงุช ุงูุฃูุงู

| ููุน ุงูุญูุงูุฉ | ุงููุธููุฉ |
|-------------|---------|
| XSS Prevention | ููุน ุญูู JavaScript |
| SQL Injection | ุญูุงูุฉ ููุงุนุฏ ุงูุจูุงูุงุช |
| CSRF Protection | ููุน ุงูุทูุจุงุช ุงููุฒูุฑุฉ |
| Rate Limiting | ุงูุญุฏ ูู ูุนุฏู ุงูุทูุจุงุช |
| IP Blacklisting | ุญุธุฑ IP ุงููุดุจููุฉ |

### โ ุงููุฒุงูุง ุงููุญููุฉ

**ุงูุฃุฏุงุก:**
- โก ุชูุฒูุน ุงูุฃุญูุงู ุจุดูู ูุชูุงุฒู
- ๐ ุชุญูู ุงูุฃุนุทุงู (Fault Tolerance)
- ๐ ูุงุจููุฉ ุงูุชูุณุน ุงูุฃููู

**ุงูุฃูุงู:**
- ๐ก๏ธ ุญูุงูุฉ ูุชูุฏูุฉ ูู WAF
- ๐ ูุญุต ุฌููุน ุงูุทูุจุงุช
- ๐ ุชุณุฌูู ุงููุญุงููุงุช ุงููุดุจููุฉ
- ๐ซ ุญุธุฑ ุงููุฌูุงุช ูู ุงูููุช ุงูุญูููู

### ๐ ูุซุงู ุนูู ุณุฌูุงุช WAF

```
2025-10-26 10:15:32 | BLOCKED | XSS Attempt | IP: 192.168.1.100
2025-10-26 10:16:45 | BLOCKED | SQL Injection | IP: 10.0.0.50
2025-10-26 10:17:12 | ALLOWED | Normal Request | IP: 172.16.0.25
```

---

## 5. Cisco Firepower - ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ

### ๐ฏ ุงููุฏู
ููู ููููุฉ ุนูู ุฃูุธูุฉ ูุดู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ ุงููุชูุฏูุฉ ูุชุชุจุน ุงูุชุดุงุฑูุง.

### ๐ ุงูุณููุงุฑูู
ููู ุจุงุณู `tool.exe` ุชู ุงูุชุดุงูู ุถูู ุญุฑูุฉ ุงููุฑูุฑ ุนูู ุงูุดุจูุฉ.

### ๐ ูุฑุงุญู ุงููุดู ูุงูุชุญููู

#### ุงููุฑุญูุฉ 1: ุงููุญุต ุงูุฃููู
1. **ุงุนุชุฑุงุถ ุงูููู:** ุฌูุงุฒ Cisco Firepower ููุญุต ุฌููุน ุงููููุงุช ุงููุงุฑุฉ
2. **ุญุณุงุจ ุงูุจุตูุฉ:** ุงุณุชุฎุฑุงุฌ ุจุตูุฉ SHA-256 ููููู
   ```
   SHA-256: a3f7b8c9d2e1f4a6b5c8d7e9f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0
   ```
3. **ุงูููุงุฑูุฉ:** ููุงุฑูุฉ ุงูุจุตูุฉ ูุน ูุงุนุฏุฉ ุจูุงูุงุช ุงูุชูุฏูุฏุงุช

#### ุงููุฑุญูุฉ 2: ุงูุชุตููู
```
Status: โ๏ธ MALWARE DETECTED
Threat Name: Generic.Trojan.Downloader
Threat Score: 95/100 (High)
Category: Trojan
First Seen: 2025-10-25 14:30:22
```

#### ุงููุฑุญูุฉ 3: ุชุญุฏูุฏ ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ
ุงูุฃุฌูุฒุฉ ุงูุชุงููุฉ ุชู ุชุญุฏูุฏูุง ููุตุงุจุฉ:
- ๐ฅ๏ธ `192.168.10.90`
- ๐ฅ๏ธ `192.168.133.50`

### ๐ Trajectory Map (ุฎุฑูุทุฉ ุงููุณุงุฑ)

```
Time โ
Device 1: --------[*]==========[*]-------
                   โ            โ
Device 2: --------[*]----[*]----[*]------
                         โ      โ
Device 3: ---------------[*]=====[*]-----
```

**ุฑููุฒ ุงูุฎุฑูุทุฉ:**
- `[*]` ููุทุฉ ุงูุชูุงู ุงูููู
- `=` ูุชุฑุฉ ูุดุงุท ุงูููู ุนูู ุงูุฌูุงุฒ
- `โ` ุงุชุฌุงู ุงูุชูุงู ุงูุนุฏูู (ูู ุฌูุงุฒ ูุขุฎุฑ)
- `-` ูุชุฑุฉ ุฎููู

### ๐ ุฌุฏูู ุงูุฃุญุฏุงุซ (Events Table)

| ุงูููุช | ุงูุฌูุงุฒ ุงููุตุฏุฑ | ุงูุฌูุงุฒ ุงููุฏู | ุงูุญุฏุซ | ุงูุญุงูุฉ |
|------|---------------|--------------|--------|--------|
| 14:30:22 | External | 192.168.10.90 | File Download | Infected |
| 14:35:18 | 192.168.10.90 | 192.168.133.50 | File Transfer | Infected |
| 14:42:33 | 192.168.133.50 | Network Share | Propagation Attempt | Blocked |

### ๐ฏ ุงุณุชุฎุฏุงูุงุช Trajectory Map

1. **ุชุญุฏูุฏ ุงููุตุฏุฑ ุงูุฃููู:**
   - ุฃูู ุฌูุงุฒ ุชููู ุงูููู
   - ููุทุฉ ุงูุฏุฎูู ุฅูู ุงูุดุจูุฉ

2. **ุชุชุจุน ูุณุงุฑ ุงูุงูุชุดุงุฑ:**
   - ุงูุฃุฌูุฒุฉ ุงููุณูุทุฉ
   - ุทุฑู ุงูุงูุชูุงู ุงููุณุชุฎุฏูุฉ

3. **ุชูููู ูุทุงู ุงูุฅุตุงุจุฉ:**
   - ุนุฏุฏ ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ
   - ุงูุฃูุณุงู ุงููุชุฃุซุฑุฉ

4. **ุงูุชุฎุทูุท ููุงุณุชุฌุงุจุฉ:**
   - ุฃููููุฉ ุงููุนุงูุฌุฉ
   - ุฎุทุฉ ุงูุนุฒู ูุงูุฅุฒุงูุฉ

### ๐จ ุฎุทุฉ ุงูุงุณุชุฌุงุจุฉ ููุญุงุฏุซ

**ุงูุฎุทูุงุช ุงูููุฑูุฉ:**
1. โ ุนุฒู ุงูุฃุฌูุฒุฉ ุงููุตุงุจุฉ ุนู ุงูุดุจูุฉ
2. โ ุญุธุฑ ุจุตูุฉ ุงูููู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
3. โ ูุญุต ุดุงูู ููุฃุฌูุฒุฉ ุงููุฌุงูุฑุฉ
4. โ ุชุญููู ุณุฌูุงุช ุงููุดุงุท

**ุงูุฅุฌุฑุงุกุงุช ุงูุชุตุญูุญูุฉ:**
1. ๐ง ุฅุฒุงูุฉ ุงูุจุฑูุฌูุฉ ุงูุฎุจูุซุฉ
2. ๐ง ุชุญุฏูุซ ุชุนุฑููุงุช ููุงูุญ ุงูููุฑูุณุงุช
3. ๐ง ุชุตุญูุญ ุงูุซุบุฑุงุช ุงููุณุชุบูุฉ
4. ๐ง ุงุณุชุนุงุฏุฉ ุงููุธุงู ูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุธููุฉ

**ุงููุชุงุจุนุฉ:**
1. ๐ ุชูุซูู ุงูุญุงุฏุซ
2. ๐ ุชุญุฏูุซ ุงูุณูุงุณุงุช ุงูุฃูููุฉ
3. ๐ ุชุฏุฑูุจ ุงููุณุชุฎุฏููู
4. ๐ ูุฑุงูุจุฉ ูุนุฒุฒุฉ ููุชุฑุฉ

### ๐ก ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ
- ุฃูููุฉ ุงููุญุต ุงูุนููู ูุญุฑูุฉ ุงููุฑูุฑ
- ุถุฑูุฑุฉ ุงูุชุณุฌูู ุงูุดุงูู ููุฃุญุฏุงุซ
- ูููุฉ ุฃุฏูุงุช ุงูุชุญููู ุงูุจุตุฑู
- ุฃูููุฉ ุงูุงุณุชุฌุงุจุฉ ุงูุณุฑูุนุฉ

---

## 6. ARP - ุจุฑูุชูููู ุชุญููู ุงูุนูุงููู

### ๐ฏ ุงููุฏู
ููู ุขููุฉ ุนูู ุจุฑูุชูููู ARP ููุฑุงูุจุฉ ุงูุฌุฏูู ุงูุฎุงุต ุจู.

### ๐ ูุธุฑุฉ ุนุงูุฉ
ARP (Address Resolution Protocol) ูุฑุจุท ุจูู:
- **ุนููุงู IP** (Layer 3)
- **ุนููุงู MAC** (Layer 2)

### ๐ ุงูุชุทุจูู ุงูุนููู

#### ุงูุฎุทูุฉ 1: ุนุฑุถ ุฌุฏูู ARP

**ุนูู Windows:**
```cmd
arp -a
```

**ุนูู Linux/macOS:**
```bash
arp -a
```

#### ุงูุฎุทูุฉ 2: ูุฑุงุกุฉ ุงููุชุงุฆุฌ

```
Interface: 192.168.1.100 --- 0x4
  Internet Address      Physical Address      Type
  192.168.1.1          00-1A-2B-3C-4D-5E     dynamic
  192.168.1.10         00-AA-BB-CC-DD-EE     dynamic
  192.168.1.255        FF-FF-FF-FF-FF-FF     static
  224.0.0.22           01-00-5E-00-00-16     static
```

### ๐ ุชุญููู ุงูุฌุฏูู

| ุงููููู | ุงูุดุฑุญ |
|--------|--------|
| **Internet Address** | ุนููุงู IP ููุฌูุงุฒ |
| **Physical Address** | ุนููุงู MAC ููุฌูุงุฒ |
| **Type** | ููุน ุงูุฅุฏุฎุงู |

### ๐ท๏ธ ุฃููุงุน ุงูุฅุฏุฎุงูุงุช

**Dynamic:**
- ูุชู ุชุนููู ุชููุงุฆูุงู ูู ุญุฑูุฉ ุงููุฑูุฑ
- ููุญุฐู ุจุนุฏ ูุชุฑุฉ ุนุฏู ุงููุดุงุท (ุนุงุฏุฉ 2-10 ุฏูุงุฆู)
- ุงูุฃูุซุฑ ุดููุนุงู ูู ุงูุดุจูุงุช

**Static:**
- ูุชู ุฅุถุงูุชู ูุฏููุงู ุจูุงุณุทุฉ ุงููุฏูุฑ
- ูุง ููุญุฐู ุชููุงุฆูุงู
- ููุณุชุฎุฏู ููุฃุฌูุฒุฉ ุงูุญุณุงุณุฉ

### ๐ ุนูุงููู ุฎุงุตุฉ

**Broadcast:**
```
192.168.1.255 โ FF-FF-FF-FF-FF-FF
```
- ููุฑุณู ูุฌููุน ุงูุฃุฌูุฒุฉ ูู ุงูุดุจูุฉ

**Multicast:**
```
224.0.0.22 โ 01-00-5E-00-00-16
```
- ููุฑุณู ููุฌููุนุฉ ูุญุฏุฏุฉ ูู ุงูุฃุฌูุฒุฉ

### ๐งน ูุณุญ ุงููุงุด

**ูุณุญ ุฌููุน ุงูุฅุฏุฎุงูุงุช (Windows):**
```cmd
arp -d *
```

**ูุณุญ ุฅุฏุฎุงู ูุญุฏุฏ:**
```cmd
arp -d 192.168.1.10
```

**ุนูู Linux:**
```bash
sudo ip -s -s neigh flush all
```

### ๐ ุฅุถุงูุฉ ุฅุฏุฎุงู ุซุงุจุช

**Windows:**
```cmd
arp -s 192.168.1.50 00-11-22-33-44-55
```

**Linux:**
```bash
sudo arp -s 192.168.1.50 00:11:22:33:44:55
```

### ๐ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

**1. ุชุดุฎูุต ูุดุงูู ุงูุงุชุตุงู:**
```bash
# ูุญุต ูุฌูุฏ ุงูุฌูุงุฒ ูู ุงูุฌุฏูู
arp -a | grep 192.168.1.10

# ุฅุฐุง ูู ูุธูุฑุ ุงููุดููุฉ ูุฏ ุชููู ูู Layer 2
```

**2. ูุดู ุชุถุงุฑุจ IP:**
```bash
# ุฅุฐุง ุธูุฑ ููุณ IP ุจุนููุงูู MAC ูุฎุชูููู
192.168.1.50    00-AA-BB-CC-DD-EE
192.168.1.50    00-11-22-33-44-55  # โ๏ธ ุชุถุงุฑุจ!
```

**3. ูุฑุงูุจุฉ ุงูุฃุฌูุฒุฉ ุงููุดุทุฉ:**
```bash
# ุนุฏ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ
arp -a | grep dynamic | wc -l
```

### โ๏ธ ููุงุญุธุงุช ุฃูููุฉ

**ARP Spoofing/Poisoning:**
- ููุงุฌู ูุฑุณู ุฑุณุงุฆู ARP ูุฒููุฉ
- ูุฎุฏุน ุงูุฃุฌูุฒุฉ ูุฅุฑุณุงู ุงูุจูุงูุงุช ูู
- **ุงูุญูุงูุฉ:** ARP Inspection ุนูู ุงูุณููุชุดุงุช

**ุงูููุงูุฉ:**
```cisco
# ุชูุนูู Dynamic ARP Inspection
Switch(config)# ip arp inspection vlan 10
Switch(config)# interface gi0/1
Switch(config-if)# ip arp inspection trust
```

### ๐ก ูุตุงุฆุญ ุนูููุฉ
- ุฑุงูุจ ุฌุฏูู ARP ุจุดูู ุฏูุฑู
- ุงูุชุจู ููุชุบููุฑุงุช ุงูููุงุฌุฆุฉ ูู ุนูุงููู MAC
- ุงุณุชุฎุฏู ุฅุฏุฎุงูุงุช ุซุงุจุชุฉ ููุฃุฌูุฒุฉ ุงูุญุณุงุณุฉ
- ูุนูู ARP Inspection ูู ุงูุจูุฆุงุช ุงูุญุณุงุณุฉ

---

## 7. Nmap - ูุณุญ ุงูุดุจูุงุช

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู Nmap ูุงูุชุดุงู ุงูุฃุฌูุฒุฉ ูุงูุฎุฏูุงุช ุงููุดุทุฉ ุนูู ุงูุดุจูุฉ.

### ๐ ุงููุชุทูุจุงุช
- ูุธุงู Linux (ููุถู Kali Linux)
- ุตูุงุญูุงุช root ูููุณุญ ุงููุชูุฏู
- **ุจูุฆุฉ ุงุฎุชุจุงุฑูุฉ ููุท** โ๏ธ

### ๐ ุฃููุงุน ุงููุณุญ

#### 1. ุงูุชุดุงู ุงูุฃุฌูุฒุฉ ุงููุดุทุฉ (Host Discovery)

```bash
nmap -sn 192.168.1.0/24
```

**ุงูุดุฑุญ:**
- `-sn`: Ping Scan (ุจุฏูู ูุญุต ุงูููุงูุฐ)
- ูุณุชุฎุฏู ICMP Echo Request
- ููุธูุฑ ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ ูุงููุดุทุฉ

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
Starting Nmap 7.94
Nmap scan report for 192.168.1.1
Host is up (0.0012s latency).

Nmap scan report for 192.168.1.50
Host is up (0.0034s latency).

Nmap scan report for 192.168.1.100
Host is up (0.0028s latency).

Nmap done: 256 IP addresses (3 hosts up) scanned in 2.85 seconds
```

#### 2. ูุญุต ุงูููุงูุฐ (Port Scanning)

**Basic TCP Scan:**
```bash
nmap 192.168.1.50
```

**Comprehensive Scan:**
```bash
nmap -sS -sV -O 192.168.1.50
```

**ุงูุดุฑุญ:**
- `-sS`: SYN Stealth Scan (ุฃูู ูุงุจููุฉ ูููุดู)
- `-sV`: ูุดู ุฅุตุฏุงุฑุงุช ุงูุฎุฏูุงุช
- `-O`: ุชุฎููู ูุธุงู ุงูุชุดุบูู

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PORT     STATE SERVICE    VERSION
21/tcp   open  ftp        vsftpd 3.0.3
22/tcp   open  ssh        OpenSSH 8.2p1
80/tcp   open  http       Apache httpd 2.4.41
443/tcp  open  ssl/http   Apache httpd 2.4.41
3306/tcp open  mysql      MySQL 5.7.33

OS details: Linux 3.2 - 4.9
```

#### 3. ูุญุต ุฌููุน ุงูููุงูุฐ

```bash
nmap -p- 192.168.1.50
```

- `-p-`: ูุญุต ุฌููุน ุงูููุงูุฐ (1-65535)
- ูุณุชุบุฑู ููุชุงู ุฃุทูู

#### 4. ูุญุต ููุงูุฐ ูุญุฏุฏุฉ

```bash
nmap -p 21,22,80,443,3306 192.168.1.50
```

### ๐ญ ุฃููุงุน ูุณุญ ุงูููุงูุฐ

#### TCP SYN Scan (ุงูุฃูุซุฑ ุดููุนุงู)
```bash
nmap -sS 192.168.1.50
```
- ูุฑุณู SYN ููุท
- ูุง ููููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ุฃูู ูุงุจููุฉ ูููุดู

#### TCP Connect Scan
```bash
nmap -sT 192.168.1.50
```
- ููููู ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ
- ูุง ูุญุชุงุฌ ุตูุงุญูุงุช root
- ุฃูุซุฑ ูุงุจููุฉ ูููุดู

#### UDP Scan
```bash
nmap -sU 192.168.1.50
```
- ูุญุต ููุงูุฐ UDP
- ุจุทูุก ุฌุฏุงู
- ููู ูุฎุฏูุงุช ูุซู DNS, DHCP

### ๐ฌ ูุญุต ุงูุซุบุฑุงุช

```bash
nmap --script vuln 192.168.1.50
```

ูุณุชุฎุฏู NSE (Nmap Scripting Engine) ููุจุญุซ ุนู ุซุบุฑุงุช ูุนุฑููุฉ.

### ๐ ุชูููู ุงููุฎุงุทุฑ

#### ููุงูุฐ ุนุงููุฉ ุงูุฎุทูุฑุฉ:

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุงูุฎุทุฑ |
|--------|---------|-------|
| 21 | FTP | ููู ุจูุงูุงุช ุจุฏูู ุชุดููุฑ |
| 23 | Telnet | ุฅุฏุงุฑุฉ ุนู ุจุนุฏ ุจุฏูู ุชุดููุฑ |
| 445 | SMB | ุนุฑุถุฉ ููุฌูุงุช WannaCry ูุบูุฑูุง |
| 3389 | RDP | ูุฏู ุดุงุฆุน ูููุฌูุงุช |
| 1433 | MSSQL | ูุงุนุฏุฉ ุจูุงูุงุช ูุฏ ุชููู ุนุฑุถุฉ |

### ๐ก๏ธ ุงูุญูุงูุฉ ูู Nmap

**1. ุนูู ูุณุชูู ุงูุฌุฏุงุฑ ุงููุงุฑู:**
```cisco
# ุฑูุถ ุงููุณุญ ูู ูุตุงุฏุฑ ุฎุงุฑุฌูุฉ
access-list 100 deny tcp any any range 1 1024
```

**2. ุนูู ูุณุชูู ุงูุฎุงุฏู:**
```bash
# ุงุณุชุฎุฏุงู iptables ูููุน ุงููุณุญ
iptables -A INPUT -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT
```

**3. ุฃุฏูุงุช ูุดู ุงููุณุญ:**
```bash
# ุชุซุจูุช portsentry
sudo apt install portsentry

# ูุฑุงูุจุฉ ูุญุงููุงุช ุงููุณุญ
tail -f /var/log/syslog | grep portsentry
```

### ๐ก ูุตุงุฆุญ ููุงุณุชุฎุฏุงู ุงูุขูู
- โ๏ธ **ูุง ุชูู ุจูุณุญ ุดุจูุงุช ูุง ุชููููุง**
- ๐ ุงุญุตู ุนูู ุฅุฐู ุฎุทู ูุจู ุฃู ุงุฎุชุจุงุฑ ุงุฎุชุฑุงู
- ๐ ุงุณุชุฎุฏู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ููุชุฏุฑูุจ
- ๐ ูุซูู ุฌููุน ุนูููุงุช ุงููุณุญ ููุชุงุฆุฌูุง

### ๐ ุฃูุซูุฉ ุชุนููููุฉ ุฅุถุงููุฉ

**ูุณุญ ุณุฑูุน ูุฃูู 100 ูููุฐ:**
```bash
nmap --top-ports 100 192.168.1.50
```

**ูุณุญ ูุน ุชุฌูุจ ุงููุดู:**
```bash
nmap -sS -T2 -f 192.168.1.50
```
- `-T2`: ุณุฑุนุฉ ุจุทูุฆุฉ (ุฃูู ุฅุฒุนุงุฌุงู)
- `-f`: ุชุฌุฒุฆุฉ ุงูุญุฒู

**ุญูุธ ุงููุชุงุฆุฌ:**
```bash
nmap -oN results.txt 192.168.1.50
nmap -oX results.xml 192.168.1.50
```

---

## 8. ICMP - ุงุฎุชุจุงุฑุงุช ุงูุดุจูุฉ

### ๐ฏ ุงููุฏู
ุงุณุชุฎุฏุงู ุฃุฏูุงุช ICMP ูุชุดุฎูุต ูุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจุงูุดุจูุฉ.

### ๐ ุจุฑูุชูููู ICMP
Internet Control Message Protocol - ุจุฑูุชูููู ุฑุณุงุฆู ุงูุชุญูู ูู ุงูุฅูุชุฑูุช
- Layer 3 Protocol
- ููุณุชุฎุฏู ููุชุดุฎูุต ูุฅุจูุงุบ ุงูุฃุฎุทุงุก
- ูุง ูุญูู ุจูุงูุงุช ุงููุณุชุฎุฏู

### ๐ ุงูุฃูุงูุฑ ุงูุฃุณุงุณูุฉ

#### 1. Ping - ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

**ุงูุงุณุชุฎุฏุงู ุงูุจุณูุท:**
```bash
ping 8.8.8.8
```

**ูุน ุฎูุงุฑุงุช ูุชูุฏูุฉ:**
```bash
# ุฅุฑุณุงู 10 ุญุฒู ููุท
ping -c 10 8.8.8.8

# ุชุบููุฑ ุญุฌู ุงูุญุฒูุฉ
ping -s 1000 8.8.8.8

# ุชุญุฏูุฏ ุงูููุช ุจูู ุงูุญุฒู (ุซุงููุฉ ูุงุญุฏุฉ)
ping -i 1 8.8.8.8
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=116 time=12.4 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=116 time=11.8 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=116 time=12.1 ms

--- 8.8.8.8 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2003ms
rtt min/avg/max/mdev = 11.8/12.1/12.4/0.3 ms
```

#### 2. Traceroute - ุชุชุจุน ุงููุณุงุฑ

**ุนูู Linux:**
```bash
traceroute 8.8.8.8
```

**ุนูู Windows:**
```cmd
tracert 8.8.8.8
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ:**
```
traceroute to 8.8.8.8 (8.8.8.8), 30 hops max, 60 byte packets
 1  192.168.1.1 (192.168.1.1)  1.245 ms  1.123 ms  1.089 ms
 2  10.0.0.1 (10.0.0.1)  8.456 ms  8.234 ms  8.123 ms
 3  172.16.0.1 (172.16.0.1)  15.678 ms  15.456 ms  15.234 ms
 4  * * *
 5  8.8.8.8 (8.8.8.8)  22.345 ms  22.123 ms  21.987 ms
```

**ุงูุชุญููู:**
- ูู ุณุทุฑ ููุซู ููุฌูู (router) ูู ุงููุณุงุฑ
- ุงูุฃุฑูุงู ุงูุซูุงุซุฉ: ุฒูู ุงูุงุณุชุฌุงุจุฉ ูููุญุงููุงุช ุงูุซูุงุซ
- `* * *`: ุงูููุฌูู ูุง ูุณุชุฌูุจ ูุทูุจุงุช ICMP

#### 3. MTR - ุชุชุจุน ูุชูุฏู

```bash
mtr 8.8.8.8
```

ูุฌูุน ุจูู ping ู traceroute ูุน ุฅุญุตุงุฆูุงุช ูุณุชูุฑุฉ:
```
                             Packets               Pings
 Host                      Loss%   Snt   Last   Avg  Best  Wrst StDev
 1. 192.168.1.1             0.0%    10    1.2   1.3   1.1   1.5   0.1
 2. 10.0.0.1                0.0%    10    8.4   8.5   8.1   9.2   0.3
 3. 8.8.8.8                 0.0%    10   22.1  22.3  21.8  23.1   0.4
```

### ๐ ุฃููุงุน ุฑุณุงุฆู ICMP

| ุงูููุน | ุงูุงุณู | ุงูุงุณุชุฎุฏุงู |
|-------|-------|-----------|
| Type 0 | Echo Reply | ุฑุฏ ุนูู Ping |
| Type 3 | Destination Unreachable | ุงููุฌูุฉ ุบูุฑ ูุชุงุญุฉ |
| Type 5 | Redirect | ุฅุนุงุฏุฉ ุชูุฌูู ุงููุณุงุฑ |
| Type 8 | Echo Request | ุทูุจ Ping |
| Type 11 | Time Exceeded | ุงูุชูุงุก TTL (ูุณุชุฎุฏูู traceroute) |

### โ๏ธ ุงุฎุชุจุงุฑุงุช ูุชูุฏูุฉ (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ููุท)

#### ICMP Flood Test

```bash
# โ๏ธ ููุงุฎุชุจุงุฑ ูู ุจูุฆุฉ ูุนุฒููุฉ ููุท
sudo ping -f -s 65500 TARGET_IP
```

**ุงูุดุฑุญ:**
- `-f`: Flood mode (ุฅุฑุณุงู ุณุฑูุน ุฌุฏุงู)
- `-s 65500`: ุญุฌู ุงูุญุฒูุฉ (ุฃูุตู ุญุฏ)
- **ููุณุชุฎุฏู ูุงุฎุชุจุงุฑ ุชุญูู ุงูุดุจูุฉ**

**ุงููุชุงุฆุฌ ุงููุชููุนุฉ:**
```
PING target (192.168.1.50) 65500(65528) bytes of data.
..................................
--- target ping statistics ---
10000 packets transmitted, 9856 received, 1.44% packet loss
```

#### Ping of Death (ุชุงุฑูุฎู)

```bash
# โ๏ธ ูุง ูุนูู ุนูู ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ
ping -s 65510 TARGET_IP
```

**ุงูุฎูููุฉ:**
- ูุงู ููุณุจุจ ุชุนุทู ุงูุฃูุธูุฉ ุงููุฏููุฉ
- ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ ูุญููุฉ ุถุฏู

### ๐ก๏ธ ุงูุญูุงูุฉ ูู ูุฌูุงุช ICMP

#### 1. ุชุญุฏูุฏ ูุนุฏู ICMP

**ุนูู Linux:**
```bash
# ุชุญุฏูุฏ ุนุฏุฏ ุญุฒู ICMP ูู ุงูุซุงููุฉ
iptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT
iptables -A INPUT -p icmp --icmp-type echo-request -j DROP
```

#### 2. ุนูู Cisco Router

```cisco
# ุชุญุฏูุฏ ูุนุฏู ICMP
access-list 100 permit icmp any any echo-reply
access-list 100 deny icmp any any echo-request
interface gi0/0
ip access-group 100 in
rate-limit input access-group 100 1000000 250000 500000 conform-action transmit exceed-action drop
```

#### 3. ุญุธุฑ ICMP ููุงุฆูุงู (ุบูุฑ ูุณุชุญุณู)

```bash
# ููููุฏ ุงููุฏุฑุฉ ุนูู ุงูุชุดุฎูุต
iptables -A INPUT -p icmp -j DROP
```

### ๐ ุญุงูุงุช ุงูุงุณุชุฎุฏุงู ุงูุนูููุฉ

**1. ุชุดุฎูุต ุงููุทุงุน ุงูุงุชุตุงู:**
```bash
# ุฎุทูุฉ ุจุฎุทูุฉ
ping 192.168.1.1  # ุงูุจูุงุจุฉ ุงููุญููุฉ
ping 8.8.8.8      # ุฎุงุฏู ุฎุงุฑุฌู
traceroute 8.8.8.8  # ุชุญุฏูุฏ ููุทุฉ ุงูุงููุทุงุน
```

**2. ููุงุณ ุฌูุฏุฉ ุงูุงุชุตุงู:**
```bash
# ูุฑุงูุจุฉ ููุฏุฉ 5 ุฏูุงุฆู
ping -c 300 -i 1 8.8.8.8 | tee ping_results.txt

# ุชุญููู ุงููุชุงุฆุฌ
grep "time=" ping_results.txt | awk '{print $7}' | sed 's/time=//' | sort -n
```

**3. ุงุฎุชุจุงุฑ MTU (Maximum Transmission Unit):**
```bash
# ุงุจุฏุฃ ุจุญุฌู ูุจูุฑ ููููู ุชุฏุฑูุฌูุงู
ping -M do -s 1472 8.8.8.8

# ุฅุฐุง ูุดูุ ููู ุงูุญุฌู ุญุชู ููุฌุญ
ping -M do -s 1400 8.8.8.8
```

### ๐ก ูุตุงุฆุญ ูููุฉ
- ICMP ููุณ ุขููุงู 100% - ูููู ุงุณุชุฎุฏุงูู ูู ุงููุฌูุงุช
- ุจุนุถ ุงูุดุจูุงุช ุชุญุธุฑ ICMP ููุฃูุงู
- ุงุณุชุฎุฏู ุฃุฏูุงุช ุจุฏููุฉ (TCP ping) ุนูุฏ ุงูุญุงุฌุฉ
- ูุง ุชุนุชูุฏ ุนูู ICMP ููุท ูููุฑุงูุจุฉ

---

## 9. SYN Flooding Attack

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุฉ ูุฌูู SYN Flood ูุชุฃุซูุฑู ุนูู ุงูุฎูุงุฏู.

### โ๏ธ ุชุญุฐูุฑ ููู ุฌุฏุงู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ๏ธ  ูุฐุง ุงููุญุชูู ูุฃุบุฑุงุถ ุชุนููููุฉ ููุท  โ๏ธ       โ
โ                                                  โ
โ  ุชูููุฐ ูุฐุง ุงููุฌูู ุนูู ุฃูุธูุฉ ุญููููุฉ:           โ
โ  โข ุฌุฑููุฉ ูุนุงูุจ ุนูููุง ุงููุงููู                   โ
โ  โข ูุชุทูุจ ุฅุฐู ุฎุทู ูุณุจู                          โ
โ  โข ููุณูุญ ููุท ูู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุฌูู

#### ุงููุตุงูุญุฉ ุงูุซูุงุซูุฉ ุงูุทุจูุนูุฉ (TCP Three-Way Handshake)

```
Client                    Server
  |                         |
  |-------- SYN ---------->|  [1]
  |<----- SYN-ACK ---------|  [2]
  |-------- ACK ---------->|  [3]
  |                         |
  |==== Connection Open ====|
```

#### ูุฌูู SYN Flood

```
Attacker                  Server
  |                         |
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |-------- SYN ---------->|  [1] โ
  |      (thousands)        |
  |                         |
  |   โ No ACK Sent โ    |
  |                         |
  |                    [Server]
  |                   SYN Queue
  |                   โโโโโโโโโโโ
  |                   โ SYN #1  โ โณ
  |                   โ SYN #2  โ โณ
  |                   โ SYN #3  โ โณ
  |                   โ SYN #... โ โณ
  |                   โ FULL!   โ ๐ด
  |                   โโโโโโโโโโโ
```

### ๐ฌ ุงูุชุทุจูู ุงูุนููู (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ููุท)

#### ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุขูุฉ ุงูุชุฑุงุถูุฉ ููููุงุฌู (Kali Linux)
- ุฎุงุฏู ุงุฎุชุจุงุฑ ูุนุฒูู
- ุดุจูุฉ ูุญููุฉ ููุนุฒูุฉ ุชูุงูุงู

#### ุงูุฃุฏุงุฉ: hping3

**ุงูุชุซุจูุช:**
```bash
sudo apt update
sudo apt install hping3
```

**ุงููุฌูู ุงูุฃุณุงุณู:**
```bash
sudo hping3 -S -p 80 --flood TARGET_IP
```

**ุงูุดุฑุญ:**
- `-S`: ุฅุฑุณุงู ุญุฒู SYN ููุท
- `-p 80`: ุงุณุชูุฏุงู ุงููููุฐ 80 (HTTP)
- `--flood`: ุฅุฑุณุงู ุฃุณุฑุน ูุง ูููู (ุจุฏูู ุงูุชุธุงุฑ)
- `TARGET_IP`: ุนููุงู ุงูุฎุงุฏู ุงููุณุชูุฏู

**ูุฌูู ูุชูุฏู ูุน ุนูุงููู ูุฒููุฉ:**
```bash
sudo hping3 -S -p 80 --flood --rand-source TARGET_IP
```

- `--rand-source`: ุนูุงููู IP ูุตุฏุฑ ุนุดูุงุฆูุฉ
- ููุตุนูุจ ุชุชุจุน ุงูููุงุฌู
- ูุชุฌุงูุฒ ุจุนุถ ุขููุงุช ุงูุญูุงูุฉ ุงูุจุณูุทุฉ

### ๐ ุงููุฑุงูุจุฉ ุนูู ุงูุฎุงุฏู ุงููุณุชูุฏู

#### ุนุฑุถ ุงูุงุชุตุงูุงุช ูุตู ุงูููุชูุญุฉ

```bash
netstat -ant | grep SYN_RECV
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ ุฃุซูุงุก ุงููุฌูู:**
```
tcp    0    0 192.168.1.50:80    10.0.0.100:45123    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.101:45124    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.102:45125    SYN_RECV
tcp    0    0 192.168.1.50:80    10.0.0.103:45126    SYN_RECV
... (ูุฆุงุช ุฃู ุขูุงู ุงูุณุทูุฑ)
```

#### ูุฑุงูุจุฉ ุงุณุชููุงู ุงูููุงุฑุฏ

```bash
# ุนุฑุถ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ
ss -tan | grep SYN-RECV | wc -l

# ูุฑุงูุจุฉ ุงูุฐุงูุฑุฉ
free -h

# ูุฑุงูุจุฉ CPU
top
```

**ูุคุดุฑุงุช ุงููุฌูู:**
```
SYN-RECV connections: 5000+  ๐ด (ุทุจูุนู: < 100)
Memory usage: 95%             ๐ด (ุทุจูุนู: < 70%)
CPU load: 100%                ๐ด (ุทุจูุนู: < 50%)
```

### ๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ

#### 1. SYN Cookies

**ุชูุนูู SYN Cookies ุนูู Linux:**
```bash
# ุงูุชุญูู ูู ุงูุญุงูุฉ ุงูุญุงููุฉ
cat /proc/sys/net/ipv4/tcp_syncookies

# ุงูุชูุนูู (1 = enabled)
sudo sysctl -w net.ipv4.tcp_syncookies=1

# ุฌุนูู ุฏุงุฆูุงู
echo "net.ipv4.tcp_syncookies = 1" | sudo tee -a /etc/sysctl.conf
```

**ููู ุชุนูู:**
```
ุจุฏูุงู ูู ุชุฎุฒูู ุงูุงุชุตุงู ูู ุงูุฐุงูุฑุฉ:
1. ุงูุฎุงุฏู ูุญุณุจ ูููุฉ ูุดูุฑุฉ (cookie)
2. ููุฑุณููุง ูู SYN-ACK
3. ูุง ูุญูุธ ุดูุก ูู ุงูุฐุงูุฑุฉ
4. ุนูุฏ ุงุณุชูุงู ACKุ ูุชุญูู ูู ุงูู cookie
5. ุฅู ุตุญุ ููููู ุงูุงุชุตุงู

ุงููุชูุฌุฉ: ูุง ุงุณุชูุฒุงู ููุฐุงูุฑุฉ โ
```

#### 2. ุชุญุฏูุฏ ูุนุฏู ุงูุงุชุตุงูุงุช ุงูุฌุฏูุฏุฉ

**ุจุงุณุชุฎุฏุงู iptables:**
```bash
# ุงูุณูุงุญ ุจู 5 ุงุชุตุงูุงุช ุฌุฏูุฏุฉ ููุท ูู ุงูุซุงููุฉ ูู ููุณ IP
iptables -A INPUT -p tcp --syn -m limit --limit 5/s --limit-burst 10 -j ACCEPT
iptables -A INPUT -p tcp --syn -j DROP
```

**ุจุงุณุชุฎุฏุงู nftables:**
```bash
nft add rule ip filter input tcp flags syn ct state new limit rate 5/second accept
```

#### 3. ุฒูุงุฏุฉ ุญุฌู ูุงุฆูุฉ SYN

```bash
# ุฒูุงุฏุฉ ุงูุญุฏ ุงูุฃูุตู ููุงุชุตุงูุงุช ูุตู ุงูููุชูุญุฉ
sudo sysctl -w net.ipv4.tcp_max_syn_backlog=4096

# ุชูููู ููุช ุงูุงูุชุธุงุฑ
sudo sysctl -w net.ipv4.tcp_synack_retries=2
```

#### 4. ุงุณุชุฎุฏุงู Firewall ูุชูุฏู

**Cisco ASA:**
```cisco
! ุชุญุฏูุฏ ุนุฏุฏ ุงูุงุชุตุงูุงุช ุงููุชุฒุงููุฉ
access-list OUTSIDE_IN extended permit tcp any host 203.0.113.50 eq www
class-map SYN-ATTACK
 match access-list OUTSIDE_IN
policy-map OUTSIDE_POLICY
 class SYN-ATTACK
  set connection conn-max 100 embryonic-conn-max 50
service-policy OUTSIDE_POLICY interface outside
```

**pfSense/OPNsense:**
- ุชูุนูู "SYN Proxy"
- ุถุจุท "Maximum States" ู "Maximum Source Nodes"

#### 5. ุงุณุชุฎุฏุงู CDN/DDoS Protection

ุฎุฏูุงุช ูุซู:
- Cloudflare
- AWS Shield
- Akamai

ุชููู ุจู:
- ุงูุชุตุงุต ุงููุฌูุงุช ุงูุถุฎูุฉ
- ุชูุฒูุน ุงูุญูู
- ููุชุฑุฉ ุงูุญุฑูุฉ ุงูุฎุจูุซุฉ

### ๐ ุงูุชุฃุซูุฑ ุนูู ุงูุฎุงุฏู

#### ูุฑุงุญู ุงููุฌูู

**ุงููุฑุญูุฉ 1: ุงูุจุฏุงูุฉ (0-30 ุซุงููุฉ)**
```
SYN Queue: 20% full
Response Time: 100ms โ 500ms
```

**ุงููุฑุญูุฉ 2: ุงูุชุตุนูุฏ (30-60 ุซุงููุฉ)**
```
SYN Queue: 80% full
Response Time: 500ms โ 3000ms
New connections: ุจุทูุฆุฉ ุฌุฏุงู
```

**ุงููุฑุญูุฉ 3: ุงูุงูููุงุฑ (60+ ุซุงููุฉ)**
```
SYN Queue: 100% full
Response Time: timeout
New connections: ูุฑููุถุฉ ุจุงููุงูู
Service: ุบูุฑ ูุชุงุญ ๐ด
```

### ๐ ูุดู ุงููุฌูู

#### ุนูุงูุงุช ุงูุชุญุฐูุฑ

```bash
# ุงุฑุชูุงุน ููุงุฌุฆ ูู SYN_RECV
watch -n 1 'netstat -ant | grep SYN_RECV | wc -l'

# ุชูุจูู ุนูุฏ ุชุฌุงูุฒ ุญุฏ ูุนูู
while true; do
  COUNT=$(netstat -ant | grep SYN_RECV | wc -l)
  if [ $COUNT -gt 1000 ]; then
    echo "โ๏ธ Possible SYN Flood: $COUNT connections"
  fi
  sleep 5
done
```

#### ุชุญููู ุงูุณุฌูุงุช

```bash
# ุนุฑุถ ุฃูุซุฑ IP ูุตุฏุฑูุฉ ูุดุงุทุงู
netstat -ant | grep SYN_RECV | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -nr | head -10
```

### ๐ก ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ

**ูููุฏุงูุนูู:**
1. โ ูุนูู SYN Cookies ุฏุงุฆูุงู
2. โ ุฑุงูุจ ูุนุฏูุงุช ุงูุงุชุตุงู ุจุดูู ูุณุชูุฑ
3. โ ุงุณุชุฎุฏู Firewall ูุน ุฅููุงููุงุช DDoS protection
4. โ ุงุญุชูุธ ุจุฎุทุฉ ุงุณุชุฌุงุจุฉ ุฌุงูุฒุฉ

**ููููุงุฌููู ุงูุฃุฎูุงูููู:**
1. ๐ ุงุญุตู ุนูู ุฅุฐู ุฎุทู ูุจู ุงูุงุฎุชุจุงุฑ
2. ๐ ุงุณุชุฎุฏู ุจูุฆุฉ ูุนุฒููุฉ ุชูุงูุงู
3. โฐ ุญุฏุฏ ูุงูุฐุฉ ุฒูููุฉ ูุญุฏูุฏุฉ ููุงุฎุชุจุงุฑ
4. ๐ ูุซูู ุงููุชุงุฆุฌ ุจุดูู ุงุญุชุฑุงูู

---

## 10. UDP Flood Attack

### ๐ฏ ุงููุฏู ุงูุชุนูููู
ููู ุขููุฉ ูุฌูู UDP Flood ูุงููุฑู ุจููู ูุจูู SYN Flood.

### โ๏ธ ุชุญุฐูุฑ ูุงูููู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐จ ูุฐุง ุงููุญุชูู ููุชุนููู ูุงูุฃุจุญุงุซ ุงูุฃูููุฉ ููุท  โ
โ                                                   โ
โ  ุงูููุงู ุจูุฐุง ุงููุฌูู ุฏูู ุฅุฐู ูู:                โ
โ  โข ุฌุฑููุฉ ุฅููุชุฑูููุฉ                              โ
โ  โข ููุนุงูุจ ุนูููุง ุจุงูุณุฌู ูุงูุบุฑุงูุฉ                โ
โ  โข ููุณูุญ ููุท ูู ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูููููุฉ ูู         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ๐ ุงููุฑู ุจูู TCP ู UDP

| ุงูููุฒุฉ | TCP | UDP |
|--------|-----|-----|
| ุงูุงุชุตุงู | Connection-oriented | Connectionless |
| ุงููุตุงูุญุฉ | ูุนู (3-way handshake) | ูุง |
| ุงูููุซูููุฉ | ูุถููู ุงููุตูู | ุบูุฑ ูุถููู |
| ุงูุณุฑุนุฉ | ุฃุจุทุฃ | ุฃุณุฑุน |
| ุงูุชุฑุชูุจ | ูุฑุชุจ | ุบูุฑ ูุฑุชุจ |

### ๐ฌ ุขููุฉ ูุฌูู UDP Flood

```
Attacker                    Target Server
  |                              |
  |------- UDP Packet ---------->| Port 53 (DNS)
  |------- UDP Packet ---------->| Port 161 (SNMP)
  |------- UDP Packet ---------->| Port 12345 (Random)
  |------- UDP Packet ---------->| Port 9999 (Closed)
  |       (thousands/sec)        |
  |                              |
  |                         [Server Process]
  |                         1. ุชููู ุงูุญุฒูุฉ
  |                         2. ูุญุต ุงููููุฐ
  |                         3. ุงููููุฐ ูุบููุ
  |                         4. ุฅุฑุณุงู ICMP Port Unreachable
  |                              |
  |<---- ICMP Unreachable -------|
  |<---- ICMP Unreachable -------|
  |<---- ICMP Unreachable -------|
  |                              |
  |                    [Result: Resource Exhaustion]
  |                    โข CPU: 100%
  |                    โข Bandwidth: Saturated
  |                    โข Service: Unavailable
```

### ๐ฌ ุงูุชุทุจูู ุงูุนููู (ุจูุฆุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ููุท)

#### ุงูุจูุฆุฉ ุงููุทููุจุฉ
- ุดุจูุฉ ูุฎุชุจุฑูุฉ ูุนุฒููุฉ ุชูุงูุงู
- ุฎุงุฏู ุงุฎุชุจุงุฑ ูุฎุตุต
- ุฅุฐู ุฎุทู ููุซู

#### ุงุณุชุฎุฏุงู hping3

**ุงููุฌูู ุงูุฃุณุงุณู:**
```bash
sudo hping3 --udp -p 53 --flood TARGET_IP
```

**ุงูุดุฑุญ:**
- `--udp`: ุงุณุชุฎุฏุงู ุจุฑูุชูููู UDP
- `-p 53`: ุงุณุชูุฏุงู ูููุฐ DNS
- `--flood`: ุฅุฑุณุงู ุจุฃูุตู ุณุฑุนุฉ ููููุฉ

**ูุฌูู ูุน ููุงูุฐ ุนุดูุงุฆูุฉ:**
```bash
sudo hping3 --udp --rand-dest --flood TARGET_IP
```

- `--rand-dest`: ููุงูุฐ ูุฌูุฉ ุนุดูุงุฆูุฉ
- ููุถุนู ุงูุฎุงุฏู ุฃูุซุฑ (ููุญุต ูู ูููุฐ)

**ูุฌูู ูุน ุญุฌู ุญุฒูุฉ ูุจูุฑ:**
```bash
sudo hping3 --udp -p 53 --flood -d 65500 TARGET_IP
```

- `-d 65500`: ุญุฌู ุงูุจูุงูุงุช (ุฃูุตู ุญุฏ ูู UDP)
- ูุณุชููู bandwidth ุฃูุซุฑ

### ๐ ุงููุฑุงูุจุฉ ุนูู ุงูุฎุงุฏู ุงููุณุชูุฏู

#### ุนุฑุถ ุฅุญุตุงุฆูุงุช UDP

```bash
netstat -s | grep UDP
```

**ูุซุงู ุนูู ุงููุชุงุฆุฌ ุฃุซูุงุก ุงููุฌูู:**
```
UDP:
    125847 packets received
    98234 packets to unknown port received
    89123 packet receive errors
    45678 packets sent
    RcvbufErrors: 12345
    SndbufErrors: 0
    InErrors: 89123
```

#### ูุฑุงูุจุฉ ุงูุญุฒู ูู ุงูููุช ุงููุนูู

```bash
# ุนุฑุถ ูุนุฏู ุญุฒู UDP
watch -n 1 'netstat -su | grep "packets received"'

# ูุฑุงูุจุฉ ููุงูุฐ ูุญุฏุฏุฉ
tcpdump -i eth0 udp port 53 -nn
```

**ูุคุดุฑุงุช ุงููุฌูู:**
```
UDP packets/sec: 50,000+     ๐ด (ุทุจูุนู: < 1,000)
Port Unreachable: 40,000+    ๐ด (ุทุจูุนู: < 10)
Bandwidth usage: 90%+        ๐ด (ุทุจูุนู: < 50%)
CPU usage: 100%              ๐ด (ุทุจูุนู: < 30%)
```

#### ุชุญุฏูุฏ ุฃูุซุฑ ุงูููุงูุฐ ุงููุณุชูุฏูุฉ

```bash
tcpdump -i eth0 -nn udp -c 1000 | awk '{print $5}' | cut -d'.' -f5 | sort | uniq -c | sort -nr | head -10
```

### ๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ

#### 1. Rate Limiting ุนูู Linux

```bash
# ุชุญุฏูุฏ ูุนุฏู ุญุฒู UDP ูู ูู IP
iptables -A INPUT -p udp -m limit --limit 100/s --limit-burst 200 -j ACCEPT
iptables -A INPUT -p udp -j DROP

# ุญูุงูุฉ ููุงูุฐ ูุญุฏุฏุฉ
iptables -A INPUT -p udp --dport 53 -m limit --limit 50/s -j ACCEPT
iptables -A INPUT -p udp --dport 53 -j DROP
```

#### 2. ุชุนุทูู ICMP Port Unreachable

```bash
# ููุน ุฅุฑุณุงู ุฑุณุงุฆู Port Unreachable
iptables -A OUTPUT -p icmp --icmp-type destination-unreachable -j DROP

# ุฃู ุนุจุฑ sysctl
sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1
```

**ุงููุงุฆุฏุฉ:**
- ูููุฑ ููุงุฑุฏ CPU
- ูููุน ุงุณุชูุฒุงู bandwidth ุจุงูุฑุฏูุฏ

#### 3. ุญูุงูุฉ ุนูู ูุณุชูู ุงูุฎุงุฏู

```bash
# ุฒูุงุฏุฉ ุญุฌู buffer ููู UDP
sysctl -w net.core.rmem_max=26214400
sysctl -w net.core.rmem_default=26214400

# ุชุญุณูู ูุนุงูุฌุฉ ุงูุญุฒู
sysctl -w net.core.netdev_max_backlog=5000
```

#### 4. Firewall Rules ุนูู Cisco

```cisco
! ุชุญุฏูุฏ ูุนุฏู UDP
access-list 110 permit udp any host 203.0.113.50 eq domain
access-list 110 deny udp any any

interface GigabitEthernet0/0
 ip access-group 110 in
 rate-limit input access-group 110 10000000 1000000 2000000 conform-action transmit exceed-action drop
```

#### 5. ุงุณุชุฎุฏุงู fail2ban

```bash
# ุชุซุจูุช fail2ban
sudo apt install fail2ban

# ุฅูุดุงุก ูุงุนุฏุฉ ูู UDP flood
sudo nano /etc/fail2ban/filter.d/udp-flood.conf
```

**ูุญุชูู ุงูููู:**
```ini
[Definition]
failregex = .*kernel.*UDP.*SRC=<HOST>.*
ignoreregex =
```

**ุงูุชูุนูู:**
```ini
# /etc/fail2ban/jail.local
[udp-flood]
enabled = true
filter = udp-flood
logpath = /var/log/syslog
maxretry = 100
findtime = 60
bantime = 3600
```

### ๐ ุงูููุงูุฐ ุงูุดุงุฆุนุฉ ุงููุณุชูุฏูุฉ

| ุงููููุฐ | ุงูุฎุฏูุฉ | ุณุจุจ ุงูุงุณุชูุฏุงู |
|--------|---------|---------------|
| 53 | DNS | ุญููู ููุดุจูุฉุ ูููุฏ ุงุณุชุฌุงุจุงุช |
| 123 | NTP | ูููู ุชุถุฎููู (Amplification) |
| 161 | SNMP | ุฅุฏุงุฑุฉุ ุบุงูุจุงู ููุชูุญ |
| 1900 | SSDP | UPnPุ ุดุงุฆุน ูู ุงูุฃุฌูุฒุฉ ุงูููุฒููุฉ |
: yescrypt (ุงูุฃุญุฏุซ)

#### ุงูุฎุทูุฉ 2: ุฅูุดุงุก ููู ุงุฎุชุจุงุฑ

```bash
# ุฅูุดุงุก ูุณุชุฎุฏู ุชุฌุฑูุจู ุถุนูู
sudo useradd -m testuser
echo "testuser:password123" | sudo chpasswd

# ุงุณุชุฎุฑุงุฌ ุงูู hash
sudo grep testuser /etc/shadow > test_hash.txt
```

#### ุงูุฎุทูุฉ 3: ูุณุฑ ูููุฉ ุงููุฑูุฑ

```bash
john test_hash.txt
```

**ุงููุชูุฌุฉ:**
```
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 4 OpenMP threads
Proceeding with single crack mode
Press 'q' or Ctrl-C to abort, almost any other key for status
password123      (testuser)
1g 0:00:00:03 DONE (2025-10-26 15:45) 0.3125g/s 800.0p/s 800.0c/s 800.0C/s
Use the "--show" option to display all of the cracked passwords reliably
Session completed
```

### ๐ฏ ุฃูุถุงุน ุงููุณุฑ

#### 1. Single Crack Mode (ุงููุถุน ุงูุงูุชุฑุงุถู)

```bash
john test_hash.txt
```

- ูุณุชุฎุฏู ุงุณู ุงููุณุชุฎุฏู ููุนูููุงุช GECOS
- ููุฌุฑุจ ุชูููุนุงุช ุนูู ุงูุงุณู
- ุณุฑูุน ุฌุฏุงู

#### 2. Wordlist Mode (ูุงุฆูุฉ ูููุงุช)

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt test_hash.txt
```

**rockyou.txt:**
- ูุญุชูู ุนูู 14 ููููู ูููุฉ ูุฑูุฑ
- ูู ุชุณุฑูุจุงุช ุญููููุฉ
- ูุชููุฑ ูู Kali Linux

#### 3. Incremental Mode (Brute Force)

```bash
john --incremental test_hash.txt
```

- ูุฌุฑุจ ุฌููุน ุงูุชูุงููู ุงูููููุฉ
- ุจุทูุก ุฌุฏุงู ูููููุงุช ุงูุทูููุฉ
- ูุจุฏุฃ ูู ุงูุฃูุตุฑ ููุฃุทูู

#### 4. ูุน ููุงุนุฏ (Rules)

```bash
john --wordlist=wordlist.txt --rules test_hash.txt
```

**ุฃูุซูุฉ ุนูู ุงูููุงุนุฏ:**
- `password` โ `Password`, `password1`, `p@ssword`
- `admin` โ `Admin123`, `admin!`, `4dm1n`

### ๐ ุนุฑุถ ุงููุชุงุฆุฌ

```bash
# ุนุฑุถ ูููุงุช ุงููุฑูุฑ ุงูููุณูุฑุฉ
john --show test_hash.txt

# ุงููุชูุฌุฉ:
# testuser:password123:1001:1001::/home/testuser:/bin/bash
# 1 password hash cracked, 0 left
```

### โฑ๏ธ ุชูุฏูุฑ ุงูููุช

```bash
john --stdout --incremental | wc -l
```

**ูุซุงู ุนูู ุฃููุงุช ุงููุณุฑ:**

| ุทูู ุงููููุฉ | ููุน ุงูุฃุญุฑู | ุงูููุช ุงูุชูุฑูุจู |
|------------|-------------|-----------------|
| 4 ุฃุญุฑู | ุฃุฑูุงู ููุท | ุซูุงูู |
| 6 ุฃุญุฑู | ุฃุญุฑู ุตุบูุฑุฉ | ุฏูุงุฆู |
| 8 ุฃุญุฑู | ุฃุญุฑู + ุฃุฑูุงู | ุณุงุนุงุช |
| 10 ุฃุญุฑู | ูุฎุชูุทุฉ | ุฃูุงู |
| 12 ุฃุญุฑู | ูุฎุชูุทุฉ + ุฑููุฒ | ุณููุงุช |

### ๐ก๏ธ ุฅูุดุงุก ูููุงุช ูุฑูุฑ ูููุฉ

#### ูุนุงููุฑ ูููุฉ ุงููุฑูุฑ ุงููููุฉ

```
โ ุทูู: 12+ ุญุฑู
โ ุฃุญุฑู ูุจูุฑุฉ: A-Z
โ ุฃุญุฑู ุตุบูุฑุฉ: a-z
โ ุฃุฑูุงู: 0-9
โ ุฑููุฒ: !@#$%^&*
โ ุนุฏู ุงุณุชุฎุฏุงู ูููุงุช ูุงููุณูุฉ
โ ูุฑูุฏุฉ ููู ุญุณุงุจ
```

#### ุฃูุซูุฉ

| ูููุฉ ุงููุฑูุฑ | ุงูููุฉ | ุงูููุช ูููุณุฑ |
|-------------|--------|--------------|
| `password` | ๐ด ุถุนููุฉ ุฌุฏุงู | ููุฑู |
| `password123` | ๐ด ุถุนููุฉ | ุซูุงูู |
| `Password123` | ๐ก ูุชูุณุทุฉ | ุฏูุงุฆู |
| `P@ssw0rd123!` | ๐ก ุฌูุฏุฉ | ุณุงุนุงุช |
| `Tr0ub4dor&3` | ๐ข ูููุฉ | ุฃูุงู |
| `correct horse battery staple` | ๐ข ูููุฉ ุฌุฏุงู | ุณููุงุช |
| `R7$mK9#pL2@vN4qW` | ๐ข ููุชุงุฒุฉ | ูุฑูู |

### ๐ ุขููุงุช ุงูุญูุงูุฉ

#### 1. ุนูู ูุณุชูู ุงููุธุงู

```bash
# ุฒูุงุฏุฉ ุชุนููุฏ SHA-512
sudo nano /etc/pam.d/common-password

# ุฅุถุงูุฉ:
password required pam_unix.so sha512 shadow rounds=100000
```

#### 2. ุณูุงุณุงุช ูููุฉ ุงููุฑูุฑ

```bash
# ุชุซุจูุช libpam-pwquality
sudo apt install libpam-pwquality

# ุงูุชูููู
sudo nano /etc/security/pwquality.conf
```

**ูุญุชูู ููุชุฑุญ:**
```ini
minlen = 12
dcredit = -1    # ุฑูู ูุงุญุฏ ุนูู ุงูุฃูู
ucredit = -1    # ุญุฑู ูุจูุฑ ูุงุญุฏ
lcredit = -1    # ุญุฑู ุตุบูุฑ ูุงุญุฏ
ocredit = -1    # ุฑูุฒ ูุงุญุฏ
```

#### 3. ุงููุตุงุฏูุฉ ูุชุนุฏุฏุฉ ุงูุนูุงูู (MFA)

```bash
# ุชุซุจูุช Google Authenticator
sudo apt install libpam-google-authenticator

# ุชูุนูู ููุณุชุฎุฏู
google-authenticator
```

#### 4. ููู ุงูุญุณุงุจ ุจุนุฏ ูุญุงููุงุช ูุงุดูุฉ

```bash
# ุฅุถุงูุฉ ูู /etc/pam.d/common-auth
auth required pam_tally2.so deny=5 unlock_time=1800
```

### ๐ก ุฃูุถู ุงูููุงุฑุณุงุช

**ูููุณุชุฎุฏููู:**
1. โ ุงุณุชุฎุฏู ูุฏูุฑ ูููุงุช ูุฑูุฑ (Password Manager)
2. โ ูุนูู MFA ุนูู ุฌููุน ุงูุญุณุงุจุงุช ุงููููุฉ
3. โ ูุง ุชุนูุฏ ุงุณุชุฎุฏุงู ููุณ ูููุฉ ุงููุฑูุฑ
4. โ ุบููุฑ ูููุงุช ุงููุฑูุฑ ุฏูุฑูุงู (ูู 90 ููู ููุญุณุงุจุงุช ุงูุญุณุงุณุฉ)
5. โ ุงุณุชุฎุฏู passphrase ุจุฏูุงู ูู password

**ูููุณุคูููู:**
1. โ ูุฑุถ ุณูุงุณุงุช ูููุงุช ูุฑูุฑ ูููุฉ
2. โ ุงุณุชุฎุฏู ุฎูุงุฑุฒููุงุช ุชุฌุฒุฆุฉ ุญุฏูุซุฉ (bcrypt, scrypt, Argon2)
3. โ ุฑุงูุจ ูุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู ุงููุงุดูุฉ
4. โ ูุนูู ุชุณุฌูู ุฏุฎูู ุงููุณุคูููู ุจู MFA ุฅูุฒุงููุงู
5. โ ูู ุจุชุฏููู ูููุงุช ุงููุฑูุฑ ุฏูุฑูุงู

### ๐ ุชูุฑูู ุนููู

**ุงููุฏู:** ุงุฎุชุจุงุฑ ููุฉ ูููุงุช ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจู

```bash
# 1. ุฅูุดุงุก ููู ุงุฎุชุจุงุฑ
echo '$6$salt$hash' > my_test.txt

# 2. ุชูููุฏ hash ููููุฉ ูุฑูุฑู ุงูุชุฌุฑูุจูุฉ
python3 -c "import crypt; print(crypt.crypt('your_password', crypt.mksalt(crypt.METHOD_SHA512)))"

# 3. ูุณุฑูุง ุจุงุณุชุฎุฏุงู John
john my_test.txt

# 4. ุชุญููู ุงููุชุงุฆุฌ
# - ูู ุงุณุชุบุฑู ูู ุงูููุชุ
# - ูู ููุณุฑุช ุจุณูููุฉุ
# - ูุง ุงูุชุญุณููุงุช ุงูููููุฉุ
```

---

## 13. DHCP Snooping

### ๐ฏ ุงููุฏู
ุญูุงูุฉ ุงูุดุจูุฉ ูู ูุฌูุงุช DHCP ุงููุฒููุฉ (Rogue DHCP Servers).

### ๐ ุงููุดููุฉ: Rogue DHCP Server

#### ุงูุณููุงุฑูู ุงูุทุจูุนู

```
[Client] ---DHCP Discover---> [Legitimate DHCP Server]
[Client] <--DHCP Offer------- [Legitimate DHCP Server]
[Client] ---DHCP Request----> [Legitimate DHCP Server]
[Client] <--DHCP ACK--------- [Legitimate DHCP Server]

Result: โ ุฅุนุฏุงุฏุงุช ุตุญูุญุฉ
```

#### ุงูุณููุงุฑูู ุงูููุฎุชุฑู

```
[Client] ---DHCP Discover---> [Legitimate Server]
         ---DHCP Discover---> [Rogue Server] ๐จ
         
[Client] <--DHCP Offer------- [Legitimate Server]
         <--DHCP Offer------- [Rogue Server] โก (ุฃุณุฑุน!)

[Client] ---DHCP Request----> [Rogue Server]
[Client] <--DHCP ACK--------- [Rogue Server]

Result: โ ุงูุฃุฌูุฒุฉ ุชุญุตู ุนูู:
โข Gateway ูุฒูู (Man-in-the-Middle)
โข DNS ูุฒูู (Pharming)
โข ุนููุงู IP ูู ูุทุงู ุฎุงุทุฆ
```

### ๐ฏ ุงูุชุฃุซูุฑุงุช ุงูุฃูููุฉ

**1. Man-in-the-Middle Attack:**
```
[Client] ---> [Attacker] ---> [Internet]
              (ูุฑู ูู ุดูุก)
```

**2. DNS Spoofing:**
```
Client: "ูุง ูู ุนููุงู google.comุ"
Rogue DNS: "ุนููุงูู 10.0.0.66" (ูููุน ูุฒูู!)
```

**3. Denial of Service:**
```
Rogue DHCP ููุนุทู ุนูุงููู ูุชุถุงุฑุจุฉ
โ ุงูุฃุฌูุฒุฉ ูุง ุชุณุชุทูุน ุงูุงุชุตุงู
```

### ๐ก๏ธ ุงูุญู: DHCP Snooping

#### ุงูููููู ุงูุฃุณุงุณู

**Trusted Ports:**
- ููุงูุฐ ูุชุตูุฉ ุจุฎูุงุฏู DHCP ุดุฑุนูุฉ
- ููุณูุญ ููุง ุจุฅุฑุณุงู DHCP
